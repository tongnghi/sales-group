[0m18:45:51.584388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1117DB3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1137336D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B113733640>]}


============================== 18:45:51.587467 | 63f760c7-7fd6-43bf-8831-e01bae999fe4 ==============================
[0m18:45:51.587467 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:45:51.588466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:45:51.746605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63f760c7-7fd6-43bf-8831-e01bae999fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B111CD4700>]}
[0m18:45:51.759717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63f760c7-7fd6-43bf-8831-e01bae999fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B113A19340>]}
[0m18:45:51.760718 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 4 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:45:51.761718 [debug] [MainThread]: Command `dbt run` failed at 18:45:51.761718 after 0.20 seconds
[0m18:45:51.762791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1117DB3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B113A107F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B113A105E0>]}
[0m18:45:51.762791 [debug] [MainThread]: Flushing usage events
[0m18:45:58.227159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE165E580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE35B3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE35B34F0>]}


============================== 18:45:58.229176 | 7879749a-bb41-4b9a-a00c-663b3f7537c5 ==============================
[0m18:45:58.229176 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:45:58.231089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:45:58.272441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7879749a-bb41-4b9a-a00c-663b3f7537c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE35B3940>]}
[0m18:45:58.277262 [debug] [MainThread]: Set downloads directory='C:\Users\nghi.tc\AppData\Local\Temp\dbt-downloads-mbeq7fd9'
[0m18:45:58.278270 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:45:58.526555 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:45:58.526555 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:45:58.634894 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:45:58.639903 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m18:45:58.772266 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m18:45:58.777338 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m18:45:58.889305 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m18:45:58.890313 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m18:45:59.007957 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m18:45:59.024166 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:45:59.845623 [info ] [MainThread]: Installed from version 1.1.0
[0m18:45:59.846611 [info ] [MainThread]: Updated version available: 1.1.1
[0m18:45:59.847609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7879749a-bb41-4b9a-a00c-663b3f7537c5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE3634B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE35A3D60>]}
[0m18:45:59.848609 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m18:46:01.599945 [info ] [MainThread]: Installed from version 0.8.5
[0m18:46:01.600944 [info ] [MainThread]: Updated version available: 0.9.0
[0m18:46:01.601943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7879749a-bb41-4b9a-a00c-663b3f7537c5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE35A3D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE3663F70>]}
[0m18:46:01.602943 [info ] [MainThread]: Installing dbt-labs/audit_helper
[0m18:46:02.045784 [info ] [MainThread]: Installed from version 0.9.0
[0m18:46:02.047503 [info ] [MainThread]: Up to date!
[0m18:46:02.048636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7879749a-bb41-4b9a-a00c-663b3f7537c5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE35A3D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE3663FD0>]}
[0m18:46:02.048636 [info ] [MainThread]: Installing calogica/dbt_date
[0m18:46:02.564528 [info ] [MainThread]: Installed from version 0.7.2
[0m18:46:02.565527 [info ] [MainThread]: Updated version available: 0.8.1
[0m18:46:02.567115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7879749a-bb41-4b9a-a00c-663b3f7537c5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE3634B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE3663F40>]}
[0m18:46:02.567614 [info ] [MainThread]: 
[0m18:46:02.568621 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m18:46:02.572621 [debug] [MainThread]: Command `dbt deps` succeeded at 18:46:02.572621 after 4.35 seconds
[0m18:46:02.573618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE165E580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE35B34F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE35A3F40>]}
[0m18:46:02.574619 [debug] [MainThread]: Flushing usage events
[0m18:46:08.138013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FAE46BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB03C36A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB03C3730>]}


============================== 18:46:08.141013 | 8e516722-bf45-4cff-bfcb-8eed953d70f9 ==============================
[0m18:46:08.141013 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:46:08.142014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:46:08.307482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e516722-bf45-4cff-bfcb-8eed953d70f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB06AF400>]}
[0m18:46:08.321367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e516722-bf45-4cff-bfcb-8eed953d70f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FAE6F1CD0>]}
[0m18:46:08.378057 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:46:08.380261 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:46:08.380923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e516722-bf45-4cff-bfcb-8eed953d70f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB0720F40>]}
[0m18:46:09.884646 [debug] [MainThread]: 1699: static parser successfully parsed farm\intermediate\sales\farm_int_farms__unioned.sql
[0m18:46:09.907924 [debug] [MainThread]: 1699: static parser successfully parsed farm\intermediate\sales\farm_int_sales_cammy__joined_dims.sql
[0m18:46:09.910996 [debug] [MainThread]: 1699: static parser successfully parsed farm\intermediate\sales\farm_int_sales_sol__added_farm_info.sql
[0m18:46:09.914003 [debug] [MainThread]: 1699: static parser successfully parsed farm\intermediate\sales\farm_int_sales_sol__unioned_adj_rev.sql
[0m18:46:09.917800 [debug] [MainThread]: 1699: static parser successfully parsed farm\intermediate\sales\farm_int_sol_vsdwh_salesvolumned__filtered_to_sales.sql
[0m18:46:09.921226 [debug] [MainThread]: 1699: static parser successfully parsed farm\marts\sales\farm_sales.sql
[0m18:46:09.924218 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\excel\sales\farm_stg_excel__budget.sql
[0m18:46:09.927217 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\excel\sales\farm_stg_excel__exchange_rate.sql
[0m18:46:09.930217 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\excel\sales\farm_stg_excel__master_data_adj.sql
[0m18:46:09.933901 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\excel\sales\farm_stg_excel__master_data_rev.sql
[0m18:46:09.936988 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\excel\sales\farm_stg_excel__master_farms.sql
[0m18:46:09.940905 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\redshift\farm_stg_redshift__sales_cammy.sql
[0m18:46:09.943906 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sap_ecc\farm_stg_sap_ecc__sales_cam_my.sql
[0m18:46:09.946904 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_arwblapp_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.950144 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_arwhyapp_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.954143 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_bsh1001app_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.957213 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_cbd1001app_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.961142 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_dnb2001app_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.963863 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_fasiaapp_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.967953 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_gfcamapp1_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.970965 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_gfvmmapp_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.973918 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_laoapp_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.977914 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_mtr1001app_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.981822 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_mtr2001app_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.984947 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_mtr2002app_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.988586 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_mym1001app_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.991605 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_starnapp_xp_01610ab_accthist_erp_final.sql
[0m18:46:09.995496 [debug] [MainThread]: 1603: static parser failed on farm\staging\sol\farm_stg_sol__vsdwh_salesvolumed.sql
[0m18:46:10.001513 [debug] [MainThread]: 1602: parser fallback to jinja rendering on farm\staging\sol\farm_stg_sol__vsdwh_salesvolumed.sql
[0m18:46:10.003579 [debug] [MainThread]: 1699: static parser successfully parsed feed\intermediate\ZPPR0019_formulaprice_bagamt.sql
[0m18:46:10.006586 [debug] [MainThread]: 1699: static parser successfully parsed feed\intermediate\margin\feed_int_zmllistn__calculate_internal_entry.sql
[0m18:46:10.009563 [debug] [MainThread]: 1699: static parser successfully parsed feed\intermediate\margin\feed_int_zmllistn__calculate_opening_balance.sql
[0m18:46:10.013907 [debug] [MainThread]: 1699: static parser successfully parsed feed\marts\margin\feed_margin.sql
[0m18:46:10.016911 [debug] [MainThread]: 1699: static parser successfully parsed feed\marts\sales\feed_sales_budget_2023.sql
[0m18:46:10.019911 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\excel\feed_stg_excel_donavet_tb_account_mapping.sql
[0m18:46:10.022983 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\excel\feed_stg_excel_donavet_tb_donavet_1100.sql
[0m18:46:10.026722 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__draft_mb51_006.sql
[0m18:46:10.029734 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__draft_mb51_006_101.sql
[0m18:46:10.032733 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__draft_mm60_006.sql
[0m18:46:10.034734 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__draft_zmllistn_005.sql
[0m18:46:10.037733 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__draft_zppr0019_006.sql
[0m18:46:10.040733 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__feed_seed_margin_draft_ke24_006.sql
[0m18:46:10.043145 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__feed_seed_margin_draft_ke25_006.sql
[0m18:46:10.047174 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__feed_seed_margin_draft_mb5b_005.sql
[0m18:46:10.050174 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__fi_0fi_gl_12.sql
[0m18:46:10.053175 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sol\feed_stg_sol_gfdnbapp_cn_dnb_tb_1000.sql
[0m18:46:10.056175 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_cms.sql
[0m18:46:10.098677 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_cms.sql
[0m18:46:10.100676 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_cms_compare.sql
[0m18:46:10.133442 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_cms_compare.sql
[0m18:46:10.135440 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_gkitchen.sql
[0m18:46:10.141440 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_gkitchen.sql
[0m18:46:10.143440 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_gkitchen_compare.sql
[0m18:46:10.154856 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_gkitchen_compare.sql
[0m18:46:10.156856 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_leboucher.sql
[0m18:46:10.162856 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_leboucher.sql
[0m18:46:10.164856 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_leboucher_compare.sql
[0m18:46:10.176012 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_leboucher_compare.sql
[0m18:46:10.178015 [debug] [MainThread]: 1603: static parser failed on food\intermediate\core\dates.sql
[0m18:46:10.270445 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\intermediate\core\dates.sql
[0m18:46:10.273442 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\inventory\inventory_openning.sql
[0m18:46:10.277909 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_channels__unioned.sql
[0m18:46:10.280990 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_customer_groups_1__unioned.sql
[0m18:46:10.284993 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_customer_groups_2__unioned.sql
[0m18:46:10.289968 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_customer_groups__unioned.sql
[0m18:46:10.293540 [debug] [MainThread]: 1603: static parser failed on food\intermediate\sales\food_int_fi_ofi_acdoca_10__filtered_to_sales.sql
[0m18:46:10.301540 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\intermediate\sales\food_int_fi_ofi_acdoca_10__filtered_to_sales.sql
[0m18:46:10.304642 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_misa_lbc2022_generalledger__filtered_to_sales.sql
[0m18:46:10.310094 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_products__unioned.sql
[0m18:46:10.315093 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_sales_groups__unioned.sql
[0m18:46:10.318122 [debug] [MainThread]: 1603: static parser failed on food\intermediate\sales\food_int_sol_gnf1001apprepl_vsdwh_salesvolumed__grouped_to_sales.sql
[0m18:46:10.327784 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\intermediate\sales\food_int_sol_gnf1001apprepl_vsdwh_salesvolumed__grouped_to_sales.sql
[0m18:46:10.328778 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\mappings\food_sales_mapping_channels.sql
[0m18:46:10.332779 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\mappings\food_sales_mapping_customer_groups.sql
[0m18:46:10.335780 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\mappings\food_sales_mapping_lbc_customers.sql
[0m18:46:10.340215 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\mappings\food_sales_mapping_lbc_sales_groups.sql
[0m18:46:10.345985 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\mappings\food_sales_mapping_materials.sql
[0m18:46:10.350984 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\score_card\food_int_fi_0fi_acdoca_10__filtered_to_cogs.sql
[0m18:46:10.356620 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\score_card\food_int_fi_0fi_acdoca_10__filtered_to_manufacturing_cost.sql
[0m18:46:10.362540 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\score_card\food_int_fi_0fi_acdoca_10__filtered_to_revenue.sql
[0m18:46:10.370516 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_budget_of_accounting_department.sql
[0m18:46:10.376602 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_cms_billing_sales.sql
[0m18:46:10.407993 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_feedy_dnf_customers.sql
[0m18:46:10.417086 [debug] [MainThread]: 1603: static parser failed on food\marts\sales\food_gkitchen_sales.sql
[0m18:46:10.437149 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\marts\sales\food_gkitchen_sales.sql
[0m18:46:10.439154 [debug] [MainThread]: 1603: static parser failed on food\marts\sales\food_leboucher_sales.sql
[0m18:46:10.452711 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\marts\sales\food_leboucher_sales.sql
[0m18:46:10.455187 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_products.sql
[0m18:46:10.463183 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_sales_target_by_channels.sql
[0m18:46:10.470185 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_sales_target_by_channels_products.sql
[0m18:46:10.479446 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_channels.sql
[0m18:46:10.486159 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_cogs.sql
[0m18:46:10.491442 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_companies.sql
[0m18:46:10.498330 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_cost_elements.sql
[0m18:46:10.502324 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_fi_scorecard.sql
[0m18:46:10.510673 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_manufacturing_cost.sql
[0m18:46:10.515093 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_mapping_categories.sql
[0m18:46:10.518093 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_mapping_costcenter_costcentergroup.sql
[0m18:46:10.523155 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_mapping_hierarchies_costelement.sql
[0m18:46:10.529830 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_mapping_pl_plgroup.sql
[0m18:46:10.533825 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_mapping_subcategories.sql
[0m18:46:10.538502 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_scorecard_kpi_budget.sql
[0m18:46:10.542686 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__budget_of_accounting_department.sql
[0m18:46:10.549824 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__lbc_sales_groups.sql
[0m18:46:10.554188 [debug] [MainThread]: 1603: static parser failed on food\staging\excel\sales\food_stg_excel_sales__master_data_customer_lbc.sql
[0m18:46:10.580011 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\excel\sales\food_stg_excel_sales__master_data_customer_lbc.sql
[0m18:46:10.582003 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__md_channels.sql
[0m18:46:10.585043 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__md_customer_groups.sql
[0m18:46:10.588150 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__md_products.sql
[0m18:46:10.592158 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__md_products_conversion_rate_lbc.sql
[0m18:46:10.597054 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__target_by_channel.sql
[0m18:46:10.599379 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__target_by_channel_by_product.sql
[0m18:46:10.603547 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\base\base_excel_sales__master_data_customer_lbc.sql
[0m18:46:10.607548 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\misa\food_stg_excel_misa_lbc_tb_account_mapping.sql
[0m18:46:10.614013 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\misa\food_stg_excel_misa_lbc_tp_lbc_3200_v2.sql
[0m18:46:10.621849 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\misa\food_stg_misa__lbc_generalledger.sql
[0m18:46:10.626844 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__fi_0fi_acdoca_10.sql
[0m18:46:10.641196 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__fi_0fi_acdoca_10.sql
[0m18:46:10.643134 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\sap_s4\food_stg_sap_s4__fi_0fi_gl_12.sql
[0m18:46:10.648923 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0accnt_grp_text.sql
[0m18:46:10.653930 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0accnt_grp_text.sql
[0m18:46:10.655921 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0bill_type_text.sql
[0m18:46:10.661067 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0bill_type_text.sql
[0m18:46:10.664361 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0comp_code_text.sql
[0m18:46:10.669357 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0comp_code_text.sql
[0m18:46:10.671354 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0costcenter_text.sql
[0m18:46:10.675357 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0costcenter_text.sql
[0m18:46:10.677171 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0costelmnt_text.sql
[0m18:46:10.683252 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0costelmnt_text.sql
[0m18:46:10.684255 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0customer_text.sql
[0m18:46:10.689260 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0customer_text.sql
[0m18:46:10.690256 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0cust_group_text.sql
[0m18:46:10.696020 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0cust_group_text.sql
[0m18:46:10.698020 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0cust_grp1_text.sql
[0m18:46:10.702020 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0cust_grp1_text.sql
[0m18:46:10.704020 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0cust_grp2_text.sql
[0m18:46:10.708090 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0cust_grp2_text.sql
[0m18:46:10.711006 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0distr_chan_text.sql
[0m18:46:10.716002 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0distr_chan_text.sql
[0m18:46:10.718019 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\sap_s4\food_stg_sap_s4__md_0material_attr.sql
[0m18:46:10.722994 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0material_text.sql
[0m18:46:10.731220 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0material_text.sql
[0m18:46:10.733222 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0matl_type_text.sql
[0m18:46:10.738233 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0matl_type_text.sql
[0m18:46:10.740150 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0ord_reason_text.sql
[0m18:46:10.745103 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0ord_reason_text.sql
[0m18:46:10.747118 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0plant_text.sql
[0m18:46:10.751109 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0plant_text.sql
[0m18:46:10.753104 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0prod_hier_text.sql
[0m18:46:10.757772 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0prod_hier_text.sql
[0m18:46:10.758773 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0sales_dist_text.sql
[0m18:46:10.764774 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0sales_dist_text.sql
[0m18:46:10.765771 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0sales_grp_text.sql
[0m18:46:10.770000 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0sales_grp_text.sql
[0m18:46:10.772081 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0sales_off_text.sql
[0m18:46:10.777089 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0sales_off_text.sql
[0m18:46:10.778080 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__mm_2lis_03_bf.sql
[0m18:46:10.783080 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__mm_2lis_03_bf.sql
[0m18:46:10.784079 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__mm_2lis_03_um.sql
[0m18:46:10.792313 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__mm_2lis_03_um.sql
[0m18:46:10.794302 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__sd_2lis_11_vaitm.sql
[0m18:46:10.799301 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__sd_2lis_11_vaitm.sql
[0m18:46:10.801560 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__sd_2lis_13_vditm.sql
[0m18:46:10.806234 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__sd_2lis_13_vditm.sql
[0m18:46:10.808234 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__tbl_customer_sale_person.sql
[0m18:46:10.813173 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__tbl_customer_sale_person.sql
[0m18:46:10.814173 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__tbl_fcml_ccs_r_all_v.sql
[0m18:46:10.820246 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__tbl_fcml_ccs_r_all_v.sql
[0m18:46:10.822164 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\sap_s4\food_stg_sap_s4__tbl_vbpa.sql
[0m18:46:10.824245 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__tbl_ztt_zsdc0016.sql
[0m18:46:10.830233 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__tbl_ztt_zsdc0016.sql
[0m18:46:10.832378 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\sol\food_stg_sol__gnf1001apprepl_vsdwh_salesvolumed.sql
[0m18:46:10.835298 [debug] [MainThread]: 1699: static parser successfully parsed food\tests\assert_cms_billing_sales_audit.sql
[0m18:46:10.838481 [debug] [MainThread]: 1699: static parser successfully parsed food\tests\assert_gkitchen_sales_audit.sql
[0m18:46:10.841546 [debug] [MainThread]: 1699: static parser successfully parsed food\tests\assert_leboucher_ref_no_is_not_null.sql
[0m18:46:10.844472 [debug] [MainThread]: 1699: static parser successfully parsed food\tests\assert_leboucher_sales_audit.sql
[0m18:46:10.847525 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_balance_sheet_backup.sql
[0m18:46:10.851409 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_fiscal_period.sql
[0m18:46:10.854318 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_mapping_account_pl_to_account_sap_union.sql
[0m18:46:10.856390 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_mapping_bs_gl_account.sql
[0m18:46:10.859340 [debug] [MainThread]: 1603: static parser failed on group\intermediate\core\consol_mapping_exchange_rate.sql
[0m18:46:10.865138 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\core\consol_mapping_exchange_rate.sql
[0m18:46:10.866548 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_mapping_legal_company_code_currency.sql
[0m18:46:10.869547 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_mapping_p_and_l_gl_account.sql
[0m18:46:10.872539 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_1000_solomon.sql
[0m18:46:10.881548 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_1000_solomon.sql
[0m18:46:10.883546 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2000_solomon.sql
[0m18:46:10.887620 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2000_solomon.sql
[0m18:46:10.889621 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2000_solomon_dong_nam_bo.sql
[0m18:46:10.934820 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2000_solomon_dong_nam_bo.sql
[0m18:46:10.936824 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2100_solomon.sql
[0m18:46:10.940865 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2100_solomon.sql
[0m18:46:10.944007 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2200_1001_solomon.sql
[0m18:46:10.949058 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2200_1001_solomon.sql
[0m18:46:10.951061 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2200_2001_solomon.sql
[0m18:46:10.955060 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2200_2001_solomon.sql
[0m18:46:10.956667 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2200_2002_solomon.sql
[0m18:46:10.963760 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2200_2002_solomon.sql
[0m18:46:10.965752 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2300_solomon.sql
[0m18:46:10.969748 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2300_solomon.sql
[0m18:46:10.971804 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2400_solomon.sql
[0m18:46:10.976537 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2400_solomon.sql
[0m18:46:10.979488 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_5000_cam_solomon.sql
[0m18:46:10.984564 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_5000_cam_solomon.sql
[0m18:46:10.986488 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_5000_cbd1001_solomon.sql
[0m18:46:10.991248 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_5000_cbd1001_solomon.sql
[0m18:46:10.993167 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_5000_star_solomon.sql
[0m18:46:10.999238 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_5000_star_solomon.sql
[0m18:46:11.000243 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_5100_solomon.sql
[0m18:46:11.004820 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_5100_solomon.sql
[0m18:46:11.006820 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_5200_solomon.sql
[0m18:46:11.011682 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_5200_solomon.sql
[0m18:46:11.013682 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_1000_solomon.sql
[0m18:46:11.022268 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_1000_solomon.sql
[0m18:46:11.024268 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2000_solomon.sql
[0m18:46:11.030349 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2000_solomon.sql
[0m18:46:11.032345 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2000_solomon_dong_nam_bo.sql
[0m18:46:11.037424 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2000_solomon_dong_nam_bo.sql
[0m18:46:11.039413 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2100_solomon.sql
[0m18:46:11.043409 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2100_solomon.sql
[0m18:46:11.045413 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2200_1001_solomon.sql
[0m18:46:11.049416 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2200_1001_solomon.sql
[0m18:46:11.052338 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2200_2001_solomon.sql
[0m18:46:11.056431 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2200_2001_solomon.sql
[0m18:46:11.058436 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2200_2002_solomon.sql
[0m18:46:11.063873 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2200_2002_solomon.sql
[0m18:46:11.065936 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2300_solomon.sql
[0m18:46:11.070288 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2300_solomon.sql
[0m18:46:11.072288 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2400_solomon.sql
[0m18:46:11.077287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2400_solomon.sql
[0m18:46:11.079317 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_5000_cam_solomon.sql
[0m18:46:11.083886 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_5000_cam_solomon.sql
[0m18:46:11.085887 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_5000_cbd1001_solomon.sql
[0m18:46:11.089958 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_5000_cbd1001_solomon.sql
[0m18:46:11.090957 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_5000_star_solomon.sql
[0m18:46:11.097179 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_5000_star_solomon.sql
[0m18:46:11.099246 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_5100_solomon.sql
[0m18:46:11.103206 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_5100_solomon.sql
[0m18:46:11.120297 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_5200_solomon.sql
[0m18:46:11.126970 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_5200_solomon.sql
[0m18:46:11.128934 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_pl\feed_pl_1000_dnb_solomon.sql
[0m18:46:11.134236 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_pl\feed_pl_1000_dnb_solomon.sql
[0m18:46:11.136254 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_pl\feed_pl_1000_sap.sql
[0m18:46:11.141244 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_pl\feed_pl_1000_sap.sql
[0m18:46:11.143282 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_pl\feed_pl_1100_donavet_excel.sql
[0m18:46:11.148426 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_pl\feed_pl_1100_donavet_excel.sql
[0m18:46:11.150424 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_tb\feed_tb_1000_dnb_solomon.sql
[0m18:46:11.154500 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_tb\feed_tb_1000_dnb_solomon.sql
[0m18:46:11.156425 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_tb\feed_tb_1000_sap.sql
[0m18:46:11.160627 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_tb\feed_tb_1000_sap.sql
[0m18:46:11.162720 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_tb\feed_tb_1100_donavet_excel.sql
[0m18:46:11.166697 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_tb\feed_tb_1100_donavet_excel.sql
[0m18:46:11.168713 [debug] [MainThread]: 1603: static parser failed on group\intermediate\food\food_p_l\food_pl_3000_and_3100.sql
[0m18:46:11.172696 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\food\food_p_l\food_pl_3000_and_3100.sql
[0m18:46:11.175393 [debug] [MainThread]: 1603: static parser failed on group\intermediate\food\food_p_l\food_pl_3200_lbc.sql
[0m18:46:11.180797 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\food\food_p_l\food_pl_3200_lbc.sql
[0m18:46:11.182724 [debug] [MainThread]: 1603: static parser failed on group\intermediate\food\food_tb\food_tb_3000_and_3100.sql
[0m18:46:11.186795 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\food\food_tb\food_tb_3000_and_3100.sql
[0m18:46:11.187802 [debug] [MainThread]: 1603: static parser failed on group\intermediate\food\food_tb\food_tb_3200_lbc.sql
[0m18:46:11.192666 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\food\food_tb\food_tb_3200_lbc.sql
[0m18:46:11.195014 [debug] [MainThread]: 1603: static parser failed on group\intermediate\qdt\qdt_pl\qdt_pl_4200_solomon.sql
[0m18:46:11.199085 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\qdt\qdt_pl\qdt_pl_4200_solomon.sql
[0m18:46:11.202118 [debug] [MainThread]: 1603: static parser failed on group\intermediate\qdt\qdt_tb\qdt_tb_4200_solomon.sql
[0m18:46:11.206097 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\qdt\qdt_tb\qdt_tb_4200_solomon.sql
[0m18:46:11.208292 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_pl\tech_pl_4000_qdtek.sql
[0m18:46:11.212326 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_pl\tech_pl_4000_qdtek.sql
[0m18:46:11.214335 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_pl\tech_pl_4001_qdtek_north.sql
[0m18:46:11.218330 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_pl\tech_pl_4001_qdtek_north.sql
[0m18:46:11.220255 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_pl\tech_pl_4002_qdtek_south.sql
[0m18:46:11.225038 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_pl\tech_pl_4002_qdtek_south.sql
[0m18:46:11.227039 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_pl\tech_pl_4300_ntt.sql
[0m18:46:11.233265 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_pl\tech_pl_4300_ntt.sql
[0m18:46:11.235148 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_tb\tech_tb_4000_qdtek.sql
[0m18:46:11.239275 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_tb\tech_tb_4000_qdtek.sql
[0m18:46:11.242275 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_tb\tech_tb_4300_ntt.sql
[0m18:46:11.246276 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_tb\tech_tb_4300_ntt.sql
[0m18:46:11.248276 [debug] [MainThread]: 1603: static parser failed on group\marts\finance\financial_profit_loss.sql
[0m18:46:11.259623 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\marts\finance\financial_profit_loss.sql
[0m18:46:11.261704 [debug] [MainThread]: 1603: static parser failed on group\marts\finance\financial_statements.sql
[0m18:46:11.273041 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\marts\finance\financial_statements.sql
[0m18:46:11.274041 [debug] [MainThread]: 1699: static parser successfully parsed group\marts\finance\financial_statements_backup.sql
[0m18:46:11.277042 [debug] [MainThread]: 1699: static parser successfully parsed group\marts\finance\mapping_md_balance_sheet_code.sql
[0m18:46:11.280041 [debug] [MainThread]: 1699: static parser successfully parsed group\marts\finance\mapping_md_p_l_account.sql
[0m18:46:11.283100 [debug] [MainThread]: 1699: static parser successfully parsed qdt\staging\sol\qdt_stg_sol_log5001appxp_01610ab_accthist_erp_final.sql
[0m18:46:11.286033 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__actual_sales__joined.sql
[0m18:46:11.288961 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__churn__grouped_by_customer.sql
[0m18:46:11.290961 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__customer_classs__grouped_by_month.sql
[0m18:46:11.294961 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__material__distinct.sql
[0m18:46:11.297961 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__po_type__grouped_by_billing_number.sql
[0m18:46:11.300961 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__salesman__distinct.sql
[0m18:46:11.302961 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__actual_sales.sql
[0m18:46:11.305961 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__billings.sql
[0m18:46:11.307961 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__branches.sql
[0m18:46:11.310961 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__brands.sql
[0m18:46:11.313961 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__budgets.sql
[0m18:46:11.317226 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__churns.sql
[0m18:46:11.320226 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__customers.sql
[0m18:46:11.323227 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__customer_classes.sql
[0m18:46:11.325226 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__departments.sql
[0m18:46:11.329226 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__materials.sql
[0m18:46:11.331329 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__md_customers.sql
[0m18:46:11.334329 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__md_pipeline_crms.sql
[0m18:46:11.337329 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__pbi_user_permissions.sql
[0m18:46:11.339329 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__periods.sql
[0m18:46:11.342329 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__product_groups.sql
[0m18:46:11.345329 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__regions.sql
[0m18:46:11.348716 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__salesmans.sql
[0m18:46:11.350716 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__teams.sql
[0m18:46:11.353716 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__top_customers.sql
[0m18:46:11.356715 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_qdtek_stg_excel_sales__budget.sql
[0m18:46:11.359888 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_qdtek_stg_excel_sales__daily_sales.sql
[0m18:46:11.363526 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_qdtek_stg_excel_sales__material.sql
[0m18:46:11.366608 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_qdtek_stg_excel_sales__salesman.sql
[0m18:46:11.368608 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_stg_excel_ntt_tb_ntt_4300.sql
[0m18:46:11.372685 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_stg_excel_qdtek_tb_account_mapping.sql
[0m18:46:11.375606 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_stg_excel_qdtek_tb_north_4001.sql
[0m18:46:11.378612 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_stg_excel_qdtek_tb_south_4002.sql
[0m18:46:11.383002 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_stg_excel_qdtek_tb_south_north_4000.sql
[0m18:46:11.704930 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'food_revenue' in the 'models' section of file 'models\food\marts\score_card\_food_score_card__models.yml'
[0m18:46:11.951832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e516722-bf45-4cff-bfcb-8eed953d70f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB0EAF610>]}
[0m18:46:11.997805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e516722-bf45-4cff-bfcb-8eed953d70f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB06A5250>]}
[0m18:46:11.997805 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m18:46:11.998877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e516722-bf45-4cff-bfcb-8eed953d70f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB0EAF430>]}
[0m18:46:12.003121 [info ] [MainThread]: 
[0m18:46:12.005125 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:46:12.007112 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m18:46:12.015178 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m18:46:12.015677 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m18:46:12.015677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:12.017689 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:46:12.017689 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:46:12.546999 [debug] [ThreadPool]: Redshift adapter: Error running SQL: select distinct nspname from pg_namespace
[0m18:46:12.546999 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m18:46:12.548002 [debug] [ThreadPool]: Redshift adapter: Error running SQL: macro list_schemas
[0m18:46:12.548002 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m18:46:12.549008 [debug] [ThreadPool]: On list_food: No close available on handle
[0m18:46:12.550009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:12.551038 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m18:46:12.551038 [info ] [MainThread]: 
[0m18:46:12.551998 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m18:46:12.551998 [error] [MainThread]: Encountered an error:
Database Error
  {'S': 'FATAL', 'C': '28000', 'M': 'password authentication failed for user "duc.nv"', 'F': '../src/pg/src/backend/libpq/auth.c', 'L': '423', 'R': 'auth_failed'}
[0m18:46:12.553000 [debug] [MainThread]: Command `dbt run` failed at 18:46:12.553000 after 4.43 seconds
[0m18:46:12.553000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FAE46BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB0EAFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB0EAF100>]}
[0m18:46:12.554085 [debug] [MainThread]: Flushing usage events
[0m18:47:23.803801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F792B8E5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F794AE3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F794AE3670>]}


============================== 18:47:23.806799 | 397d4a33-fb2c-4a51-a65e-71276ee365d4 ==============================
[0m18:47:23.806799 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:47:23.807802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:47:23.957934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F794D28E20>]}
[0m18:47:23.969935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F794DF2B50>]}
[0m18:47:24.010135 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:47:24.041874 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:47:24.042877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7954FA280>]}
[0m18:47:25.409946 [debug] [MainThread]: 1699: static parser successfully parsed farm\intermediate\sales\farm_int_farms__unioned.sql
[0m18:47:25.421209 [debug] [MainThread]: 1699: static parser successfully parsed farm\intermediate\sales\farm_int_sales_cammy__joined_dims.sql
[0m18:47:25.425141 [debug] [MainThread]: 1699: static parser successfully parsed farm\intermediate\sales\farm_int_sales_sol__added_farm_info.sql
[0m18:47:25.427209 [debug] [MainThread]: 1699: static parser successfully parsed farm\intermediate\sales\farm_int_sales_sol__unioned_adj_rev.sql
[0m18:47:25.430212 [debug] [MainThread]: 1699: static parser successfully parsed farm\intermediate\sales\farm_int_sol_vsdwh_salesvolumned__filtered_to_sales.sql
[0m18:47:25.433719 [debug] [MainThread]: 1699: static parser successfully parsed farm\marts\sales\farm_sales.sql
[0m18:47:25.436346 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\excel\sales\farm_stg_excel__budget.sql
[0m18:47:25.439351 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\excel\sales\farm_stg_excel__exchange_rate.sql
[0m18:47:25.442359 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\excel\sales\farm_stg_excel__master_data_adj.sql
[0m18:47:25.445348 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\excel\sales\farm_stg_excel__master_data_rev.sql
[0m18:47:25.448278 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\excel\sales\farm_stg_excel__master_farms.sql
[0m18:47:25.451690 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\redshift\farm_stg_redshift__sales_cammy.sql
[0m18:47:25.454845 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sap_ecc\farm_stg_sap_ecc__sales_cam_my.sql
[0m18:47:25.457845 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_arwblapp_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.460865 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_arwhyapp_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.462917 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_bsh1001app_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.467339 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_cbd1001app_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.470731 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_dnb2001app_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.473729 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_fasiaapp_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.475730 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_gfcamapp1_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.478728 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_gfvmmapp_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.481849 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_laoapp_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.485847 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_mtr1001app_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.488921 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_mtr2001app_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.491917 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_mtr2002app_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.494918 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_mym1001app_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.499488 [debug] [MainThread]: 1699: static parser successfully parsed farm\staging\sol\farm_stg_sol_starnapp_xp_01610ab_accthist_erp_final.sql
[0m18:47:25.502076 [debug] [MainThread]: 1603: static parser failed on farm\staging\sol\farm_stg_sol__vsdwh_salesvolumed.sql
[0m18:47:25.508148 [debug] [MainThread]: 1602: parser fallback to jinja rendering on farm\staging\sol\farm_stg_sol__vsdwh_salesvolumed.sql
[0m18:47:25.510134 [debug] [MainThread]: 1699: static parser successfully parsed feed\intermediate\ZPPR0019_formulaprice_bagamt.sql
[0m18:47:25.513394 [debug] [MainThread]: 1699: static parser successfully parsed feed\intermediate\margin\feed_int_zmllistn__calculate_internal_entry.sql
[0m18:47:25.516429 [debug] [MainThread]: 1699: static parser successfully parsed feed\intermediate\margin\feed_int_zmllistn__calculate_opening_balance.sql
[0m18:47:25.520670 [debug] [MainThread]: 1699: static parser successfully parsed feed\marts\margin\feed_margin.sql
[0m18:47:25.522740 [debug] [MainThread]: 1699: static parser successfully parsed feed\marts\sales\feed_sales_budget_2023.sql
[0m18:47:25.525752 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\excel\feed_stg_excel_donavet_tb_account_mapping.sql
[0m18:47:25.529126 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\excel\feed_stg_excel_donavet_tb_donavet_1100.sql
[0m18:47:25.532050 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__draft_mb51_006.sql
[0m18:47:25.535233 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__draft_mb51_006_101.sql
[0m18:47:25.538304 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__draft_mm60_006.sql
[0m18:47:25.541300 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__draft_zmllistn_005.sql
[0m18:47:25.544397 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__draft_zppr0019_006.sql
[0m18:47:25.547483 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__feed_seed_margin_draft_ke24_006.sql
[0m18:47:25.550613 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__feed_seed_margin_draft_ke25_006.sql
[0m18:47:25.552717 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__feed_seed_margin_draft_mb5b_005.sql
[0m18:47:25.556637 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sap_ecc\feed_stg_sap_ecc__fi_0fi_gl_12.sql
[0m18:47:25.559947 [debug] [MainThread]: 1699: static parser successfully parsed feed\staging\sol\feed_stg_sol_gfdnbapp_cn_dnb_tb_1000.sql
[0m18:47:25.562916 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_cms.sql
[0m18:47:25.575975 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_cms.sql
[0m18:47:25.577963 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_cms_compare.sql
[0m18:47:25.610752 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_cms_compare.sql
[0m18:47:25.613763 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_gkitchen.sql
[0m18:47:25.618408 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_gkitchen.sql
[0m18:47:25.620504 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_gkitchen_compare.sql
[0m18:47:25.634234 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_gkitchen_compare.sql
[0m18:47:25.636425 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_leboucher.sql
[0m18:47:25.642372 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_leboucher.sql
[0m18:47:25.644374 [debug] [MainThread]: 1603: static parser failed on food\audit\sales\food_audit_sales_leboucher_compare.sql
[0m18:47:25.654420 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\audit\sales\food_audit_sales_leboucher_compare.sql
[0m18:47:25.657412 [debug] [MainThread]: 1603: static parser failed on food\intermediate\core\dates.sql
[0m18:47:25.747864 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\intermediate\core\dates.sql
[0m18:47:25.749867 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\inventory\inventory_openning.sql
[0m18:47:25.752902 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_channels__unioned.sql
[0m18:47:25.755973 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_customer_groups_1__unioned.sql
[0m18:47:25.758974 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_customer_groups_2__unioned.sql
[0m18:47:25.762141 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_customer_groups__unioned.sql
[0m18:47:25.767141 [debug] [MainThread]: 1603: static parser failed on food\intermediate\sales\food_int_fi_ofi_acdoca_10__filtered_to_sales.sql
[0m18:47:25.775211 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\intermediate\sales\food_int_fi_ofi_acdoca_10__filtered_to_sales.sql
[0m18:47:25.777561 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_misa_lbc2022_generalledger__filtered_to_sales.sql
[0m18:47:25.780707 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_products__unioned.sql
[0m18:47:25.783999 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\food_int_sales_groups__unioned.sql
[0m18:47:25.787518 [debug] [MainThread]: 1603: static parser failed on food\intermediate\sales\food_int_sol_gnf1001apprepl_vsdwh_salesvolumed__grouped_to_sales.sql
[0m18:47:25.795810 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\intermediate\sales\food_int_sol_gnf1001apprepl_vsdwh_salesvolumed__grouped_to_sales.sql
[0m18:47:25.797803 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\mappings\food_sales_mapping_channels.sql
[0m18:47:25.800731 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\mappings\food_sales_mapping_customer_groups.sql
[0m18:47:25.803800 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\mappings\food_sales_mapping_lbc_customers.sql
[0m18:47:25.805801 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\mappings\food_sales_mapping_lbc_sales_groups.sql
[0m18:47:25.809012 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\sales\mappings\food_sales_mapping_materials.sql
[0m18:47:25.812015 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\score_card\food_int_fi_0fi_acdoca_10__filtered_to_cogs.sql
[0m18:47:25.815010 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\score_card\food_int_fi_0fi_acdoca_10__filtered_to_manufacturing_cost.sql
[0m18:47:25.818573 [debug] [MainThread]: 1699: static parser successfully parsed food\intermediate\score_card\food_int_fi_0fi_acdoca_10__filtered_to_revenue.sql
[0m18:47:25.821504 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_budget_of_accounting_department.sql
[0m18:47:25.824961 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_cms_billing_sales.sql
[0m18:47:25.828041 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_feedy_dnf_customers.sql
[0m18:47:25.831042 [debug] [MainThread]: 1603: static parser failed on food\marts\sales\food_gkitchen_sales.sql
[0m18:47:25.841814 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\marts\sales\food_gkitchen_sales.sql
[0m18:47:25.843886 [debug] [MainThread]: 1603: static parser failed on food\marts\sales\food_leboucher_sales.sql
[0m18:47:25.850935 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\marts\sales\food_leboucher_sales.sql
[0m18:47:25.853103 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_products.sql
[0m18:47:25.856155 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_sales_target_by_channels.sql
[0m18:47:25.859152 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\sales\food_sales_target_by_channels_products.sql
[0m18:47:25.862225 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_channels.sql
[0m18:47:25.865219 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_cogs.sql
[0m18:47:25.867159 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_companies.sql
[0m18:47:25.871186 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_cost_elements.sql
[0m18:47:25.875202 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_fi_scorecard.sql
[0m18:47:25.878194 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_manufacturing_cost.sql
[0m18:47:25.881193 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_mapping_categories.sql
[0m18:47:25.883193 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_mapping_costcenter_costcentergroup.sql
[0m18:47:25.887882 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_mapping_hierarchies_costelement.sql
[0m18:47:25.890882 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_mapping_pl_plgroup.sql
[0m18:47:25.893894 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_mapping_subcategories.sql
[0m18:47:25.896882 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_scorecard_kpi_budget.sql
[0m18:47:25.898883 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__budget_of_accounting_department.sql
[0m18:47:25.902920 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__lbc_sales_groups.sql
[0m18:47:25.905921 [debug] [MainThread]: 1603: static parser failed on food\staging\excel\sales\food_stg_excel_sales__master_data_customer_lbc.sql
[0m18:47:25.926628 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\excel\sales\food_stg_excel_sales__master_data_customer_lbc.sql
[0m18:47:25.927625 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__md_channels.sql
[0m18:47:25.930632 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__md_customer_groups.sql
[0m18:47:25.933986 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__md_products.sql
[0m18:47:25.937736 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__md_products_conversion_rate_lbc.sql
[0m18:47:25.940740 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__target_by_channel.sql
[0m18:47:25.942740 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\food_stg_excel_sales__target_by_channel_by_product.sql
[0m18:47:25.945742 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\excel\sales\base\base_excel_sales__master_data_customer_lbc.sql
[0m18:47:25.949089 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\misa\food_stg_excel_misa_lbc_tb_account_mapping.sql
[0m18:47:25.952962 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\misa\food_stg_excel_misa_lbc_tp_lbc_3200_v2.sql
[0m18:47:25.956031 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\misa\food_stg_misa__lbc_generalledger.sql
[0m18:47:25.959030 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__fi_0fi_acdoca_10.sql
[0m18:47:25.971232 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__fi_0fi_acdoca_10.sql
[0m18:47:25.973234 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\sap_s4\food_stg_sap_s4__fi_0fi_gl_12.sql
[0m18:47:25.976158 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0accnt_grp_text.sql
[0m18:47:25.981160 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0accnt_grp_text.sql
[0m18:47:25.983159 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0bill_type_text.sql
[0m18:47:25.987956 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0bill_type_text.sql
[0m18:47:25.989956 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0comp_code_text.sql
[0m18:47:26.026266 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0comp_code_text.sql
[0m18:47:26.028015 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0costcenter_text.sql
[0m18:47:26.032007 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0costcenter_text.sql
[0m18:47:26.034291 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0costelmnt_text.sql
[0m18:47:26.038311 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0costelmnt_text.sql
[0m18:47:26.040311 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0customer_text.sql
[0m18:47:26.044426 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0customer_text.sql
[0m18:47:26.046426 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0cust_group_text.sql
[0m18:47:26.051495 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0cust_group_text.sql
[0m18:47:26.053507 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0cust_grp1_text.sql
[0m18:47:26.059656 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0cust_grp1_text.sql
[0m18:47:26.061659 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0cust_grp2_text.sql
[0m18:47:26.065659 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0cust_grp2_text.sql
[0m18:47:26.067586 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0distr_chan_text.sql
[0m18:47:26.072626 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0distr_chan_text.sql
[0m18:47:26.075277 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\sap_s4\food_stg_sap_s4__md_0material_attr.sql
[0m18:47:26.077806 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0material_text.sql
[0m18:47:26.082812 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0material_text.sql
[0m18:47:26.083943 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0matl_type_text.sql
[0m18:47:26.090054 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0matl_type_text.sql
[0m18:47:26.091042 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0ord_reason_text.sql
[0m18:47:26.096032 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0ord_reason_text.sql
[0m18:47:26.097042 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0plant_text.sql
[0m18:47:26.102031 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0plant_text.sql
[0m18:47:26.104014 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0prod_hier_text.sql
[0m18:47:26.109033 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0prod_hier_text.sql
[0m18:47:26.110032 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0sales_dist_text.sql
[0m18:47:26.114042 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0sales_dist_text.sql
[0m18:47:26.116032 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0sales_grp_text.sql
[0m18:47:26.122785 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0sales_grp_text.sql
[0m18:47:26.123785 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__md_0sales_off_text.sql
[0m18:47:26.128788 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__md_0sales_off_text.sql
[0m18:47:26.129785 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__mm_2lis_03_bf.sql
[0m18:47:26.135017 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__mm_2lis_03_bf.sql
[0m18:47:26.137026 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__mm_2lis_03_um.sql
[0m18:47:26.141016 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__mm_2lis_03_um.sql
[0m18:47:26.143016 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__sd_2lis_11_vaitm.sql
[0m18:47:26.148015 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__sd_2lis_11_vaitm.sql
[0m18:47:26.150765 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__sd_2lis_13_vditm.sql
[0m18:47:26.155903 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__sd_2lis_13_vditm.sql
[0m18:47:26.157886 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__tbl_customer_sale_person.sql
[0m18:47:26.161886 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__tbl_customer_sale_person.sql
[0m18:47:26.163885 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__tbl_fcml_ccs_r_all_v.sql
[0m18:47:26.169171 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__tbl_fcml_ccs_r_all_v.sql
[0m18:47:26.171174 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\sap_s4\food_stg_sap_s4__tbl_vbpa.sql
[0m18:47:26.174172 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__tbl_ztt_zsdc0016.sql
[0m18:47:26.178171 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__tbl_ztt_zsdc0016.sql
[0m18:47:26.180319 [debug] [MainThread]: 1699: static parser successfully parsed food\staging\sol\food_stg_sol__gnf1001apprepl_vsdwh_salesvolumed.sql
[0m18:47:26.184396 [debug] [MainThread]: 1699: static parser successfully parsed food\tests\assert_cms_billing_sales_audit.sql
[0m18:47:26.187395 [debug] [MainThread]: 1699: static parser successfully parsed food\tests\assert_gkitchen_sales_audit.sql
[0m18:47:26.190396 [debug] [MainThread]: 1699: static parser successfully parsed food\tests\assert_leboucher_ref_no_is_not_null.sql
[0m18:47:26.192396 [debug] [MainThread]: 1699: static parser successfully parsed food\tests\assert_leboucher_sales_audit.sql
[0m18:47:26.195992 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_balance_sheet_backup.sql
[0m18:47:26.198995 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_fiscal_period.sql
[0m18:47:26.203651 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_mapping_account_pl_to_account_sap_union.sql
[0m18:47:26.206727 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_mapping_bs_gl_account.sql
[0m18:47:26.209652 [debug] [MainThread]: 1603: static parser failed on group\intermediate\core\consol_mapping_exchange_rate.sql
[0m18:47:26.213777 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\core\consol_mapping_exchange_rate.sql
[0m18:47:26.215777 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_mapping_legal_company_code_currency.sql
[0m18:47:26.218005 [debug] [MainThread]: 1699: static parser successfully parsed group\intermediate\core\consol_mapping_p_and_l_gl_account.sql
[0m18:47:26.221005 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_1000_solomon.sql
[0m18:47:26.229228 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_1000_solomon.sql
[0m18:47:26.231228 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2000_solomon.sql
[0m18:47:26.236141 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2000_solomon.sql
[0m18:47:26.238211 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2000_solomon_dong_nam_bo.sql
[0m18:47:26.243143 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2000_solomon_dong_nam_bo.sql
[0m18:47:26.245142 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2100_solomon.sql
[0m18:47:26.249142 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2100_solomon.sql
[0m18:47:26.251211 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2200_1001_solomon.sql
[0m18:47:26.255209 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2200_1001_solomon.sql
[0m18:47:26.257288 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2200_2001_solomon.sql
[0m18:47:26.262398 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2200_2001_solomon.sql
[0m18:47:26.264408 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2200_2002_solomon.sql
[0m18:47:26.269509 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2200_2002_solomon.sql
[0m18:47:26.271515 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2300_solomon.sql
[0m18:47:26.275537 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2300_solomon.sql
[0m18:47:26.277537 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_2400_solomon.sql
[0m18:47:26.281537 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_2400_solomon.sql
[0m18:47:26.283538 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_5000_cam_solomon.sql
[0m18:47:26.288767 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_5000_cam_solomon.sql
[0m18:47:26.290741 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_5000_cbd1001_solomon.sql
[0m18:47:26.294818 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_5000_cbd1001_solomon.sql
[0m18:47:26.296825 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_5000_star_solomon.sql
[0m18:47:26.301825 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_5000_star_solomon.sql
[0m18:47:26.304033 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_5100_solomon.sql
[0m18:47:26.308037 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_5100_solomon.sql
[0m18:47:26.310074 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_p_l\farm_pl_5200_solomon.sql
[0m18:47:26.314156 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_p_l\farm_pl_5200_solomon.sql
[0m18:47:26.316085 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_1000_solomon.sql
[0m18:47:26.324340 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_1000_solomon.sql
[0m18:47:26.326364 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2000_solomon.sql
[0m18:47:26.330338 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2000_solomon.sql
[0m18:47:26.332332 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2000_solomon_dong_nam_bo.sql
[0m18:47:26.338154 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2000_solomon_dong_nam_bo.sql
[0m18:47:26.340154 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2100_solomon.sql
[0m18:47:26.344224 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2100_solomon.sql
[0m18:47:26.346223 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2200_1001_solomon.sql
[0m18:47:26.351765 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2200_1001_solomon.sql
[0m18:47:26.353797 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2200_2001_solomon.sql
[0m18:47:26.357809 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2200_2001_solomon.sql
[0m18:47:26.359808 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2200_2002_solomon.sql
[0m18:47:26.364968 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2200_2002_solomon.sql
[0m18:47:26.367036 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2300_solomon.sql
[0m18:47:26.370640 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2300_solomon.sql
[0m18:47:26.372636 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_2400_solomon.sql
[0m18:47:26.376636 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_2400_solomon.sql
[0m18:47:26.378642 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_5000_cam_solomon.sql
[0m18:47:26.383565 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_5000_cam_solomon.sql
[0m18:47:26.385565 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_5000_cbd1001_solomon.sql
[0m18:47:26.389635 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_5000_cbd1001_solomon.sql
[0m18:47:26.390636 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_5000_star_solomon.sql
[0m18:47:26.396129 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_5000_star_solomon.sql
[0m18:47:26.398184 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_5100_solomon.sql
[0m18:47:26.403265 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_5100_solomon.sql
[0m18:47:26.405267 [debug] [MainThread]: 1603: static parser failed on group\intermediate\farm\farm_tb\farm_tb_5200_solomon.sql
[0m18:47:26.409185 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\farm\farm_tb\farm_tb_5200_solomon.sql
[0m18:47:26.411529 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_pl\feed_pl_1000_dnb_solomon.sql
[0m18:47:26.417898 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_pl\feed_pl_1000_dnb_solomon.sql
[0m18:47:26.420246 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_pl\feed_pl_1000_sap.sql
[0m18:47:26.425152 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_pl\feed_pl_1000_sap.sql
[0m18:47:26.428095 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_pl\feed_pl_1100_donavet_excel.sql
[0m18:47:26.432190 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_pl\feed_pl_1100_donavet_excel.sql
[0m18:47:26.436225 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_tb\feed_tb_1000_dnb_solomon.sql
[0m18:47:26.440126 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_tb\feed_tb_1000_dnb_solomon.sql
[0m18:47:26.442126 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_tb\feed_tb_1000_sap.sql
[0m18:47:26.446491 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_tb\feed_tb_1000_sap.sql
[0m18:47:26.448492 [debug] [MainThread]: 1603: static parser failed on group\intermediate\feed\feed_tb\feed_tb_1100_donavet_excel.sql
[0m18:47:26.452753 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\feed\feed_tb\feed_tb_1100_donavet_excel.sql
[0m18:47:26.454752 [debug] [MainThread]: 1603: static parser failed on group\intermediate\food\food_p_l\food_pl_3000_and_3100.sql
[0m18:47:26.460531 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\food\food_p_l\food_pl_3000_and_3100.sql
[0m18:47:26.462530 [debug] [MainThread]: 1603: static parser failed on group\intermediate\food\food_p_l\food_pl_3200_lbc.sql
[0m18:47:26.466991 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\food\food_p_l\food_pl_3200_lbc.sql
[0m18:47:26.468412 [debug] [MainThread]: 1603: static parser failed on group\intermediate\food\food_tb\food_tb_3000_and_3100.sql
[0m18:47:26.473410 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\food\food_tb\food_tb_3000_and_3100.sql
[0m18:47:26.475512 [debug] [MainThread]: 1603: static parser failed on group\intermediate\food\food_tb\food_tb_3200_lbc.sql
[0m18:47:26.479512 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\food\food_tb\food_tb_3200_lbc.sql
[0m18:47:26.480511 [debug] [MainThread]: 1603: static parser failed on group\intermediate\qdt\qdt_pl\qdt_pl_4200_solomon.sql
[0m18:47:26.486039 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\qdt\qdt_pl\qdt_pl_4200_solomon.sql
[0m18:47:26.487957 [debug] [MainThread]: 1603: static parser failed on group\intermediate\qdt\qdt_tb\qdt_tb_4200_solomon.sql
[0m18:47:26.493254 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\qdt\qdt_tb\qdt_tb_4200_solomon.sql
[0m18:47:26.495256 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_pl\tech_pl_4000_qdtek.sql
[0m18:47:26.499168 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_pl\tech_pl_4000_qdtek.sql
[0m18:47:26.501629 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_pl\tech_pl_4001_qdtek_north.sql
[0m18:47:26.507138 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_pl\tech_pl_4001_qdtek_north.sql
[0m18:47:26.509650 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_pl\tech_pl_4002_qdtek_south.sql
[0m18:47:26.513645 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_pl\tech_pl_4002_qdtek_south.sql
[0m18:47:26.515648 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_pl\tech_pl_4300_ntt.sql
[0m18:47:26.520411 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_pl\tech_pl_4300_ntt.sql
[0m18:47:26.522933 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_tb\tech_tb_4000_qdtek.sql
[0m18:47:26.560376 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_tb\tech_tb_4000_qdtek.sql
[0m18:47:26.561376 [debug] [MainThread]: 1603: static parser failed on group\intermediate\tech\tech_tb\tech_tb_4300_ntt.sql
[0m18:47:26.566448 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\intermediate\tech\tech_tb\tech_tb_4300_ntt.sql
[0m18:47:26.568149 [debug] [MainThread]: 1603: static parser failed on group\marts\finance\financial_profit_loss.sql
[0m18:47:26.579074 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\marts\finance\financial_profit_loss.sql
[0m18:47:26.581074 [debug] [MainThread]: 1603: static parser failed on group\marts\finance\financial_statements.sql
[0m18:47:26.592407 [debug] [MainThread]: 1602: parser fallback to jinja rendering on group\marts\finance\financial_statements.sql
[0m18:47:26.594407 [debug] [MainThread]: 1699: static parser successfully parsed group\marts\finance\financial_statements_backup.sql
[0m18:47:26.597407 [debug] [MainThread]: 1699: static parser successfully parsed group\marts\finance\mapping_md_balance_sheet_code.sql
[0m18:47:26.600451 [debug] [MainThread]: 1699: static parser successfully parsed group\marts\finance\mapping_md_p_l_account.sql
[0m18:47:26.604552 [debug] [MainThread]: 1699: static parser successfully parsed qdt\staging\sol\qdt_stg_sol_log5001appxp_01610ab_accthist_erp_final.sql
[0m18:47:26.607620 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__actual_sales__joined.sql
[0m18:47:26.609620 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__churn__grouped_by_customer.sql
[0m18:47:26.612621 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__customer_classs__grouped_by_month.sql
[0m18:47:26.615623 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__material__distinct.sql
[0m18:47:26.618463 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__po_type__grouped_by_billing_number.sql
[0m18:47:26.621464 [debug] [MainThread]: 1699: static parser successfully parsed tech\intermediate\sales\tech_qdtek_int_sales__salesman__distinct.sql
[0m18:47:26.624462 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__actual_sales.sql
[0m18:47:26.626472 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__billings.sql
[0m18:47:26.629461 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__branches.sql
[0m18:47:26.631760 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__brands.sql
[0m18:47:26.635842 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__budgets.sql
[0m18:47:26.638842 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__churns.sql
[0m18:47:26.640843 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__customers.sql
[0m18:47:26.643843 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__customer_classes.sql
[0m18:47:26.645842 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__departments.sql
[0m18:47:26.650409 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__materials.sql
[0m18:47:26.653621 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__md_customers.sql
[0m18:47:26.656683 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__md_pipeline_crms.sql
[0m18:47:26.658694 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__pbi_user_permissions.sql
[0m18:47:26.661683 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__periods.sql
[0m18:47:26.663901 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__product_groups.sql
[0m18:47:26.666831 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__regions.sql
[0m18:47:26.669902 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__salesmans.sql
[0m18:47:26.672900 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__teams.sql
[0m18:47:26.674901 [debug] [MainThread]: 1699: static parser successfully parsed tech\marts\sales\tech_qdtek_sales__top_customers.sql
[0m18:47:26.678638 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_qdtek_stg_excel_sales__budget.sql
[0m18:47:26.681644 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_qdtek_stg_excel_sales__daily_sales.sql
[0m18:47:26.684949 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_qdtek_stg_excel_sales__material.sql
[0m18:47:26.687948 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_qdtek_stg_excel_sales__salesman.sql
[0m18:47:26.690982 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_stg_excel_ntt_tb_ntt_4300.sql
[0m18:47:26.694318 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_stg_excel_qdtek_tb_account_mapping.sql
[0m18:47:26.697462 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_stg_excel_qdtek_tb_north_4001.sql
[0m18:47:26.700718 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_stg_excel_qdtek_tb_south_4002.sql
[0m18:47:26.703879 [debug] [MainThread]: 1699: static parser successfully parsed tech\staging\excel\tech_stg_excel_qdtek_tb_south_north_4000.sql
[0m18:47:27.034906 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'food_revenue' in the 'models' section of file 'models\food\marts\score_card\_food_score_card__models.yml'
[0m18:47:27.253171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F794F36250>]}
[0m18:47:27.296025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79586B5B0>]}
[0m18:47:27.296025 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m18:47:27.297016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F794F36C40>]}
[0m18:47:27.302200 [info ] [MainThread]: 
[0m18:47:27.303172 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:47:27.306132 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m18:47:27.312132 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m18:47:27.312132 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m18:47:27.312132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:27.313132 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:27.314132 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:27.887312 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:47:27.891429 [debug] [ThreadPool]: On list_food: Close
[0m18:47:27.904955 [debug] [ThreadPool]: Acquiring new redshift connection 'list_farm_nghi_dev'
[0m18:47:27.912175 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m18:47:27.912175 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m18:47:27.913173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:27.913173 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:27.913173 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:28.177160 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:28.178176 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m18:47:28.179173 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:47:28.254141 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:28.258116 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m18:47:28.328009 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m18:47:28.330084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_food_nghi_dev)
[0m18:47:28.337087 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m18:47:28.341137 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m18:47:28.341137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:28.342209 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:28.343211 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:28.606548 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:28.606548 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m18:47:28.606548 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:47:28.682970 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:28.684368 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m18:47:28.744368 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m18:47:28.745432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_food_nghi_dev, now list_group_nghi_dev)
[0m18:47:28.754654 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m18:47:28.755667 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m18:47:28.755667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:28.755667 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:28.756653 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:29.026277 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:29.027265 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m18:47:29.027265 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:47:29.117826 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:29.119855 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m18:47:29.196033 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m18:47:29.199076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_group_nghi_dev, now list_tech_nghi_dev)
[0m18:47:29.205651 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m18:47:29.206654 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m18:47:29.206654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:29.206654 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:29.207582 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:29.449642 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:29.450144 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m18:47:29.450718 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:47:29.533478 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:29.535149 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m18:47:29.595869 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m18:47:29.596867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_feed_nghi_dev)
[0m18:47:29.601491 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m18:47:29.601491 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m18:47:29.601491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:29.602490 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:29.602490 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:29.876129 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:29.877131 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m18:47:29.877131 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:47:29.963220 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:29.965751 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m18:47:30.036660 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m18:47:30.057840 [debug] [MainThread]: Using redshift connection "master"
[0m18:47:30.058841 [debug] [MainThread]: On master: BEGIN
[0m18:47:30.058841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:47:30.059842 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:30.059842 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:30.358238 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:30.358238 [debug] [MainThread]: Using redshift connection "master"
[0m18:47:30.358238 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:47:30.494159 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:30.501724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7953569D0>]}
[0m18:47:30.501724 [debug] [MainThread]: On master: ROLLBACK
[0m18:47:30.582288 [debug] [MainThread]: Using redshift connection "master"
[0m18:47:30.582288 [debug] [MainThread]: On master: BEGIN
[0m18:47:30.612736 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:30.613725 [debug] [MainThread]: On master: COMMIT
[0m18:47:30.613725 [debug] [MainThread]: Using redshift connection "master"
[0m18:47:30.613725 [debug] [MainThread]: On master: COMMIT
[0m18:47:30.674417 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:30.675426 [debug] [MainThread]: On master: Close
[0m18:47:30.676425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:47:30.678350 [info ] [MainThread]: 
[0m18:47:30.741666 [debug] [Thread-1  ]: Began running node model.sales_group.food_mapping_costcenter_costcentergroup
[0m18:47:30.741666 [info ] [Thread-1  ]: 1 of 10 START sql table model nghi_dev.food_mapping_costcenter_costcentergroup . [RUN]
[0m18:47:30.743568 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_mapping_costcenter_costcentergroup'
[0m18:47:30.744640 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_mapping_costcenter_costcentergroup
[0m18:47:30.748296 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:47:30.755391 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_costcenter_costcentergroup (compile): 18:47:30.744640 => 18:47:30.754391
[0m18:47:30.755391 [debug] [Thread-1  ]: Began executing node model.sales_group.food_mapping_costcenter_costcentergroup
[0m18:47:30.804371 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:47:30.808951 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:47:30.810081 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: BEGIN
[0m18:47:30.810081 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:47:30.810982 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:30.810982 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:31.066413 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:31.067522 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:47:31.068523 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: create  table
    "food"."nghi_dev"."food_mapping_costcenter_costcentergroup__dbt_tmp"
    
    
    
  as (
    select 
cost_center as costcenter_code, 
cost_center_name as costcenter_name, 
cc_group as costcenter_group_code, 
cc_group_name as  costcenter_group_name
from "food"."nghi_dev"."food_seed_scorecard_mapping_cost_center_ccgroup"
  );
[0m18:47:31.096107 [debug] [Thread-1  ]: Redshift adapter: Redshift error: relation "nghi_dev.food_seed_scorecard_mapping_cost_center_ccgroup" does not exist
[0m18:47:31.096107 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: ROLLBACK
[0m18:47:31.145061 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_costcenter_costcentergroup (execute): 18:47:30.756391 => 18:47:31.144070
[0m18:47:31.146061 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: Close
[0m18:47:31.155367 [debug] [Thread-1  ]: Database Error in model food_mapping_costcenter_costcentergroup (models\food\marts\score_card\food_mapping_costcenter_costcentergroup.sql)
  relation "nghi_dev.food_seed_scorecard_mapping_cost_center_ccgroup" does not exist
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_mapping_costcenter_costcentergroup.sql
[0m18:47:31.156383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7953B5C70>]}
[0m18:47:31.156383 [error] [Thread-1  ]: 1 of 10 ERROR creating sql table model nghi_dev.food_mapping_costcenter_costcentergroup  [[31mERROR[0m in 0.41s]
[0m18:47:31.157383 [debug] [Thread-1  ]: Finished running node model.sales_group.food_mapping_costcenter_costcentergroup
[0m18:47:31.158394 [debug] [Thread-1  ]: Began running node model.sales_group.food_mapping_hierarchies_costelement
[0m18:47:31.158394 [info ] [Thread-1  ]: 2 of 10 START sql table model nghi_dev.food_mapping_hierarchies_costelement .... [RUN]
[0m18:47:31.159381 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_mapping_costcenter_costcentergroup, now model.sales_group.food_mapping_hierarchies_costelement)
[0m18:47:31.159381 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_mapping_hierarchies_costelement
[0m18:47:31.163441 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:47:31.165594 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_hierarchies_costelement (compile): 18:47:31.160393 => 18:47:31.165089
[0m18:47:31.166599 [debug] [Thread-1  ]: Began executing node model.sales_group.food_mapping_hierarchies_costelement
[0m18:47:31.177681 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:47:31.181831 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:47:31.182263 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: BEGIN
[0m18:47:31.183910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:31.185910 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:31.186914 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:31.456680 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:31.456680 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:47:31.456680 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: create  table
    "food"."nghi_dev"."food_mapping_hierarchies_costelement__dbt_tmp"
    
    
    
  as (
    select
    hier_cost_element_code,
    hier_cost_element_name,
    case
        when cost_element is not null then right(cost_element, 10)
    end as cost_element_code
from "food"."nghi_dev"."food_seed_scorecard_hierarchies_costelement"
  );
[0m18:47:31.489237 [debug] [Thread-1  ]: Redshift adapter: Redshift error: relation "nghi_dev.food_seed_scorecard_hierarchies_costelement" does not exist
[0m18:47:31.490308 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: ROLLBACK
[0m18:47:31.549310 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_hierarchies_costelement (execute): 18:47:31.166599 => 18:47:31.548808
[0m18:47:31.550380 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: Close
[0m18:47:31.555376 [debug] [Thread-1  ]: Database Error in model food_mapping_hierarchies_costelement (models\food\marts\score_card\food_mapping_hierarchies_costelement.sql)
  relation "nghi_dev.food_seed_scorecard_hierarchies_costelement" does not exist
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_mapping_hierarchies_costelement.sql
[0m18:47:31.555376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F791A6DF70>]}
[0m18:47:31.556377 [error] [Thread-1  ]: 2 of 10 ERROR creating sql table model nghi_dev.food_mapping_hierarchies_costelement  [[31mERROR[0m in 0.40s]
[0m18:47:31.558374 [debug] [Thread-1  ]: Finished running node model.sales_group.food_mapping_hierarchies_costelement
[0m18:47:31.558374 [debug] [Thread-1  ]: Began running node model.sales_group.food_mapping_pl_plgroup
[0m18:47:31.558374 [info ] [Thread-1  ]: 3 of 10 START sql table model nghi_dev.food_mapping_pl_plgroup ................. [RUN]
[0m18:47:31.560410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_mapping_hierarchies_costelement, now model.sales_group.food_mapping_pl_plgroup)
[0m18:47:31.560410 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_mapping_pl_plgroup
[0m18:47:31.563444 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_mapping_pl_plgroup"
[0m18:47:31.566077 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_pl_plgroup (compile): 18:47:31.560410 => 18:47:31.566077
[0m18:47:31.567191 [debug] [Thread-1  ]: Began executing node model.sales_group.food_mapping_pl_plgroup
[0m18:47:31.571880 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_mapping_pl_plgroup"
[0m18:47:31.573878 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m18:47:31.574880 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: BEGIN
[0m18:47:31.574880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:31.575880 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:31.575880 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:31.847309 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:31.848229 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m18:47:31.849234 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: create  table
    "food"."nghi_dev"."food_mapping_pl_plgroup__dbt_tmp"
    
    
    
  as (
    select 
'00' || gl_account as "G/L Account",
 name_gl_account, 
 pl_code, 
 pl_name, 
 pl_group_code, 
 pl_group_name
from "food"."nghi_dev"."food_seed_scorecard_mapping_pl_and_plgroup" pl
  );
[0m18:47:31.883545 [debug] [Thread-1  ]: Redshift adapter: Redshift error: relation "nghi_dev.food_seed_scorecard_mapping_pl_and_plgroup" does not exist
[0m18:47:31.884544 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: ROLLBACK
[0m18:47:31.949738 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_pl_plgroup (execute): 18:47:31.567762 => 18:47:31.948624
[0m18:47:31.950721 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: Close
[0m18:47:31.954257 [debug] [Thread-1  ]: Database Error in model food_mapping_pl_plgroup (models\food\marts\score_card\food_mapping_pl_plgroup.sql)
  relation "nghi_dev.food_seed_scorecard_mapping_pl_and_plgroup" does not exist
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_mapping_pl_plgroup.sql
[0m18:47:31.954257 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F791AD1EB0>]}
[0m18:47:31.955370 [error] [Thread-1  ]: 3 of 10 ERROR creating sql table model nghi_dev.food_mapping_pl_plgroup ........ [[31mERROR[0m in 0.39s]
[0m18:47:31.956277 [debug] [Thread-1  ]: Finished running node model.sales_group.food_mapping_pl_plgroup
[0m18:47:31.956277 [debug] [Thread-1  ]: Began running node model.sales_group.food_scorecard_kpi_budget
[0m18:47:31.957353 [info ] [Thread-1  ]: 4 of 10 START sql table model nghi_dev.kpi_budget .............................. [RUN]
[0m18:47:31.958317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_mapping_pl_plgroup, now model.sales_group.food_scorecard_kpi_budget)
[0m18:47:31.958317 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_scorecard_kpi_budget
[0m18:47:31.961353 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_scorecard_kpi_budget"
[0m18:47:31.963279 [debug] [Thread-1  ]: Timing info for model.sales_group.food_scorecard_kpi_budget (compile): 18:47:31.958317 => 18:47:31.963279
[0m18:47:31.963279 [debug] [Thread-1  ]: Began executing node model.sales_group.food_scorecard_kpi_budget
[0m18:47:31.970939 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_scorecard_kpi_budget"
[0m18:47:31.981528 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m18:47:31.981884 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: BEGIN
[0m18:47:31.981884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:31.983617 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:31.983617 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:32.279310 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:32.279310 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m18:47:32.280321 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: create  table
    "food"."nghi_dev"."kpi_budget__dbt_tmp"
    
    
    
  as (
    select
    cat_code,
    cat_name,
    subcat1_code as subcat_1_code,
    subcat1_name as subcat_1_name,
    '' as subcat_2_code,
    '' as subcat_2_name,
    '' as "G/L Account",
    '' as expense_group_code,
    '' as expense_group_name,
    '' as company_code,
    case 
    when month is not null 
    then left(month,4) || right(month,2) || '01'
    end as posting_date,
    '' as channel_code,
    '' as channel_name,
    '' as matnr,
    '20' as value_type,
    month as fiscyearper,
        kpi_code,
        kpi_name,
    '' as pl_code, 
    '' as pl_name, 
    '' as pl_group_code, 
    '' as pl_group_name,
    '' as costcenter_code,
    '' as costcenter_name,
    '' as costcenter_full_name,
    '' as costcenter_group_code,
    '' as costcenter_group_name,
    0 as revenue,
    0 as quantity,
    0 as "revenue(D/KG)",
    0 as inter_profit,
    0 as cogs,
    0 as "cogs(+)",
    0 as "gross contribution (3) =  (1) - (+)",
    0 as "manufacturing cost (4)",
    0 as "gross margin (5) = (3) - (4)",
    0 as "mkt & commercial costs (6)",
    0 as "administrative costs (7)",
    0 as "chi phí tài chính(8)",
    0 as "thu nhập tài chính(9)",
    amount::numeric(38,2) as budget
from "food"."nghi_dev"."food_seed_scorecard_budget_2023"
  );
[0m18:47:32.313519 [debug] [Thread-1  ]: Redshift adapter: Redshift error: relation "nghi_dev.food_seed_scorecard_budget_2023" does not exist
[0m18:47:32.315178 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: ROLLBACK
[0m18:47:32.374581 [debug] [Thread-1  ]: Timing info for model.sales_group.food_scorecard_kpi_budget (execute): 18:47:31.964277 => 18:47:32.373524
[0m18:47:32.375598 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: Close
[0m18:47:32.380589 [debug] [Thread-1  ]: Database Error in model food_scorecard_kpi_budget (models\food\marts\score_card\food_scorecard_kpi_budget.sql)
  relation "nghi_dev.food_seed_scorecard_budget_2023" does not exist
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_scorecard_kpi_budget.sql
[0m18:47:32.382076 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F79503A6A0>]}
[0m18:47:32.382076 [error] [Thread-1  ]: 4 of 10 ERROR creating sql table model nghi_dev.kpi_budget ..................... [[31mERROR[0m in 0.42s]
[0m18:47:32.384121 [debug] [Thread-1  ]: Finished running node model.sales_group.food_scorecard_kpi_budget
[0m18:47:32.384121 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m18:47:32.385216 [info ] [Thread-1  ]: 5 of 10 START sql view model nghi_dev.food_stg_sap_s4__fi_0fi_acdoca_10 ........ [RUN]
[0m18:47:32.386122 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_scorecard_kpi_budget, now model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10)
[0m18:47:32.387265 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m18:47:32.394129 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:32.398215 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10 (compile): 18:47:32.387911 => 18:47:32.397050
[0m18:47:32.399722 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m18:47:32.425179 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:32.430179 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:32.431455 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: BEGIN
[0m18:47:32.431955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:32.433098 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:32.433098 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:32.671410 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:32.672406 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:32.673417 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: create view "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10__dbt_tmp" as (
    

with source as (

    

    select *
    from "food"."stg_sap_s4"."fi_0fi_acdoca_10"
    where
        
            budat >= to_char(now()::date - interval '1 day', 'YYYYMMDD')
        
        
        
),

deduped as (
    with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by rclnt, rldnr, rbukrs, gjahr, belnr, docln
                order by _created_at desc
            ) as rn
        from source as _inner
    )

    select
        distinct data.*
    from source as data
    
    natural join row_numbered
    where row_numbered.rn = 1
)

select * from deduped
  ) with no schema binding;
[0m18:47:32.785794 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:32.796966 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:32.796966 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: alter table "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10" rename to "food_stg_sap_s4__fi_0fi_acdoca_10__dbt_backup"
[0m18:47:32.890176 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:32.899258 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:32.900272 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: alter table "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10__dbt_tmp" rename to "food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:32.975569 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:32.996345 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m18:47:32.997338 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:32.997338 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m18:47:33.640406 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:47:33.641404 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:33.642417 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: BEGIN
[0m18:47:33.693001 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:33.702989 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:33.702989 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: drop table if exists "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10__dbt_backup" cascade
[0m18:47:33.763320 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:33.764680 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m18:47:33.764680 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:33.765725 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m18:47:34.495607 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:47:34.496607 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:47:34.498540 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: BEGIN
[0m18:47:34.526342 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:34.528341 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10 (execute): 18:47:32.399722 => 18:47:34.528341
[0m18:47:34.529340 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: ROLLBACK
[0m18:47:34.593230 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: Close
[0m18:47:34.593940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7953498B0>]}
[0m18:47:34.595325 [info ] [Thread-1  ]: 5 of 10 OK created sql view model nghi_dev.food_stg_sap_s4__fi_0fi_acdoca_10 ... [[32mSUCCESS[0m in 2.21s]
[0m18:47:34.596343 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m18:47:34.596682 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m18:47:34.597191 [info ] [Thread-1  ]: 6 of 10 START sql view model nghi_dev.food_stg_sap_s4__md_0costcenter_text ..... [RUN]
[0m18:47:34.598541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10, now model.sales_group.food_stg_sap_s4__md_0costcenter_text)
[0m18:47:34.598677 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m18:47:34.602691 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:47:34.606322 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0costcenter_text (compile): 18:47:34.598677 => 18:47:34.605691
[0m18:47:34.606864 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m18:47:34.614409 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:47:34.621580 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:47:34.622590 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: BEGIN
[0m18:47:34.622590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:34.624176 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:34.624676 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:34.926896 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:34.928890 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:47:34.928890 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: create view "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text__dbt_tmp" as (
    -- TODO: add dedup mechanism, ex. truncate before loading, or use macro (get lastest
-- row), ...
with
    selected_fields as (
        select kostl as code, txtsh as short_name, txtmd as medium_name
        from "food"."stg_sap_s4"."md_0costcenter_text"
        where langu = 'E' and kokrs = '1000'
    ),

    deduped as (
        with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by code
                order by code asc
            ) as rn
        from selected_fields as _inner
    )

    select
        distinct data.*
    from selected_fields as data
    
    natural join row_numbered
    where row_numbered.rn = 1
    )
select *
from deduped
order by code
  ) with no schema binding;
[0m18:47:35.050295 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:35.054777 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:47:35.054777 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text__dbt_tmp" rename to "food_stg_sap_s4__md_0costcenter_text"
[0m18:47:35.144420 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:35.146417 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m18:47:35.146417 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:47:35.146417 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m18:47:35.710110 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:47:35.710860 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:47:35.710860 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: BEGIN
[0m18:47:35.769677 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:35.775158 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:47:35.776230 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: drop view if exists "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text__dbt_backup" cascade
[0m18:47:35.834910 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:35.837234 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m18:47:35.837234 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:47:35.837234 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m18:47:35.876376 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:35.877376 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:47:35.877376 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: BEGIN
[0m18:47:35.906245 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:35.907253 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0costcenter_text (execute): 18:47:34.607100 => 18:47:35.907253
[0m18:47:35.907253 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: ROLLBACK
[0m18:47:35.972845 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: Close
[0m18:47:35.973845 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7958DB5B0>]}
[0m18:47:35.975432 [info ] [Thread-1  ]: 6 of 10 OK created sql view model nghi_dev.food_stg_sap_s4__md_0costcenter_text  [[32mSUCCESS[0m in 1.38s]
[0m18:47:35.975931 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m18:47:35.976935 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m18:47:35.976935 [info ] [Thread-1  ]: 7 of 10 START sql view model nghi_dev.food_stg_sap_s4__md_0distr_chan_text ..... [RUN]
[0m18:47:35.977935 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__md_0costcenter_text, now model.sales_group.food_stg_sap_s4__md_0distr_chan_text)
[0m18:47:35.977935 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m18:47:35.981679 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:35.983668 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0distr_chan_text (compile): 18:47:35.977935 => 18:47:35.983668
[0m18:47:35.984667 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m18:47:35.988677 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:35.994345 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:35.994345 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: BEGIN
[0m18:47:35.994345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:35.995334 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:35.995334 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:36.270028 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:36.270028 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:36.271129 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: create view "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text__dbt_tmp" as (
    -- TODO: add dedup mechanism, ex. truncate before loading, or use macro (get lastest
-- row), ...
with
    selected_fields as (
        select vtweg as code, vtext as name
        from "food"."stg_sap_s4"."md_0distr_chan_text"
        where spras = 'E'
    ),

    deduped as (
        with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by code
                order by name asc
            ) as rn
        from selected_fields as _inner
    )

    select
        distinct data.*
    from selected_fields as data
    
    natural join row_numbered
    where row_numbered.rn = 1
    )
select *
from deduped
order by code
  ) with no schema binding;
[0m18:47:36.396384 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:36.399564 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:36.400564 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" rename to "food_stg_sap_s4__md_0distr_chan_text__dbt_backup"
[0m18:47:36.487232 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:36.491233 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:36.492243 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text__dbt_tmp" rename to "food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:36.580368 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:36.584791 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m18:47:36.585793 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:36.586803 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m18:47:37.121911 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:47:37.122913 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:37.122913 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: BEGIN
[0m18:47:37.182737 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:37.189732 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:37.190787 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: drop view if exists "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text__dbt_backup" cascade
[0m18:47:37.252941 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:37.256127 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m18:47:37.257151 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:37.257151 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m18:47:37.654428 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:37.656419 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:47:37.656419 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: BEGIN
[0m18:47:37.686837 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:37.689835 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0distr_chan_text (execute): 18:47:35.984667 => 18:47:37.688840
[0m18:47:37.691140 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: ROLLBACK
[0m18:47:37.750867 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: Close
[0m18:47:37.751940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7958EEC40>]}
[0m18:47:37.753000 [info ] [Thread-1  ]: 7 of 10 OK created sql view model nghi_dev.food_stg_sap_s4__md_0distr_chan_text  [[32mSUCCESS[0m in 1.77s]
[0m18:47:37.755101 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m18:47:37.755101 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m18:47:37.755101 [info ] [Thread-1  ]: 8 of 10 START sql table model nghi_dev.food_stg_sap_s4__tbl_fcml_ccs_r_all_v ... [RUN]
[0m18:47:37.757098 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__md_0distr_chan_text, now model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v)
[0m18:47:37.757098 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m18:47:37.761145 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:47:37.763474 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v (compile): 18:47:37.757098 => 18:47:37.762972
[0m18:47:37.763533 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m18:47:37.768674 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:47:37.772335 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:47:37.773266 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: BEGIN
[0m18:47:37.773266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:37.774296 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:47:37.774296 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:47:38.059697 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:47:38.060766 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:47:38.060766 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: create  table
    "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_tmp"
    
    
    
  as (
    

with
    source as (select * from "food"."stg_sap_s4"."tbl_fcml_ccs_r_all_v"),

    deduped as (
        with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by kalnr_mat, poper, bdatj, run_act, run_appl, categ, ptyp, psart, kalnr_pmat, bvalt, process, elesmhk, element, mlcct, curtp 
                order by kalnr_mat desc
            ) as rn
        from source as _inner
    )

    select
        distinct data.*
    from source as data
    
    natural join row_numbered
    where row_numbered.rn = 1
    )

select *
from deduped
  );
[0m18:48:28.616454 [debug] [Thread-1  ]: SQL status: SUCCESS in 51.0 seconds
[0m18:48:28.624397 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:48:28.624397 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: alter table "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_tmp" rename to "food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:48:28.774577 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:28.783727 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m18:48:28.783727 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:48:28.784727 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m18:48:29.313632 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:48:29.314630 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:48:29.315630 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: BEGIN
[0m18:48:29.377299 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:29.384227 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:48:29.385301 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: drop table if exists "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_backup" cascade
[0m18:48:29.448685 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:29.449642 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m18:48:29.449642 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:48:29.450642 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m18:48:29.490555 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:29.491549 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:48:29.491549 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: BEGIN
[0m18:48:29.521621 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:29.522660 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v (execute): 18:47:37.763533 => 18:48:29.522660
[0m18:48:29.523612 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: ROLLBACK
[0m18:48:29.585032 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: Close
[0m18:48:29.586032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d4a33-fb2c-4a51-a65e-71276ee365d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F795BC5D60>]}
[0m18:48:29.586032 [info ] [Thread-1  ]: 8 of 10 OK created sql table model nghi_dev.food_stg_sap_s4__tbl_fcml_ccs_r_all_v  [[32mSUCCESS[0m in 51.83s]
[0m18:48:29.588032 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m18:48:29.590627 [error] [MainThread]: CANCEL query list_food ......................................................... [[31mCANCEL[0m]
[0m18:48:29.591640 [error] [MainThread]: CANCEL query list_feed_nghi_dev ................................................ [[31mCANCEL[0m]
[0m18:48:29.592640 [error] [MainThread]: CANCEL query model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v ........... [[31mCANCEL[0m]
[0m18:48:29.593640 [info ] [MainThread]: 
[0m18:48:29.593640 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m18:48:29.594639 [info ] [MainThread]: 
[0m18:48:29.595548 [error] [MainThread]: [33mDatabase Error in model food_mapping_costcenter_costcentergroup (models\food\marts\score_card\food_mapping_costcenter_costcentergroup.sql)[0m
[0m18:48:29.595548 [error] [MainThread]:   relation "nghi_dev.food_seed_scorecard_mapping_cost_center_ccgroup" does not exist
[0m18:48:29.596559 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_mapping_costcenter_costcentergroup.sql
[0m18:48:29.597559 [info ] [MainThread]: 
[0m18:48:29.598559 [error] [MainThread]: [33mDatabase Error in model food_mapping_hierarchies_costelement (models\food\marts\score_card\food_mapping_hierarchies_costelement.sql)[0m
[0m18:48:29.598559 [error] [MainThread]:   relation "nghi_dev.food_seed_scorecard_hierarchies_costelement" does not exist
[0m18:48:29.599559 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_mapping_hierarchies_costelement.sql
[0m18:48:29.600559 [info ] [MainThread]: 
[0m18:48:29.601200 [error] [MainThread]: [33mDatabase Error in model food_mapping_pl_plgroup (models\food\marts\score_card\food_mapping_pl_plgroup.sql)[0m
[0m18:48:29.601200 [error] [MainThread]:   relation "nghi_dev.food_seed_scorecard_mapping_pl_and_plgroup" does not exist
[0m18:48:29.602217 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_mapping_pl_plgroup.sql
[0m18:48:29.603216 [info ] [MainThread]: 
[0m18:48:29.604791 [error] [MainThread]: [33mDatabase Error in model food_scorecard_kpi_budget (models\food\marts\score_card\food_scorecard_kpi_budget.sql)[0m
[0m18:48:29.605290 [error] [MainThread]:   relation "nghi_dev.food_seed_scorecard_budget_2023" does not exist
[0m18:48:29.606325 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_scorecard_kpi_budget.sql
[0m18:48:29.607328 [info ] [MainThread]: 
[0m18:48:29.610327 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
[0m18:48:29.612904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:29.612904 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m18:48:29.613911 [debug] [MainThread]: Connection 'list_feed_nghi_dev' was properly closed.
[0m18:48:29.613911 [debug] [MainThread]: Connection 'model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v' was properly closed.
[0m18:48:29.613911 [info ] [MainThread]: 
[0m18:48:29.614910 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 1 minutes and 2.31 seconds (62.31s).
[0m18:48:29.615912 [error] [MainThread]: Encountered an error:

[0m18:48:29.623570 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 250, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\main.py", line 565, in run
    results = task.run()
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\runnable.py", line 404, in execute_with_hooks
    res = self.execute_nodes()
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\runnable.py", line 350, in execute_nodes
    self.run_queue(pool)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\runnable.py", line 258, in run_queue
    node = self.job_queue.get()
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\graph\queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\queue.py", line 171, in get
    self.not_empty.wait()
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\threading.py", line 312, in wait
    waiter.acquire()
KeyboardInterrupt

[0m18:48:29.629855 [debug] [MainThread]: Command `dbt run` failed at 18:48:29.628849 after 65.83 seconds
[0m18:48:29.629964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F792B8E5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F795BC29D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F794F36C10>]}
[0m18:48:29.629964 [debug] [MainThread]: Flushing usage events
[0m18:48:52.082756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E7E4AEBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E00403700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E00403670>]}


============================== 18:48:52.096583 | 1649e97c-9f49-4e9c-8124-e87339c776bb ==============================
[0m18:48:52.096583 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:48:52.097576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:48:52.256019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E003F3B50>]}
[0m18:48:52.268173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E7E720B20>]}
[0m18:48:52.308075 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:48:52.619825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:52.621284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:52.638780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0124FF40>]}
[0m18:48:52.677660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E00C80310>]}
[0m18:48:52.678655 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m18:48:52.679581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E00C80400>]}
[0m18:48:52.684330 [info ] [MainThread]: 
[0m18:48:52.686300 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:48:52.689397 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m18:48:52.745431 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m18:48:52.746486 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m18:48:52.746486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:52.747475 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:48:52.748512 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:48:53.315428 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:48:53.317426 [debug] [ThreadPool]: On list_food: Close
[0m18:48:53.329949 [debug] [ThreadPool]: Acquiring new redshift connection 'list_group_nghi_dev'
[0m18:48:53.337948 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m18:48:53.338452 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m18:48:53.338977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:53.338977 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:48:53.338977 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:48:53.631133 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:53.632139 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m18:48:53.633138 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:48:53.721005 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:53.725220 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m18:48:53.796741 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m18:48:53.798735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_group_nghi_dev, now list_farm_nghi_dev)
[0m18:48:53.803504 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m18:48:53.807014 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m18:48:53.807014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:53.808086 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:48:53.808086 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:48:54.088068 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:54.089126 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m18:48:54.089126 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:48:54.175045 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:54.178034 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m18:48:54.251889 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m18:48:54.254768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_feed_nghi_dev)
[0m18:48:54.268996 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m18:48:54.270135 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m18:48:54.270513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:54.270513 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:48:54.270513 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:48:54.525319 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:54.526303 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m18:48:54.527302 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:48:54.601486 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:54.605625 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m18:48:54.668449 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m18:48:54.671890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_feed_nghi_dev, now list_tech_nghi_dev)
[0m18:48:54.683986 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m18:48:54.684986 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m18:48:54.684986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:54.685986 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:48:54.685986 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:48:54.966378 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:54.967462 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m18:48:54.968448 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:48:55.053706 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:55.056805 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m18:48:55.129746 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m18:48:55.132713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_food_nghi_dev)
[0m18:48:55.138473 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m18:48:55.138473 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m18:48:55.138473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:55.139849 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:48:55.139849 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:48:55.421280 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:55.421280 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m18:48:55.421280 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:48:55.504451 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:55.506450 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m18:48:55.577191 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m18:48:55.601483 [debug] [MainThread]: Using redshift connection "master"
[0m18:48:55.601483 [debug] [MainThread]: On master: BEGIN
[0m18:48:55.601483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:55.602484 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:48:55.602884 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:48:55.877714 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:55.878643 [debug] [MainThread]: Using redshift connection "master"
[0m18:48:55.878643 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:56.010850 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:56.014849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E7E6FEBE0>]}
[0m18:48:56.015849 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:56.094005 [debug] [MainThread]: Using redshift connection "master"
[0m18:48:56.094986 [debug] [MainThread]: On master: BEGIN
[0m18:48:56.126512 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:56.126512 [debug] [MainThread]: On master: COMMIT
[0m18:48:56.126512 [debug] [MainThread]: Using redshift connection "master"
[0m18:48:56.127513 [debug] [MainThread]: On master: COMMIT
[0m18:48:56.186707 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:56.186707 [debug] [MainThread]: On master: Close
[0m18:48:56.187717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:48:56.188724 [info ] [MainThread]: 
[0m18:48:56.202300 [debug] [Thread-1  ]: Began running node seed.sales_group.food_seed_scorecard_budget_2023
[0m18:48:56.202814 [info ] [Thread-1  ]: 1 of 7 START seed file nghi_dev.food_seed_scorecard_budget_2023 ................ [RUN]
[0m18:48:56.205178 [debug] [Thread-1  ]: Acquiring new redshift connection 'seed.sales_group.food_seed_scorecard_budget_2023'
[0m18:48:56.207177 [debug] [Thread-1  ]: Began compiling node seed.sales_group.food_seed_scorecard_budget_2023
[0m18:48:56.207177 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_budget_2023 (compile): 18:48:56.207177 => 18:48:56.207177
[0m18:48:56.208251 [debug] [Thread-1  ]: Began executing node seed.sales_group.food_seed_scorecard_budget_2023
[0m18:48:56.244275 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_budget_2023"
[0m18:48:56.244275 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_budget_2023: BEGIN
[0m18:48:56.244275 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:48:56.245650 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:48:56.245650 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:48:56.511556 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:56.512624 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_budget_2023"
[0m18:48:56.513632 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_budget_2023: create table "food"."nghi_dev"."food_seed_scorecard_budget_2023" ("value_type" varchar(2),"kpi_code" varchar(3),"kpi_name" varchar(9),"month" varchar(7),"cat_name" varchar(13),"cat_code" varchar(2),"subcat1_code" varchar(2),"subcat1_name" varchar(14),"amount" integer)
[0m18:48:56.616439 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:56.777561 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_budget_2023"
[0m18:48:56.778562 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_budget_2023: insert into "food"."nghi_dev"."food_seed_scorecard_budget_2023" ("value_type", "kpi_code", "kpi_name", "month", "cat_name", "cat_code", "subcat1_code", "subcat1_name", "amount") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m18:48:56.912064 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:56.922114 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.sales_group.food_seed_scorecard_budget_2023"
[0m18:48:56.943743 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_budget_2023: COMMIT
[0m18:48:56.944749 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_budget_2023"
[0m18:48:56.944749 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_budget_2023: COMMIT
[0m18:48:57.696597 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:48:57.697597 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_budget_2023 (execute): 18:48:56.208251 => 18:48:57.697597
[0m18:48:57.697597 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_budget_2023: Close
[0m18:48:57.698604 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E013ACF10>]}
[0m18:48:57.698604 [info ] [Thread-1  ]: 1 of 7 OK loaded seed file nghi_dev.food_seed_scorecard_budget_2023 ............ [[32mINSERT 108[0m in 1.49s]
[0m18:48:57.700776 [debug] [Thread-1  ]: Finished running node seed.sales_group.food_seed_scorecard_budget_2023
[0m18:48:57.700776 [debug] [Thread-1  ]: Began running node seed.sales_group.food_seed_scorecard_hierarchies_costelement
[0m18:48:57.700776 [info ] [Thread-1  ]: 2 of 7 START seed file nghi_dev.food_seed_scorecard_hierarchies_costelement .... [RUN]
[0m18:48:57.702644 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.sales_group.food_seed_scorecard_budget_2023, now seed.sales_group.food_seed_scorecard_hierarchies_costelement)
[0m18:48:57.703228 [debug] [Thread-1  ]: Began compiling node seed.sales_group.food_seed_scorecard_hierarchies_costelement
[0m18:48:57.703228 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_hierarchies_costelement (compile): 18:48:57.703228 => 18:48:57.703228
[0m18:48:57.703228 [debug] [Thread-1  ]: Began executing node seed.sales_group.food_seed_scorecard_hierarchies_costelement
[0m18:48:57.708330 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_hierarchies_costelement"
[0m18:48:57.708330 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_hierarchies_costelement: BEGIN
[0m18:48:57.709320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:57.709320 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:48:57.709320 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:48:58.182367 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:58.183366 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_hierarchies_costelement"
[0m18:48:58.184362 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_hierarchies_costelement: create table "food"."nghi_dev"."food_seed_scorecard_hierarchies_costelement" ("hier_cost_element_code" varchar(10),"hier_cost_element_name" varchar(100),"cost_element" varchar(20))
[0m18:48:58.341084 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:58.378104 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_hierarchies_costelement"
[0m18:48:58.378104 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_hierarchies_costelement: insert into "food"."nghi_dev"."food_seed_scorecard_hierarchies_costelement" ("hier_cost_element_code", "hier_cost_element_name", "cost_element") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m18:48:58.472728 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:58.474814 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.sales_group.food_seed_scorecard_hierarchies_costelement"
[0m18:48:58.480808 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_hierarchies_costelement: COMMIT
[0m18:48:58.480808 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_hierarchies_costelement"
[0m18:48:58.481799 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_hierarchies_costelement: COMMIT
[0m18:48:59.008934 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:48:59.011928 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_hierarchies_costelement (execute): 18:48:57.703228 => 18:48:59.010925
[0m18:48:59.012927 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_hierarchies_costelement: Close
[0m18:48:59.013934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E008FEEE0>]}
[0m18:48:59.014930 [info ] [Thread-1  ]: 2 of 7 OK loaded seed file nghi_dev.food_seed_scorecard_hierarchies_costelement  [[32mINSERT 74[0m in 1.31s]
[0m18:48:59.017439 [debug] [Thread-1  ]: Finished running node seed.sales_group.food_seed_scorecard_hierarchies_costelement
[0m18:48:59.018478 [debug] [Thread-1  ]: Began running node seed.sales_group.food_seed_scorecard_mapping_categories
[0m18:48:59.018715 [info ] [Thread-1  ]: 3 of 7 START seed file nghi_dev.food_seed_scorecard_mapping_categories ......... [RUN]
[0m18:48:59.020043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.sales_group.food_seed_scorecard_hierarchies_costelement, now seed.sales_group.food_seed_scorecard_mapping_categories)
[0m18:48:59.020043 [debug] [Thread-1  ]: Began compiling node seed.sales_group.food_seed_scorecard_mapping_categories
[0m18:48:59.021115 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_mapping_categories (compile): 18:48:59.021115 => 18:48:59.021115
[0m18:48:59.021115 [debug] [Thread-1  ]: Began executing node seed.sales_group.food_seed_scorecard_mapping_categories
[0m18:48:59.033993 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_categories"
[0m18:48:59.033993 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_categories: BEGIN
[0m18:48:59.034992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:59.034992 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:48:59.036057 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:48:59.335953 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:48:59.335953 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_categories"
[0m18:48:59.335953 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_categories: truncate table "food"."nghi_dev"."food_seed_scorecard_mapping_categories"
[0m18:49:00.438521 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:00.448701 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_categories"
[0m18:49:00.448701 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_categories: insert into "food"."nghi_dev"."food_seed_scorecard_mapping_categories" ("cat_code", "cat_name", "ph4_code") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)...
[0m18:49:01.486255 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:01.489224 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.sales_group.food_seed_scorecard_mapping_categories"
[0m18:49:01.493218 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_categories: COMMIT
[0m18:49:01.494553 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_categories"
[0m18:49:01.494553 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_categories: COMMIT
[0m18:49:01.553411 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:01.555460 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_mapping_categories (execute): 18:48:59.022116 => 18:49:01.554453
[0m18:49:01.556076 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_categories: Close
[0m18:49:01.557274 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E014DAF40>]}
[0m18:49:01.558115 [info ] [Thread-1  ]: 3 of 7 OK loaded seed file nghi_dev.food_seed_scorecard_mapping_categories ..... [[32mINSERT 8[0m in 2.54s]
[0m18:49:01.559806 [debug] [Thread-1  ]: Finished running node seed.sales_group.food_seed_scorecard_mapping_categories
[0m18:49:01.559806 [debug] [Thread-1  ]: Began running node seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup
[0m18:49:01.560806 [info ] [Thread-1  ]: 4 of 7 START seed file nghi_dev.food_seed_scorecard_mapping_cost_center_ccgroup  [RUN]
[0m18:49:01.561807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.sales_group.food_seed_scorecard_mapping_categories, now seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup)
[0m18:49:01.561807 [debug] [Thread-1  ]: Began compiling node seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup
[0m18:49:01.561807 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup (compile): 18:49:01.561807 => 18:49:01.561807
[0m18:49:01.562808 [debug] [Thread-1  ]: Began executing node seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup
[0m18:49:01.570616 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup"
[0m18:49:01.571116 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup: BEGIN
[0m18:49:01.571808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:01.571985 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:01.571985 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:01.856757 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:01.857789 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup"
[0m18:49:01.858788 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup: create table "food"."nghi_dev"."food_seed_scorecard_mapping_cost_center_ccgroup" ("cost_center" varchar(20),"cost_center_name" varchar(27),"Person Responsible" varchar(5),"cc_group" varchar(10),"cc_group_name" varchar(11))
[0m18:49:01.981906 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:02.199613 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup"
[0m18:49:02.200834 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup: insert into "food"."nghi_dev"."food_seed_scorecard_mapping_cost_center_ccgroup" ("cost_center", "cost_center_name", "Person Responsible", "cc_group", "cc_group_name") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%...
[0m18:49:02.356114 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:02.359316 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup"
[0m18:49:02.364317 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup: COMMIT
[0m18:49:02.364317 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup"
[0m18:49:02.365318 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup: COMMIT
[0m18:49:02.881720 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:02.882693 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup (execute): 18:49:01.562808 => 18:49:02.882693
[0m18:49:02.884556 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup: Close
[0m18:49:02.886587 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E008F7C40>]}
[0m18:49:02.887634 [info ] [Thread-1  ]: 4 of 7 OK loaded seed file nghi_dev.food_seed_scorecard_mapping_cost_center_ccgroup  [[32mINSERT 280[0m in 1.33s]
[0m18:49:02.889957 [debug] [Thread-1  ]: Finished running node seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup
[0m18:49:02.890954 [debug] [Thread-1  ]: Began running node seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup
[0m18:49:02.890954 [info ] [Thread-1  ]: 5 of 7 START seed file nghi_dev.food_seed_scorecard_mapping_pl_and_plgroup ..... [RUN]
[0m18:49:02.892953 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.sales_group.food_seed_scorecard_mapping_cost_center_ccgroup, now seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup)
[0m18:49:02.892953 [debug] [Thread-1  ]: Began compiling node seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup
[0m18:49:02.894023 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup (compile): 18:49:02.892953 => 18:49:02.892953
[0m18:49:02.894023 [debug] [Thread-1  ]: Began executing node seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup
[0m18:49:02.900955 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup"
[0m18:49:02.900955 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup: BEGIN
[0m18:49:02.902025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:02.902025 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:02.903021 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:03.184874 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:03.186983 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup"
[0m18:49:03.187830 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup: create table "food"."nghi_dev"."food_seed_scorecard_mapping_pl_and_plgroup" ("gl_account" varchar(10),"name_gl_account" varchar(26),"pl_code" varchar(10),"pl_name" varchar(31),"pl_group_code" varchar(10),"pl_group_name" varchar(18))
[0m18:49:03.320922 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:03.449434 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup"
[0m18:49:03.450360 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup: insert into "food"."nghi_dev"."food_seed_scorecard_mapping_pl_and_plgroup" ("gl_account", "name_gl_account", "pl_code", "pl_name", "pl_group_code", "pl_group_name") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m18:49:03.577427 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:03.579461 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup"
[0m18:49:03.586481 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup: COMMIT
[0m18:49:03.587544 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup"
[0m18:49:03.587544 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup: COMMIT
[0m18:49:04.088033 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:04.090037 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup (execute): 18:49:02.894023 => 18:49:04.090037
[0m18:49:04.091044 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup: Close
[0m18:49:04.092037 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E014FE2B0>]}
[0m18:49:04.092037 [info ] [Thread-1  ]: 5 of 7 OK loaded seed file nghi_dev.food_seed_scorecard_mapping_pl_and_plgroup . [[32mINSERT 143[0m in 1.20s]
[0m18:49:04.094036 [debug] [Thread-1  ]: Finished running node seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup
[0m18:49:04.094036 [debug] [Thread-1  ]: Began running node seed.sales_group.food_seed_scorecard_mapping_sales_groups
[0m18:49:04.094960 [info ] [Thread-1  ]: 6 of 7 START seed file nghi_dev.food_seed_scorecard_mapping_sales_groups ....... [RUN]
[0m18:49:04.095960 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.sales_group.food_seed_scorecard_mapping_pl_and_plgroup, now seed.sales_group.food_seed_scorecard_mapping_sales_groups)
[0m18:49:04.095960 [debug] [Thread-1  ]: Began compiling node seed.sales_group.food_seed_scorecard_mapping_sales_groups
[0m18:49:04.096999 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_mapping_sales_groups (compile): 18:49:04.095960 => 18:49:04.095960
[0m18:49:04.096999 [debug] [Thread-1  ]: Began executing node seed.sales_group.food_seed_scorecard_mapping_sales_groups
[0m18:49:04.105762 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_sales_groups"
[0m18:49:04.106760 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_sales_groups: BEGIN
[0m18:49:04.106760 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:04.106760 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:04.107762 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:04.370542 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:04.371612 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_sales_groups"
[0m18:49:04.371612 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_sales_groups: truncate table "food"."nghi_dev"."food_seed_scorecard_mapping_sales_groups"
[0m18:49:05.277616 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:05.294571 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_sales_groups"
[0m18:49:05.294571 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_sales_groups: insert into "food"."nghi_dev"."food_seed_scorecard_mapping_sales_groups" ("sales_group_code", "sales_group_name", "channel_code", "channel_name") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m18:49:06.270652 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:06.273242 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.sales_group.food_seed_scorecard_mapping_sales_groups"
[0m18:49:06.278064 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_sales_groups: COMMIT
[0m18:49:06.279060 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_sales_groups"
[0m18:49:06.279060 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_sales_groups: COMMIT
[0m18:49:06.328944 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:06.330940 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_mapping_sales_groups (execute): 18:49:04.096999 => 18:49:06.330940
[0m18:49:06.331940 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_sales_groups: Close
[0m18:49:06.334301 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0153D2E0>]}
[0m18:49:06.334301 [info ] [Thread-1  ]: 6 of 7 OK loaded seed file nghi_dev.food_seed_scorecard_mapping_sales_groups ... [[32mINSERT 21[0m in 2.24s]
[0m18:49:06.336336 [debug] [Thread-1  ]: Finished running node seed.sales_group.food_seed_scorecard_mapping_sales_groups
[0m18:49:06.337396 [debug] [Thread-1  ]: Began running node seed.sales_group.food_seed_scorecard_mapping_subcategories
[0m18:49:06.337396 [info ] [Thread-1  ]: 7 of 7 START seed file nghi_dev.food_seed_scorecard_mapping_subcategories ...... [RUN]
[0m18:49:06.339317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.sales_group.food_seed_scorecard_mapping_sales_groups, now seed.sales_group.food_seed_scorecard_mapping_subcategories)
[0m18:49:06.339317 [debug] [Thread-1  ]: Began compiling node seed.sales_group.food_seed_scorecard_mapping_subcategories
[0m18:49:06.340316 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_mapping_subcategories (compile): 18:49:06.339317 => 18:49:06.339317
[0m18:49:06.340316 [debug] [Thread-1  ]: Began executing node seed.sales_group.food_seed_scorecard_mapping_subcategories
[0m18:49:06.347315 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_subcategories"
[0m18:49:06.348315 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_subcategories: BEGIN
[0m18:49:06.348315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:06.348315 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:06.349362 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:06.677930 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:06.679000 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_subcategories"
[0m18:49:06.679982 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_subcategories: truncate table "food"."nghi_dev"."food_seed_scorecard_mapping_subcategories"
[0m18:49:07.658764 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:07.694793 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_subcategories"
[0m18:49:07.694793 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_subcategories: insert into "food"."nghi_dev"."food_seed_scorecard_mapping_subcategories" ("subcat1_code", "subcat1_name", "subcat2_code", "subcat2_name", "ph5_code") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,...
[0m18:49:08.727778 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:08.729801 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.sales_group.food_seed_scorecard_mapping_subcategories"
[0m18:49:08.735163 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_subcategories: COMMIT
[0m18:49:08.735163 [debug] [Thread-1  ]: Using redshift connection "seed.sales_group.food_seed_scorecard_mapping_subcategories"
[0m18:49:08.736167 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_subcategories: COMMIT
[0m18:49:08.845470 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:08.847461 [debug] [Thread-1  ]: Timing info for seed.sales_group.food_seed_scorecard_mapping_subcategories (execute): 18:49:06.340316 => 18:49:08.846462
[0m18:49:08.848964 [debug] [Thread-1  ]: On seed.sales_group.food_seed_scorecard_mapping_subcategories: Close
[0m18:49:08.851111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1649e97c-9f49-4e9c-8124-e87339c776bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0155AD90>]}
[0m18:49:08.852183 [info ] [Thread-1  ]: 7 of 7 OK loaded seed file nghi_dev.food_seed_scorecard_mapping_subcategories .. [[32mINSERT 46[0m in 2.51s]
[0m18:49:08.853113 [debug] [Thread-1  ]: Finished running node seed.sales_group.food_seed_scorecard_mapping_subcategories
[0m18:49:08.856112 [debug] [MainThread]: Using redshift connection "master"
[0m18:49:08.856112 [debug] [MainThread]: On master: BEGIN
[0m18:49:08.856112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:49:08.857140 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:08.857140 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:09.297884 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:09.298611 [debug] [MainThread]: On master: COMMIT
[0m18:49:09.299856 [debug] [MainThread]: Using redshift connection "master"
[0m18:49:09.299856 [debug] [MainThread]: On master: COMMIT
[0m18:49:09.412303 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:09.413259 [debug] [MainThread]: On master: Close
[0m18:49:09.415259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:09.416259 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m18:49:09.416259 [debug] [MainThread]: Connection 'list_food_nghi_dev' was properly closed.
[0m18:49:09.417258 [debug] [MainThread]: Connection 'seed.sales_group.food_seed_scorecard_mapping_subcategories' was properly closed.
[0m18:49:09.417258 [info ] [MainThread]: 
[0m18:49:09.419260 [info ] [MainThread]: Finished running 7 seeds in 0 hours 0 minutes and 16.73 seconds (16.73s).
[0m18:49:09.422258 [debug] [MainThread]: Command end result
[0m18:49:09.525781 [info ] [MainThread]: 
[0m18:49:09.526781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:09.527781 [info ] [MainThread]: 
[0m18:49:09.527781 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:49:09.528802 [debug] [MainThread]: Command `dbt seed` succeeded at 18:49:09.528802 after 17.46 seconds
[0m18:49:09.529860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E7E4AEBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E01266CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E01266A30>]}
[0m18:49:09.529860 [debug] [MainThread]: Flushing usage events
[0m18:49:19.023863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84A38BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84C2E36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84C2E36A0>]}


============================== 18:49:19.027000 | c88b7db6-441b-4ce2-97cc-f791e4c23507 ==============================
[0m18:49:19.027000 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:49:19.028359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:49:19.186238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84C52B520>]}
[0m18:49:19.198742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84C5F2160>]}
[0m18:49:19.239756 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:49:19.518874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:49:19.519874 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:49:19.536469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84C671F40>]}
[0m18:49:19.574583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84C853310>]}
[0m18:49:19.575583 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m18:49:19.576583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84C853400>]}
[0m18:49:19.581324 [info ] [MainThread]: 
[0m18:49:19.583289 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:49:19.592755 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m18:49:19.642992 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m18:49:19.642992 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m18:49:19.642992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:19.644837 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:19.645159 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:20.172250 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:20.175628 [debug] [ThreadPool]: On list_food: Close
[0m18:49:20.191345 [debug] [ThreadPool]: Acquiring new redshift connection 'list_group_nghi_dev'
[0m18:49:20.198363 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m18:49:20.199365 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m18:49:20.199365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:20.199365 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:20.200314 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:20.460272 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:20.461584 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m18:49:20.462689 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:49:20.548587 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:20.552597 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m18:49:20.613569 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m18:49:20.614648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_group_nghi_dev, now list_farm_nghi_dev)
[0m18:49:20.619641 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m18:49:20.619641 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m18:49:20.623649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:20.623649 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:20.623649 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:20.918685 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:20.919686 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m18:49:20.919686 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:49:21.003337 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:21.006346 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m18:49:21.077535 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m18:49:21.079648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_food_nghi_dev)
[0m18:49:21.096154 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m18:49:21.096154 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m18:49:21.096154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:21.097145 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:21.097145 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:21.388016 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:21.389046 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m18:49:21.390113 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:49:21.475468 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:21.480076 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m18:49:21.551800 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m18:49:21.554872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_food_nghi_dev, now list_feed_nghi_dev)
[0m18:49:21.562193 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m18:49:21.563192 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m18:49:21.563192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:21.564199 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:21.564199 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:21.814183 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:21.815232 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m18:49:21.816230 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:49:21.891526 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:21.892528 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m18:49:21.953368 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m18:49:21.956283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_feed_nghi_dev, now list_tech_nghi_dev)
[0m18:49:21.963278 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m18:49:21.963278 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m18:49:21.963278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:21.964279 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:21.964279 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:22.237241 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:22.238241 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m18:49:22.238241 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m18:49:22.322098 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:22.325112 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m18:49:22.396788 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m18:49:22.428243 [debug] [MainThread]: Using redshift connection "master"
[0m18:49:22.428744 [debug] [MainThread]: On master: BEGIN
[0m18:49:22.428744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:49:22.429245 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:22.429245 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:22.676600 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:22.677405 [debug] [MainThread]: Using redshift connection "master"
[0m18:49:22.678441 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:49:22.798032 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:22.802101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84927DDC0>]}
[0m18:49:22.803103 [debug] [MainThread]: On master: ROLLBACK
[0m18:49:22.872363 [debug] [MainThread]: Using redshift connection "master"
[0m18:49:22.873715 [debug] [MainThread]: On master: BEGIN
[0m18:49:22.899375 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:22.899375 [debug] [MainThread]: On master: COMMIT
[0m18:49:22.900375 [debug] [MainThread]: Using redshift connection "master"
[0m18:49:22.900375 [debug] [MainThread]: On master: COMMIT
[0m18:49:22.952069 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:22.953327 [debug] [MainThread]: On master: Close
[0m18:49:22.955036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:49:22.956955 [info ] [MainThread]: 
[0m18:49:22.975593 [debug] [Thread-1  ]: Began running node model.sales_group.food_mapping_costcenter_costcentergroup
[0m18:49:22.977061 [info ] [Thread-1  ]: 1 of 10 START sql table model nghi_dev.food_mapping_costcenter_costcentergroup . [RUN]
[0m18:49:22.978772 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_mapping_costcenter_costcentergroup'
[0m18:49:22.978772 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_mapping_costcenter_costcentergroup
[0m18:49:22.984484 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:49:22.986484 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_costcenter_costcentergroup (compile): 18:49:22.979772 => 18:49:22.985484
[0m18:49:22.986484 [debug] [Thread-1  ]: Began executing node model.sales_group.food_mapping_costcenter_costcentergroup
[0m18:49:23.035870 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:49:23.037799 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:49:23.037799 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: BEGIN
[0m18:49:23.038872 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:49:23.038872 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:23.039873 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:23.342972 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:23.344928 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:49:23.345955 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: create  table
    "food"."nghi_dev"."food_mapping_costcenter_costcentergroup__dbt_tmp"
    
    
    
  as (
    select 
cost_center as costcenter_code, 
cost_center_name as costcenter_name, 
cc_group as costcenter_group_code, 
cc_group_name as  costcenter_group_name
from "food"."nghi_dev"."food_seed_scorecard_mapping_cost_center_ccgroup"
  );
[0m18:49:23.448342 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:23.457341 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:49:23.457341 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: alter table "food"."nghi_dev"."food_mapping_costcenter_costcentergroup__dbt_tmp" rename to "food_mapping_costcenter_costcentergroup"
[0m18:49:23.610744 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:23.629950 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: COMMIT
[0m18:49:23.629950 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:49:23.630999 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: COMMIT
[0m18:49:24.397947 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:24.400019 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:49:24.401018 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: BEGIN
[0m18:49:24.459792 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:24.468968 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:49:24.469968 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: drop table if exists "food"."nghi_dev"."food_mapping_costcenter_costcentergroup__dbt_backup" cascade
[0m18:49:24.528965 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:24.532040 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: COMMIT
[0m18:49:24.533038 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:49:24.533038 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: COMMIT
[0m18:49:24.572051 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:24.573076 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m18:49:24.574067 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: BEGIN
[0m18:49:24.604613 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:24.605675 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_costcenter_costcentergroup (execute): 18:49:22.986484 => 18:49:24.605675
[0m18:49:24.607110 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: ROLLBACK
[0m18:49:24.666071 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: Close
[0m18:49:24.667076 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D18DDC0>]}
[0m18:49:24.668000 [info ] [Thread-1  ]: 1 of 10 OK created sql table model nghi_dev.food_mapping_costcenter_costcentergroup  [[32mSUCCESS[0m in 1.69s]
[0m18:49:24.669726 [debug] [Thread-1  ]: Finished running node model.sales_group.food_mapping_costcenter_costcentergroup
[0m18:49:24.669726 [debug] [Thread-1  ]: Began running node model.sales_group.food_mapping_hierarchies_costelement
[0m18:49:24.670762 [info ] [Thread-1  ]: 2 of 10 START sql table model nghi_dev.food_mapping_hierarchies_costelement .... [RUN]
[0m18:49:24.671733 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_mapping_costcenter_costcentergroup, now model.sales_group.food_mapping_hierarchies_costelement)
[0m18:49:24.671733 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_mapping_hierarchies_costelement
[0m18:49:24.674735 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:49:24.676730 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_hierarchies_costelement (compile): 18:49:24.671733 => 18:49:24.676730
[0m18:49:24.678031 [debug] [Thread-1  ]: Began executing node model.sales_group.food_mapping_hierarchies_costelement
[0m18:49:24.682030 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:49:24.684033 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:49:24.685031 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: BEGIN
[0m18:49:24.685203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:24.686233 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:24.686233 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:24.963249 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:24.964244 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:49:24.965320 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: create  table
    "food"."nghi_dev"."food_mapping_hierarchies_costelement__dbt_tmp"
    
    
    
  as (
    select
    hier_cost_element_code,
    hier_cost_element_name,
    case
        when cost_element is not null then right(cost_element, 10)
    end as cost_element_code
from "food"."nghi_dev"."food_seed_scorecard_hierarchies_costelement"
  );
[0m18:49:25.071265 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:25.076505 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:49:25.076952 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: alter table "food"."nghi_dev"."food_mapping_hierarchies_costelement__dbt_tmp" rename to "food_mapping_hierarchies_costelement"
[0m18:49:25.227769 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:25.230003 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: COMMIT
[0m18:49:25.230435 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:49:25.231544 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: COMMIT
[0m18:49:25.831717 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:25.832714 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:49:25.833751 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: BEGIN
[0m18:49:25.894228 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:25.900605 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:49:25.901811 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: drop table if exists "food"."nghi_dev"."food_mapping_hierarchies_costelement__dbt_backup" cascade
[0m18:49:25.963288 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:25.966420 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: COMMIT
[0m18:49:25.967418 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:49:25.967418 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: COMMIT
[0m18:49:26.006561 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:26.007561 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m18:49:26.007561 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: BEGIN
[0m18:49:26.038022 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:26.039617 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_hierarchies_costelement (execute): 18:49:24.678031 => 18:49:26.039617
[0m18:49:26.040624 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: ROLLBACK
[0m18:49:26.099822 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: Close
[0m18:49:26.100870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84C7D51F0>]}
[0m18:49:26.100870 [info ] [Thread-1  ]: 2 of 10 OK created sql table model nghi_dev.food_mapping_hierarchies_costelement  [[32mSUCCESS[0m in 1.43s]
[0m18:49:26.103240 [debug] [Thread-1  ]: Finished running node model.sales_group.food_mapping_hierarchies_costelement
[0m18:49:26.103240 [debug] [Thread-1  ]: Began running node model.sales_group.food_mapping_pl_plgroup
[0m18:49:26.103240 [info ] [Thread-1  ]: 3 of 10 START sql table model nghi_dev.food_mapping_pl_plgroup ................. [RUN]
[0m18:49:26.104326 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_mapping_hierarchies_costelement, now model.sales_group.food_mapping_pl_plgroup)
[0m18:49:26.105241 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_mapping_pl_plgroup
[0m18:49:26.107241 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_mapping_pl_plgroup"
[0m18:49:26.109571 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_pl_plgroup (compile): 18:49:26.105241 => 18:49:26.109034
[0m18:49:26.109571 [debug] [Thread-1  ]: Began executing node model.sales_group.food_mapping_pl_plgroup
[0m18:49:26.114621 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_mapping_pl_plgroup"
[0m18:49:26.118271 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m18:49:26.118271 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: BEGIN
[0m18:49:26.119272 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:26.120273 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:26.120743 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:26.373871 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:26.374873 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m18:49:26.375839 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: create  table
    "food"."nghi_dev"."food_mapping_pl_plgroup__dbt_tmp"
    
    
    
  as (
    select 
'00' || gl_account as "G/L Account",
 name_gl_account, 
 pl_code, 
 pl_name, 
 pl_group_code, 
 pl_group_name
from "food"."nghi_dev"."food_seed_scorecard_mapping_pl_and_plgroup" pl
  );
[0m18:49:26.464524 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:26.468599 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m18:49:26.468599 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: alter table "food"."nghi_dev"."food_mapping_pl_plgroup__dbt_tmp" rename to "food_mapping_pl_plgroup"
[0m18:49:26.598924 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:26.601921 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: COMMIT
[0m18:49:26.603732 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m18:49:26.604408 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: COMMIT
[0m18:49:27.174432 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:27.176364 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m18:49:27.176364 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: BEGIN
[0m18:49:27.227050 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:27.234890 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m18:49:27.235935 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: drop table if exists "food"."nghi_dev"."food_mapping_pl_plgroup__dbt_backup" cascade
[0m18:49:27.285716 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:27.287708 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: COMMIT
[0m18:49:27.288709 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m18:49:27.289705 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: COMMIT
[0m18:49:27.322460 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:27.324512 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m18:49:27.325530 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: BEGIN
[0m18:49:27.359833 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:27.361905 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_pl_plgroup (execute): 18:49:26.109571 => 18:49:27.361905
[0m18:49:27.362903 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: ROLLBACK
[0m18:49:27.414858 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: Close
[0m18:49:27.418052 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D2645E0>]}
[0m18:49:27.419052 [info ] [Thread-1  ]: 3 of 10 OK created sql table model nghi_dev.food_mapping_pl_plgroup ............ [[32mSUCCESS[0m in 1.31s]
[0m18:49:27.422127 [debug] [Thread-1  ]: Finished running node model.sales_group.food_mapping_pl_plgroup
[0m18:49:27.422127 [debug] [Thread-1  ]: Began running node model.sales_group.food_scorecard_kpi_budget
[0m18:49:27.423121 [info ] [Thread-1  ]: 4 of 10 START sql table model nghi_dev.kpi_budget .............................. [RUN]
[0m18:49:27.425503 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_mapping_pl_plgroup, now model.sales_group.food_scorecard_kpi_budget)
[0m18:49:27.425503 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_scorecard_kpi_budget
[0m18:49:27.430065 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_scorecard_kpi_budget"
[0m18:49:27.432149 [debug] [Thread-1  ]: Timing info for model.sales_group.food_scorecard_kpi_budget (compile): 18:49:27.427060 => 18:49:27.432149
[0m18:49:27.432650 [debug] [Thread-1  ]: Began executing node model.sales_group.food_scorecard_kpi_budget
[0m18:49:27.438156 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_scorecard_kpi_budget"
[0m18:49:27.445034 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m18:49:27.446031 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: BEGIN
[0m18:49:27.447090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:27.448139 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:27.448139 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:27.736839 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:27.737830 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m18:49:27.738832 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: create  table
    "food"."nghi_dev"."kpi_budget__dbt_tmp"
    
    
    
  as (
    select
    cat_code,
    cat_name,
    subcat1_code as subcat_1_code,
    subcat1_name as subcat_1_name,
    '' as subcat_2_code,
    '' as subcat_2_name,
    '' as "G/L Account",
    '' as expense_group_code,
    '' as expense_group_name,
    '' as company_code,
    case 
    when month is not null 
    then left(month,4) || right(month,2) || '01'
    end as posting_date,
    '' as channel_code,
    '' as channel_name,
    '' as matnr,
    '20' as value_type,
    month as fiscyearper,
        kpi_code,
        kpi_name,
    '' as pl_code, 
    '' as pl_name, 
    '' as pl_group_code, 
    '' as pl_group_name,
    '' as costcenter_code,
    '' as costcenter_name,
    '' as costcenter_full_name,
    '' as costcenter_group_code,
    '' as costcenter_group_name,
    0 as revenue,
    0 as quantity,
    0 as "revenue(D/KG)",
    0 as inter_profit,
    0 as cogs,
    0 as "cogs(+)",
    0 as "gross contribution (3) =  (1) - (+)",
    0 as "manufacturing cost (4)",
    0 as "gross margin (5) = (3) - (4)",
    0 as "mkt & commercial costs (6)",
    0 as "administrative costs (7)",
    0 as "chi phí tài chính(8)",
    0 as "thu nhập tài chính(9)",
    amount::numeric(38,2) as budget
from "food"."nghi_dev"."food_seed_scorecard_budget_2023"
  );
[0m18:49:27.979815 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:27.987821 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m18:49:27.988829 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: alter table "food"."nghi_dev"."kpi_budget__dbt_tmp" rename to "kpi_budget"
[0m18:49:28.145557 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:28.149730 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: COMMIT
[0m18:49:28.150809 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m18:49:28.151803 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: COMMIT
[0m18:49:28.771966 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:28.773849 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m18:49:28.775470 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: BEGIN
[0m18:49:28.835278 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:28.838278 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m18:49:28.839278 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: drop table if exists "food"."nghi_dev"."kpi_budget__dbt_backup" cascade
[0m18:49:28.900482 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:28.902538 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: COMMIT
[0m18:49:28.903537 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m18:49:28.903537 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: COMMIT
[0m18:49:28.944613 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:28.944613 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m18:49:28.945612 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: BEGIN
[0m18:49:28.975100 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:28.977223 [debug] [Thread-1  ]: Timing info for model.sales_group.food_scorecard_kpi_budget (execute): 18:49:27.432650 => 18:49:28.977223
[0m18:49:28.977223 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: ROLLBACK
[0m18:49:29.039728 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: Close
[0m18:49:29.041962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D2645E0>]}
[0m18:49:29.041962 [info ] [Thread-1  ]: 4 of 10 OK created sql table model nghi_dev.kpi_budget ......................... [[32mSUCCESS[0m in 1.62s]
[0m18:49:29.044021 [debug] [Thread-1  ]: Finished running node model.sales_group.food_scorecard_kpi_budget
[0m18:49:29.044021 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m18:49:29.045019 [info ] [Thread-1  ]: 5 of 10 START sql view model nghi_dev.food_stg_sap_s4__fi_0fi_acdoca_10 ........ [RUN]
[0m18:49:29.046020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_scorecard_kpi_budget, now model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10)
[0m18:49:29.046020 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m18:49:29.058057 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:29.059647 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10 (compile): 18:49:29.046020 => 18:49:29.059647
[0m18:49:29.059647 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m18:49:29.084167 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:29.087167 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:29.088167 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: BEGIN
[0m18:49:29.088167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:29.089166 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:29.089166 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:29.378879 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:29.379872 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:29.380874 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: create view "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10__dbt_tmp" as (
    

with source as (

    

    select *
    from "food"."stg_sap_s4"."fi_0fi_acdoca_10"
    where
        
            budat >= to_char(now()::date - interval '1 day', 'YYYYMMDD')
        
        
        
),

deduped as (
    with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by rclnt, rldnr, rbukrs, gjahr, belnr, docln
                order by _created_at desc
            ) as rn
        from source as _inner
    )

    select
        distinct data.*
    from source as data
    
    natural join row_numbered
    where row_numbered.rn = 1
)

select * from deduped
  ) with no schema binding;
[0m18:49:29.505320 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:29.513025 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:29.514037 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: alter table "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10" rename to "food_stg_sap_s4__fi_0fi_acdoca_10__dbt_backup"
[0m18:49:29.603310 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:29.612852 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:29.612852 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: alter table "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10__dbt_tmp" rename to "food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:29.706232 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:29.716228 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m18:49:29.718329 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:29.718329 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m18:49:30.321306 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:49:30.322071 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:30.322621 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: BEGIN
[0m18:49:30.381533 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:30.386750 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:30.387750 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: drop view if exists "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10__dbt_backup" cascade
[0m18:49:30.448212 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:30.449214 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m18:49:30.450215 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:30.450215 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m18:49:30.882346 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:30.882346 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m18:49:30.883427 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: BEGIN
[0m18:49:30.911509 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:30.912779 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10 (execute): 18:49:29.060652 => 18:49:30.912779
[0m18:49:30.913860 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: ROLLBACK
[0m18:49:30.971526 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: Close
[0m18:49:30.973695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D2BEFD0>]}
[0m18:49:30.974968 [info ] [Thread-1  ]: 5 of 10 OK created sql view model nghi_dev.food_stg_sap_s4__fi_0fi_acdoca_10 ... [[32mSUCCESS[0m in 1.93s]
[0m18:49:30.976104 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m18:49:30.976104 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m18:49:30.977145 [info ] [Thread-1  ]: 6 of 10 START sql view model nghi_dev.food_stg_sap_s4__md_0costcenter_text ..... [RUN]
[0m18:49:30.978106 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10, now model.sales_group.food_stg_sap_s4__md_0costcenter_text)
[0m18:49:30.978106 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m18:49:30.981193 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:30.983195 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0costcenter_text (compile): 18:49:30.978106 => 18:49:30.983195
[0m18:49:30.983195 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m18:49:30.988258 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:30.992648 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:30.992648 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: BEGIN
[0m18:49:30.993649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:30.993649 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:30.994647 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:31.243053 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:31.243053 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:31.243053 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: create view "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text__dbt_tmp" as (
    -- TODO: add dedup mechanism, ex. truncate before loading, or use macro (get lastest
-- row), ...
with
    selected_fields as (
        select kostl as code, txtsh as short_name, txtmd as medium_name
        from "food"."stg_sap_s4"."md_0costcenter_text"
        where langu = 'E' and kokrs = '1000'
    ),

    deduped as (
        with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by code
                order by code asc
            ) as rn
        from selected_fields as _inner
    )

    select
        distinct data.*
    from selected_fields as data
    
    natural join row_numbered
    where row_numbered.rn = 1
    )
select *
from deduped
order by code
  ) with no schema binding;
[0m18:49:31.350038 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:31.353036 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:31.354036 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text" rename to "food_stg_sap_s4__md_0costcenter_text__dbt_backup"
[0m18:49:31.427382 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:31.431384 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:31.432383 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text__dbt_tmp" rename to "food_stg_sap_s4__md_0costcenter_text"
[0m18:49:31.504443 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:31.506372 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m18:49:31.507433 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:31.507433 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m18:49:32.000508 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:32.002587 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:32.003579 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: BEGIN
[0m18:49:32.053685 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:32.062147 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:32.062147 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: drop view if exists "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text__dbt_backup" cascade
[0m18:49:32.115505 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:32.117532 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m18:49:32.118531 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:32.119528 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m18:49:32.553229 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:32.555205 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m18:49:32.556342 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: BEGIN
[0m18:49:32.584271 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:32.587286 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0costcenter_text (execute): 18:49:30.984146 => 18:49:32.587286
[0m18:49:32.587872 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: ROLLBACK
[0m18:49:32.674088 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: Close
[0m18:49:32.676087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D18DDC0>]}
[0m18:49:32.677087 [info ] [Thread-1  ]: 6 of 10 OK created sql view model nghi_dev.food_stg_sap_s4__md_0costcenter_text  [[32mSUCCESS[0m in 1.70s]
[0m18:49:32.679086 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m18:49:32.680316 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m18:49:32.681522 [info ] [Thread-1  ]: 7 of 10 START sql view model nghi_dev.food_stg_sap_s4__md_0distr_chan_text ..... [RUN]
[0m18:49:32.683562 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__md_0costcenter_text, now model.sales_group.food_stg_sap_s4__md_0distr_chan_text)
[0m18:49:32.684597 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m18:49:32.689599 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:32.691608 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0distr_chan_text (compile): 18:49:32.684597 => 18:49:32.690531
[0m18:49:32.691608 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m18:49:32.696855 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:32.701877 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:32.702985 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: BEGIN
[0m18:49:32.703999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:32.704915 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:32.704915 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:32.991115 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:32.991115 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:32.992508 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: create view "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text__dbt_tmp" as (
    -- TODO: add dedup mechanism, ex. truncate before loading, or use macro (get lastest
-- row), ...
with
    selected_fields as (
        select vtweg as code, vtext as name
        from "food"."stg_sap_s4"."md_0distr_chan_text"
        where spras = 'E'
    ),

    deduped as (
        with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by code
                order by name asc
            ) as rn
        from selected_fields as _inner
    )

    select
        distinct data.*
    from selected_fields as data
    
    natural join row_numbered
    where row_numbered.rn = 1
    )
select *
from deduped
order by code
  ) with no schema binding;
[0m18:49:33.115513 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:33.125029 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:33.126029 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" rename to "food_stg_sap_s4__md_0distr_chan_text__dbt_backup"
[0m18:49:33.247709 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:33.256671 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:33.257170 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text__dbt_tmp" rename to "food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:33.348102 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:33.349536 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m18:49:33.349536 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:33.350534 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m18:49:33.778455 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:33.780467 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:33.781461 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: BEGIN
[0m18:49:33.841385 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:33.847503 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:33.848501 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: drop view if exists "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text__dbt_backup" cascade
[0m18:49:33.909565 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:33.912094 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m18:49:33.913102 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:33.914098 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m18:49:34.379401 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:34.381495 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m18:49:34.381495 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: BEGIN
[0m18:49:34.413180 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:34.416153 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0distr_chan_text (execute): 18:49:32.692521 => 18:49:34.415162
[0m18:49:34.417157 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: ROLLBACK
[0m18:49:34.480807 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: Close
[0m18:49:34.482723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D18DDC0>]}
[0m18:49:34.484944 [info ] [Thread-1  ]: 7 of 10 OK created sql view model nghi_dev.food_stg_sap_s4__md_0distr_chan_text  [[32mSUCCESS[0m in 1.80s]
[0m18:49:34.486979 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m18:49:34.487945 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m18:49:34.487945 [info ] [Thread-1  ]: 8 of 10 START sql table model nghi_dev.food_stg_sap_s4__tbl_fcml_ccs_r_all_v ... [RUN]
[0m18:49:34.489967 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__md_0distr_chan_text, now model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v)
[0m18:49:34.491022 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m18:49:34.496026 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:49:34.497944 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v (compile): 18:49:34.491022 => 18:49:34.497019
[0m18:49:34.497944 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m18:49:34.504108 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:49:34.513016 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:49:34.514025 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: BEGIN
[0m18:49:34.514025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:34.514025 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:49:34.515089 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:49:34.749080 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:49:34.750164 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:49:34.750164 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: create  table
    "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_tmp"
    
    
    
  as (
    

with
    source as (select * from "food"."stg_sap_s4"."tbl_fcml_ccs_r_all_v"),

    deduped as (
        with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by kalnr_mat, poper, bdatj, run_act, run_appl, categ, ptyp, psart, kalnr_pmat, bvalt, process, elesmhk, element, mlcct, curtp 
                order by kalnr_mat desc
            ) as rn
        from source as _inner
    )

    select
        distinct data.*
    from source as data
    
    natural join row_numbered
    where row_numbered.rn = 1
    )

select *
from deduped
  );
[0m18:50:23.795067 [debug] [Thread-1  ]: SQL status: SUCCESS in 49.0 seconds
[0m18:50:23.804174 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:50:23.804174 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: alter table "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v" rename to "food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_backup"
[0m18:50:23.929175 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:23.933173 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:50:23.933173 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: alter table "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_tmp" rename to "food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:50:24.006340 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:24.011414 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m18:50:24.012410 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:50:24.012410 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m18:50:24.571366 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:50:24.573329 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:50:24.574329 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: BEGIN
[0m18:50:24.629384 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:24.633378 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:50:24.633378 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: drop table if exists "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_backup" cascade
[0m18:50:24.688868 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:24.690883 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m18:50:24.691882 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:50:24.692887 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m18:50:25.201258 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:50:25.201258 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m18:50:25.202303 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: BEGIN
[0m18:50:25.229668 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:25.230717 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v (execute): 18:49:34.498943 => 18:50:25.230717
[0m18:50:25.230717 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: ROLLBACK
[0m18:50:25.280636 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: Close
[0m18:50:25.283599 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D264070>]}
[0m18:50:25.284600 [info ] [Thread-1  ]: 8 of 10 OK created sql table model nghi_dev.food_stg_sap_s4__tbl_fcml_ccs_r_all_v  [[32mSUCCESS[0m in 50.79s]
[0m18:50:25.286530 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m18:50:25.287581 [debug] [Thread-1  ]: Began running node model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue
[0m18:50:25.288600 [info ] [Thread-1  ]: 9 of 10 START sql view model nghi_dev.food_int_fi_0fi_acdoca_10__filtered_to_revenue  [RUN]
[0m18:50:25.290598 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v, now model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue)
[0m18:50:25.290807 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue
[0m18:50:25.298155 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:25.303082 [debug] [Thread-1  ]: Timing info for model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue (compile): 18:50:25.290807 => 18:50:25.303082
[0m18:50:25.304086 [debug] [Thread-1  ]: Began executing node model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue
[0m18:50:25.309148 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:25.442459 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:25.443455 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: BEGIN
[0m18:50:25.443455 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:25.443455 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:50:25.444455 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:50:25.793184 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:25.794182 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:25.797180 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: create view "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue__dbt_tmp" as (
    with
    _0fi_acdoca_10_filter as (
        select
            racct,
            ktopl,
            kokrs,
            rbukrs,
            rldnr,
            paph4_pa,
            paph5_pa,
            vkgrp_pa,
            matnr,
            budat,
            matnr_copa,
            vtweg,
            fiscyearper,
            rcntr,
            awtyp,
            hsl,
            quant1,
            osl,
            kalnr,
            qsprocess,
            kunnr,
            mlcateg,
            werks
        from "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10"
        where
            ktopl = 1000  -- chart of account 
            and kokrs = 1000
            and rldnr = '0L'  -- sob type
            and fiscyearper >= '2023001'

    ),
    mapping_cat_subcat as (
        select
            c.cat_code,
            c.cat_name,
            sc.subcat1_code,
            sc.subcat1_name,
            sc.subcat2_code,
            sc.subcat2_name,
            racct,
            ktopl,
            kokrs,
            rbukrs,
            rldnr,
            paph4_pa,
            paph5_pa,
            vkgrp_pa,
            matnr,
            matnr_copa,
            budat,
            vtweg,
            fiscyearper,
            rcntr,
            hsl,
            quant1,
            osl,
            awtyp,
            kunnr,
            kalnr,
            qsprocess,
            werks
        from _0fi_acdoca_10_filter
        left join
            "food"."nghi_dev"."food_seed_scorecard_mapping_categories" c
            on right(paph4_pa, 2) = c.ph4_code
        left join
            "food"."nghi_dev"."food_seed_scorecard_mapping_subcategories" sc
            on right(paph5_pa, 3) = sc.ph5_code
    ),

      mapping_cat_subcat_special_case as (
        select
            cat_code,
            cat_name,
            subcat1_code,
            subcat1_name,
            subcat2_code,
            subcat2_name,
            racct,
            ktopl,
            kokrs,
            rbukrs,
            rldnr,
            paph4_pa,
            paph5_pa,
            vkgrp_pa,
            matnr,
            matnr_copa,
            budat,
            vtweg,
            fiscyearper,
            rcntr,
            hsl,
            quant1,
            osl,
            awtyp,
            kunnr,
            kalnr,
            qsprocess,
            werks,
            case when matnr = '' then matnr_copa else matnr end as _material,

            case
                when
                    paph4_pa = ''
                    and
                        left(_material, 11) in (
                            '00000000002',
                            '00000000003',
                            '00000000004',
                            '00000000005',
                            '00000000009'
                        )
                    and rbukrs != '3100'
                then '98'

                 when
                    paph4_pa = ''
                    and _material in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                    and rbukrs = '3100'
                then '01'
                when
                    paph4_pa = ''
                    and (left(_material, 11) in (
                        '00000000002',
                        '00000000003',
                        '00000000004',
                        '00000000005',
                        '00000000009'
                    ))
                    and rbukrs = '3100'
                    and _material not in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                then '98'
                
                when
                    paph4_pa = ''
                    and racct in ('0051121201', '0051183101', '0064180015')
                then '99'

                when racct = '0063242002' and rbukrs = '3100'
                then '01'

                when racct = '0063242001' and rbukrs = '3100'
                then '98'

                else cat_code
            end as _cat_code,

            case
                when
                    paph5_pa = ''
                    and (
                        left(_material, 11) in (
                            '00000000002',
                            '00000000003',
                            '00000000004',
                            '00000000005',
                            '00000000009'
                        )
                    )
                    and rbukrs != '3100'
                then '98'
                 when
                    paph5_pa = ''
                    and _material in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                    and rbukrs = '3100'
                then '01'

                when
                    paph5_pa = ''
                    and (left(_material, 11) in (
                        '00000000002',
                        '00000000003',
                        '00000000004',
                        '00000000005',
                        '00000000009'
                    ))
                    and rbukrs = '3100'
                    and _material not in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                then '98'
                when
                    paph5_pa = ''
                    and racct in ('0051121201', '0051183101', '0064180015')
                then '99'

                 when
                    paph5_pa = ''
                    and _material in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                    and rbukrs = '3100'
                then '01'

                when
                    paph5_pa = ''
                    and (left(_material, 11) in (
                        '00000000002',
                        '00000000003',
                        '00000000004',
                        '00000000005',
                        '00000000009'
                    ))
                    and rbukrs = '3100'
                    and _material not in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                then '98'

                else subcat1_code
            end as _subcat_1_code,
            case
                when
                    paph5_pa = ''
                    and (left(_material, 11) in (
                        '00000000002',
                        '00000000003',
                        '00000000004',
                        '00000000005',
                        '00000000009'
                    ))
                    and rbukrs != '3100'
                then '98'
                when
                    paph5_pa = ''
                    and racct in ('0051121201', '0051183101', '0064180015')
                then '99'

                when
                    paph5_pa = ''
                    and _material in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                    and rbukrs = '3100'
                then '01'

                when
                    paph5_pa = ''
                    and (left(_material, 11) in (
                        '00000000002',
                        '00000000003',
                        '00000000004',
                        '00000000005',
                        '00000000009'
                    ))
                    and rbukrs = '3100'
                    and _material not in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                then '98'

                else subcat2_code
            end as _subcat_2_code

        from mapping_cat_subcat
    ),

    concatenate_cat_subcat as (
        select
            case 
            when _cat_code is null 
            then '99' 
            else _cat_code end as cat_code_n,

            case
                when cat_code_n = '99'
                then 'DT khác'
                when cat_code_n = '98'
                then 'Khác'
                else cat_name
            end as cat_name_n,

            case
                when _subcat_1_code is null 
                then '99' else _subcat_1_code
            end as subcat_1_code,

            case
                when subcat_1_code = '98'
                then 'Khác'
                when subcat_1_code = '99'
                then 'DT khác'
                else subcat1_name
            end as subcat_1_name,

            case
                when _subcat_2_code is null 
                then '99' else _subcat_2_code
            end as subcat_2_code,

            case
                when subcat_2_code = '98'
                then 'Khác'
                when subcat_2_code = '99'
                then 'DT khác'
                else subcat2_name
            end as subcat_2_name,

            racct as "G/L Account",
            rbukrs as company_code,
            budat as posting_date,
            case when vtweg = '' then '98' else vtweg end as channel_code,
            matnr as matnr,
            fiscyearper,
            rcntr as costcenter_code,
            awtyp,
            kunnr,
            kalnr,
            qsprocess,
            werks,
            sum(
                case
                    when
                        (racct >= '0051100000' and racct <= '0051199999')
                        and (racct not in ('0051511000', '0051521000'))
                        or racct = '0064180015'
                    then hsl
                    else 0
                end

            ) as _revenue,

            sum(
                case
                    when
                        (racct >= '0051100000' and racct <= '0051199999')
                        and (racct not in ('0051511000', '0051521000'))
                    then quant1
                    else 0
                end

            ) as _quantity,

            case
                when _quantity != 0 then (_revenue / _quantity) else 0
            end as "_revenue(D/KG)",

            sum(
                case
                    when (racct >= '0063240000' and racct <= '0063289999')
                    then hsl
                    else 0
                end
            ) as _cogs,

            sum(case when racct = '0063241004' then hsl else 0 end) as "_cogs(+)",

            sum(
                case
                    when
                        (racct >= '0062200000' and racct <= '0062299999')
                        or (racct >= '0062700000' and racct <= '0062799999')
                        then hsl
                        else 0
                        end
            ) as "_manufacturing cost (4)",
     
            sum(  
                case
                    when
                        (racct >= '0064100000' and racct <= '0064199999')
                        and racct != '0064180015'
                    then hsl
                    else 0
                end
            ) as "_mkt & commercial costs (6)",

            sum(
                case
                    when racct >= '0064200000' and racct <= '0064299999' then hsl else 0
                end
            ) as "_administrative costs (7)",

            sum(
                case
                    when racct >= '0063500000' and racct <= '0063599999' then hsl else 0
                end
            ) as "_chi phí tài chính(8)",

            sum(
                case
                    when racct >= '0051500000' and racct <= '0051599999' then hsl else 0
                end
            ) as "_thu nhập tài chính(9)"

        from mapping_cat_subcat_special_case
        group by
            cat_code_n,
            cat_name_n,
            _subcat_1_code,
            subcat_1_name,
            _subcat_2_code,
            subcat_2_name,
            "G/L Account",
            company_code,
            posting_date,
            channel_code,
            matnr,
            fiscyearper,
            costcenter_code,
            awtyp,
            kunnr,
            kalnr,
            qsprocess,
            werks
    ),
final as (
    select
    cat_code_n as cat_code,
    cat_name_n as cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    company_code,
    posting_date,
    channel_code,
    matnr,
    fiscyearper,
    costcenter_code,
    kunnr as customer_code,
    kalnr,
    qsprocess,
    werks,
    sum(_revenue * (-1)) as revenue,
    sum(_quantity * (-1)) as quantity,
    sum("_revenue(D/KG)") as "revenue(D/KG)",
    sum(_cogs) as cogs,
    sum("_cogs(+)") as "cogs(+)",

    abs(revenue) - abs("cogs(+)") as "gross contribution (3) =  (1) - (+)",

    sum("_manufacturing cost (4)") as "manufacturing cost (4)",

    abs("gross contribution (3) =  (1) - (+)")
    - abs("manufacturing cost (4)") as "gross margin (5) = (3) - (4)",
    
    sum("_mkt & commercial costs (6)") as "mkt & commercial costs (6)",
    sum("_administrative costs (7)") as "administrative costs (7)",
    sum("_chi phí tài chính(8)") as "chi phí tài chính(8)",
    sum("_thu nhập tài chính(9)") as "thu nhập tài chính(9)"
from concatenate_cat_subcat
group by
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    company_code,
    posting_date,
    channel_code,
    matnr,
    fiscyearper,
    costcenter_code,
    customer_code,
    kalnr,
    qsprocess,
    werks
),
    _inter_profit as (
        select kalnr_mat,
               process,
               element,
               sum(prcdif_var) as _prcdif_var,
                sum(prcdif_fix) as _prcdif_fix
        from "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
        where curtp = '10'
            and categ = 'VN'
            and elesmhk = 'M0'
            group by kalnr_mat,
                    process,
                    element),

    distribution_inter_profit as (
        select distinct
            fi.ktopl,
            fi.kokrs,
            fi.rbukrs,
            fi.rldnr,
            case when fi.matnr = '' then fi.matnr_copa else fi.matnr end as _material,
            fi.fiscyearper,
            fi.kalnr,
            fi.qsprocess,
            fi.werks,
            ip._prcdif_var,
            ip._prcdif_fix,
            ip.element
            from _0fi_acdoca_10_filter as fi
            left join _inter_profit as ip
            on fi.kalnr = ip.kalnr_mat
            and fi.qsprocess = ip.process
            and fi.mlcateg = 'VN'
            and fi.fiscyearper = '2023005'
            ),


   distinct_final as (
        select distinct
                max(cat_code) as _cat_code,
               max(cat_name) as _cat_name,
               max(subcat_1_code) as _subcat_1_code,
               max(subcat_1_name) as _subcat_1_name,
               max(subcat_2_code) as _subcat_2_code,
               max(subcat_2_name) as _subcat_2_name,
               max("G/L Account") as "_G/L Account",
               company_code,
               max(posting_date) as _posting_date,
               max(channel_code) as _channel_code,
               matnr,
               fiscyearper,
               max(costcenter_code) as _costcenter_code,
               kalnr,
               qsprocess,
               werks,
               max(customer_code) as _customer_code
        from final
        group by matnr,
                 fiscyearper,
                 kalnr,
                 qsprocess,
                 company_code,
                 werks
                 ),

    inter_profit_1 as (
        select 
            rbukrs,
            werks,
            _material,
            sum(case
            when ip.element = '010'
            then ip._prcdif_var
            end ) as "10-Raw Material",

            sum(case
            when ip.element = '020'
            then ip._prcdif_var
            end ) as "20-Packaging",

            sum(case
            when ip.element = '030'
            then ip._prcdif_var
            end ) as "30-Subcontract",

            sum(case
            when ip.element = '040'
            then ip._prcdif_var
            end ) as "40-Delivery cost STO",

            sum(case
            when ip.element = '051'
            then ip._prcdif_var
            end ) as "51-Emp.Outsourcing",

            sum(case
            when ip.element = '052'
            then ip._prcdif_var
            end ) as "52-Consum&supplies",

            sum(case
            when ip.element = '053'
            then ip._prcdif_var
            end ) as "53-Energy& utilities",

            sum(case
            when ip.element = '059'
            then ip._prcdif_var
            end ) as "59-Other expenses",

            sum(case
            when ip.element = '061'
            then ip._prcdif_var
            end ) as "61-Wages",

            sum(case
            when ip.element = '062'
            then ip._prcdif_var
            end ) as "62-Other wages",

            sum(case
            when ip.element = '063'
            then ip._prcdif_var
            end ) as "63-Depreciation exp",

            sum(case
            when ip.element = '069'
            then ip._prcdif_var
            end ) as "69-Other expenses",

            sum(case
            when ip.element = '080'
            then ip._prcdif_var
            end ) as "80-merchendise",

            sum(case
            when ip.element = '090'
            then ip._prcdif_var
            end ) as "90-Inter.Profit"
        from distribution_inter_profit as ip
        group by rbukrs, werks, _material),

    inter_profit_2 as (
        select 
            rbukrs,
            werks,
            _material,
            sum(case
            when ip.element = '010'
            then ip._prcdif_fix
            end ) as "10-Raw Material",

            sum(case
            when ip.element = '020'
            then ip._prcdif_fix
            end ) as "20-Packaging",

            sum(case
            when ip.element = '030'
            then ip._prcdif_fix
            end ) as "30-Subcontract",

            sum(case
            when ip.element = '040'
            then ip._prcdif_fix
            end ) as "40-Delivery cost STO",

            sum(case
            when ip.element = '051'
            then ip._prcdif_fix
            end ) as "51-Emp.Outsourcing",

            sum(case
            when ip.element = '052'
            then ip._prcdif_fix
            end ) as "52-Consum&supplies",

            sum(case
            when ip.element = '053'
            then ip._prcdif_fix
            end ) as "53-Energy& utilities",

            sum(case
            when ip.element = '059'
            then ip._prcdif_fix
            end ) as "59-Other expenses",

            sum(case
            when ip.element = '061'
            then ip._prcdif_fix
            end ) as "61-Wages",

            sum(case
            when ip.element = '062'
            then ip._prcdif_fix
            end ) as "62-Other wages",

            sum(case
            when ip.element = '063'
            then ip._prcdif_fix
            end ) as "63-Depreciation exp",

            sum(case
            when ip.element = '069'
            then ip._prcdif_fix
            end ) as "69-Other expenses",

            0 as "80-merchendise",
            0 as "90-Inter.Profit"
        from distribution_inter_profit as ip
        group by rbukrs, werks, _material),

     final_all_inter_profit as (
        select * from inter_profit_1
                   union all
        select * from inter_profit_2),


final_distribution_inter_profit as(
        select
        a._cat_code,
        a._cat_name,
        a._subcat_1_code,
        a._subcat_1_name,
        a._subcat_2_code,
        a._subcat_2_name,
        a."_G/L Account",
        a.company_code,
        a._posting_date,
        a._channel_code,
        a.matnr,
        a.fiscyearper,
        a._costcenter_code,
        a._customer_code,
        a.kalnr,
        a.qsprocess,
        a.werks,
        b1."10-raw material",
        b1."20-packaging",
        b1."30-subcontract",
        b1."40-delivery cost sto",
        b1."51-emp.outsourcing",
        b1."52-consum&supplies",
        b1."53-energy& utilities",
        b1."59-other expenses",
        b1."61-wages",
        b1."62-other wages",
        b1."63-depreciation exp",
        b1."69-other expenses",
        b1."80-merchendise",
        b1."90-inter.profit"
        from distinct_final as a
        inner join final_all_inter_profit as b1
        on a.matnr = b1._material
        and a.company_code = b1.rbukrs
        and a.werks = b1.werks
    ),

final_all as (
    select 
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    company_code,
    posting_date,
    channel_code,
    matnr,
    fiscyearper,
    costcenter_code,
    customer_code,
    '' as kalnr,
    '' as qsprocess,
    werks as plant,
    revenue,
    quantity,
    "revenue(D/KG)",
    cogs,
    "cogs(+)",
    "gross contribution (3) =  (1) - (+)",
    "manufacturing cost (4)",
    "gross margin (5) = (3) - (4)",
    "mkt & commercial costs (6)",
    "administrative costs (7)",
    "chi phí tài chính(8)",
    "thu nhập tài chính(9)",
    0 as "10-raw material",
    0 as "20-packaging",
    0 as "30-subcontract",
    0 as "40-delivery cost sto",
    0 as "51-emp.outsourcing",
    0 as "52-consum&supplies",
    0 as "53-energy& utilities",
    0 as "59-other expenses",
    0 as "61-wages",
    0 as "62-other wages",
    0 as "63-depreciation exp",
    0 as "69-other expenses",
    0 as "80-merchendise",
    0 as "90-inter.profit"

    from final

    union all

    select
    _cat_code as cat_code,
    _cat_name as cat_name,
    _subcat_1_code as subcat_1_code,
    _subcat_1_name as subcat_1_name,
    _subcat_2_code as subcat_2_code,
    _subcat_2_name as subcat_2_name,
    "_G/L Account" as "G/L Account" ,
    company_code,
    _posting_date as posting_date,
    _channel_code as channel_code,
    matnr,
    fiscyearper,
    _costcenter_code as costcenter_code,
    _customer_code as customer_code,
    kalnr,
    qsprocess,
    werks as plant,
    0 as  revenue,
    0 as  quantity,
    0 as  "revenue(D/KG)",
    0 as  cogs,
    0 as  "cogs(+)",
    0 as  "gross contribution (3) = (1) - (+)",
    0 as  "manufacturing cost (4)",
    0 as  "gross margin (5) = (3) - (4)",
    0 as  "mkt & commercial costs (6)",
    0 as  "administrative costs (7)",
    0 as  "chi phí tài chính(8)",
    0 as  "thu nhập tài chính(9)",
    "10-raw material",
    "20-packaging",
    "30-subcontract",
    "40-delivery cost sto",
    "51-emp.outsourcing",
    "52-consum&supplies",
    "53-energy& utilities",
    "59-other expenses",
    "61-wages",
    "62-other wages",
    "63-depreciation exp",
    "69-other expenses",
    "80-merchendise",
    "90-inter.profit"
    from final_distribution_inter_profit)

    select * from final_all
  ) with no schema binding;
[0m18:50:25.957860 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:25.965051 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:25.966045 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: alter table "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue__dbt_tmp" rename to "food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:26.057170 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:26.058175 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: COMMIT
[0m18:50:26.059234 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:26.059234 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: COMMIT
[0m18:50:26.574261 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:50:26.575223 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:26.576223 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: BEGIN
[0m18:50:26.636310 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:26.640372 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:26.640372 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: drop view if exists "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue__dbt_backup" cascade
[0m18:50:26.701794 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:26.702804 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: COMMIT
[0m18:50:26.702804 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:26.703803 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: COMMIT
[0m18:50:26.740993 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:26.743035 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m18:50:26.743330 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: BEGIN
[0m18:50:26.774189 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:26.776375 [debug] [Thread-1  ]: Timing info for model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue (execute): 18:50:25.304086 => 18:50:26.775388
[0m18:50:26.777378 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: ROLLBACK
[0m18:50:26.835682 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: Close
[0m18:50:26.839165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D2CB850>]}
[0m18:50:26.840270 [info ] [Thread-1  ]: 9 of 10 OK created sql view model nghi_dev.food_int_fi_0fi_acdoca_10__filtered_to_revenue  [[32mSUCCESS[0m in 1.55s]
[0m18:50:26.842200 [debug] [Thread-1  ]: Finished running node model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue
[0m18:50:26.844199 [debug] [Thread-1  ]: Began running node model.sales_group.food_fi_scorecard
[0m18:50:26.845202 [info ] [Thread-1  ]: 10 of 10 START sql table model nghi_dev.fi_scorecard ........................... [RUN]
[0m18:50:26.847239 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue, now model.sales_group.food_fi_scorecard)
[0m18:50:26.848274 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_fi_scorecard
[0m18:50:26.855203 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_fi_scorecard"
[0m18:50:26.862132 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (compile): 18:50:26.848274 => 18:50:26.861132
[0m18:50:26.862132 [debug] [Thread-1  ]: Began executing node model.sales_group.food_fi_scorecard
[0m18:50:26.868690 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_fi_scorecard"
[0m18:50:26.884441 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m18:50:26.885541 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m18:50:26.885541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:26.885541 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:50:26.886532 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:50:27.183950 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:27.184949 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m18:50:27.185949 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: create  table
    "food"."nghi_dev"."fi_scorecard__dbt_tmp"
    
    
    
  as (
    select
    fi.cat_code,
    fi.cat_name,
    fi.subcat_1_code,
    fi.subcat_1_name,
    fi.subcat_2_code,
    fi.subcat_2_name,
    fi."G/L Account",
    case
        when fi."G/L Account" >= '0064100000' and fi."G/L Account" <= '0064199999' 
        then '01'
        when fi."G/L Account" >= '0064200000' and fi."G/L Account" <= '0064299999' 
        then '02'
        when (fi."G/L Account" >= '0062200000' and fi."G/L Account" <= '0062299999')
        or  (fi."G/L Account" >= '0062700000' and fi."G/L Account" <= '0062799999')
        then '03'
    end as expense_group_code,

    case when expense_group_code = '01'
        then 'CP bán hàng'
        when  expense_group_code = '02'
        then 'CP quản lý'
        when  expense_group_code = '03'
        then 'CP sản xuất'
    end as expense_group_name,
    fi.company_code,
    fi.posting_date,
    fi.channel_code,
    case when fi.channel_code = '98'
    then 'Khác'
    else cn.name end as channel_name,
    fi.matnr,
    '10' as value_type, 
    fi.fiscyearper,
    '' as kpi_code,
    '' as kpi_name,
    pl.pl_code, 
    pl.pl_name, 
    pl.pl_group_code, 
    pl.pl_group_name,
    fi.costcenter_code,
    ctxt.short_name as costcenter_name,
    ctxt.medium_name as costcenter_full_name,
    cc.costcenter_group_code,
    cc.costcenter_group_name,
    clh.hier_cost_element_name,
    clh.cost_element_code,
    fi.customer_code,
    fi.plant,
    fi.revenue,
    fi.quantity,
    fi."revenue(D/KG)",
    fi.cogs,
    fi."cogs(+)",
    fi."gross Contribution (3) =  (1) - (+)",
    fi."manufacturing cost (4)",
    fi."gross margin (5) = (3) - (4)",
    fi."mkt & Commercial Costs (6)",
    fi."administrative costs (7)",
    fi."chi phí tài chính(8)",
    fi."thu nhập tài chính(9)",
    fi."10-raw material",
    fi."20-packaging",
    fi."30-subcontract",
    fi."40-delivery cost sto",
    fi."51-emp.outsourcing",
    fi."52-consum&supplies",
    fi."53-energy& utilities",
    fi."59-other expenses",
    fi."61-wages",
    fi."62-other wages",
    fi."63-depreciation exp",
    fi."69-other expenses",
    fi."80-merchendise",
    fi."90-inter.profit"

from "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue" fi
left join "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" cn 
on fi.channel_code = cn.code

left join "food"."nghi_dev"."food_mapping_pl_plgroup" pl
on fi."G/L Account" = pl."G/L Account"

left join "food"."nghi_dev"."food_mapping_costcenter_costcentergroup" cc
on fi.costcenter_code = cc.costcenter_code

left join "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text" ctxt
on fi.costcenter_code = ctxt.code

left join "food"."nghi_dev"."food_mapping_hierarchies_costelement" clh
on fi."G/L Account" = clh.cost_element_code

union all

select
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    expense_group_code,
    expense_group_name,
    company_code,
    posting_date,
    channel_code,
    channel_name,
    matnr,
    value_type, 
    fiscyearper,
    kpi_code,
    kpi_name,
    pl_code, 
    pl_name, 
    pl_group_code, 
    pl_group_name,
    costcenter_code,
    costcenter_name,
    costcenter_full_name,
    costcenter_group_code,
    costcenter_group_name,
    '' as hier_cost_element_name,
    '' as cost_element_code,
    '' as customer_code,
    '' as plant,
    budget * 1000 as revenue, 
    quantity,
    "revenue(D/KG)",
    cogs,
    "cogs(+)",
    "gross Contribution (3) =  (1) - (+)",
    "manufacturing cost (4)",
    "gross margin (5) = (3) - (4)",
    "mkt & Commercial Costs (6)",
    "administrative costs (7)",
    "chi phí tài chính(8)",
    "thu nhập tài chính(9)",
    0 as "10-raw material",
    0 as "20-packaging",
    0 as "30-subcontract",
    0 as "40-delivery cost sto",
    0 as "51-emp.outsourcing",
    0 as "52-consum&supplies",
    0 as "53-energy& utilities",
    0 as "59-other expenses",
    0 as "61-wages",
    0 as "62-other wages",
    0 as "63-depreciation exp",
    0 as "69-other expenses",
    0 as "80-merchendise",
    0 as "90-inter.profit"

from "food"."nghi_dev"."kpi_budget"
  );
[0m18:50:44.538167 [debug] [Thread-1  ]: Redshift adapter: Redshift error: Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m18:50:44.539185 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: ROLLBACK
[0m18:50:44.601062 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (execute): 18:50:26.863132 => 18:50:44.600042
[0m18:50:44.602061 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: Close
[0m18:50:44.605093 [debug] [Thread-1  ]: Database Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)
  Specified types or functions (one per INFO message) not supported on Redshift tables.
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m18:50:44.605592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c88b7db6-441b-4ce2-97cc-f791e4c23507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D353880>]}
[0m18:50:44.606189 [error] [Thread-1  ]: 10 of 10 ERROR creating sql table model nghi_dev.fi_scorecard .................. [[31mERROR[0m in 17.76s]
[0m18:50:44.607649 [debug] [Thread-1  ]: Finished running node model.sales_group.food_fi_scorecard
[0m18:50:44.608950 [debug] [MainThread]: Using redshift connection "master"
[0m18:50:44.608950 [debug] [MainThread]: On master: BEGIN
[0m18:50:44.609949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:44.609949 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:50:44.609949 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:50:44.879668 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:44.880565 [debug] [MainThread]: On master: COMMIT
[0m18:50:44.881564 [debug] [MainThread]: Using redshift connection "master"
[0m18:50:44.882698 [debug] [MainThread]: On master: COMMIT
[0m18:50:44.943334 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:50:44.944354 [debug] [MainThread]: On master: Close
[0m18:50:44.946530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:44.946530 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m18:50:44.947528 [debug] [MainThread]: Connection 'list_tech_nghi_dev' was properly closed.
[0m18:50:44.948539 [debug] [MainThread]: Connection 'model.sales_group.food_fi_scorecard' was properly closed.
[0m18:50:44.949704 [info ] [MainThread]: 
[0m18:50:44.950734 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 1 minutes and 25.37 seconds (85.37s).
[0m18:50:44.955805 [debug] [MainThread]: Command end result
[0m18:50:44.994259 [info ] [MainThread]: 
[0m18:50:44.995463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:44.995463 [info ] [MainThread]: 
[0m18:50:44.996728 [error] [MainThread]: [33mDatabase Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)[0m
[0m18:50:44.996728 [error] [MainThread]:   Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m18:50:44.997728 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m18:50:44.997728 [info ] [MainThread]: 
[0m18:50:44.997728 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m18:50:44.999619 [debug] [MainThread]: Command `dbt run` failed at 18:50:44.999619 after 85.98 seconds
[0m18:50:44.999619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84A38BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D1CD790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D84D1CDF70>]}
[0m18:50:45.000947 [debug] [MainThread]: Flushing usage events
[0m09:15:53.015827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F21EB580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F4143640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F4143610>]}


============================== 09:15:53.020816 | ad908eef-cfdd-4a04-8ac4-e30a7777be7a ==============================
[0m09:15:53.020816 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:15:53.021816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'debug': 'False', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:15:53.270473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad908eef-cfdd-4a04-8ac4-e30a7777be7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F442AA30>]}
[0m09:15:53.282175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad908eef-cfdd-4a04-8ac4-e30a7777be7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F4439580>]}
[0m09:15:53.324761 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:15:53.731015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:15:53.731015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:15:53.747215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad908eef-cfdd-4a04-8ac4-e30a7777be7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F4E4F940>]}
[0m09:15:53.786388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad908eef-cfdd-4a04-8ac4-e30a7777be7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F46B0220>]}
[0m09:15:53.786388 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m09:15:53.787386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad908eef-cfdd-4a04-8ac4-e30a7777be7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F46B0310>]}
[0m09:15:53.789986 [warn ] [MainThread]: The selection criterion 'fi_scorecard' does not match any nodes
[0m09:15:53.793138 [info ] [MainThread]: 
[0m09:15:53.793446 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:15:53.794848 [debug] [MainThread]: Command end result
[0m09:15:53.868413 [debug] [MainThread]: Command `dbt run` succeeded at 09:15:53.867371 after 0.87 seconds
[0m09:15:53.868413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F21EB580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F3EC4CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F23C9730>]}
[0m09:15:53.868413 [debug] [MainThread]: Flushing usage events
[0m09:16:15.003387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F1A9EBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F39F36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F39F3700>]}


============================== 09:16:15.006395 | 3e1f61f0-f5ba-4685-bacc-106f18b911d8 ==============================
[0m09:16:15.006395 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:16:15.007386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:16:15.161650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e1f61f0-f5ba-4685-bacc-106f18b911d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3C3B520>]}
[0m09:16:15.173554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e1f61f0-f5ba-4685-bacc-106f18b911d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3D02160>]}
[0m09:16:15.212848 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:16:15.487113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:16:15.487838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:16:15.503893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e1f61f0-f5ba-4685-bacc-106f18b911d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3D82F40>]}
[0m09:16:15.543227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e1f61f0-f5ba-4685-bacc-106f18b911d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3F5F310>]}
[0m09:16:15.543227 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m09:16:15.544225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e1f61f0-f5ba-4685-bacc-106f18b911d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3F5F400>]}
[0m09:16:15.548997 [info ] [MainThread]: 
[0m09:16:15.552084 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m09:16:15.555004 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m09:16:15.612064 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m09:16:15.612064 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m09:16:15.612064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:15.613063 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:16:15.614063 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:16:16.162039 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m09:16:16.164038 [debug] [ThreadPool]: On list_food: Close
[0m09:16:16.175777 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food_nghi_dev'
[0m09:16:16.182773 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:16:16.182773 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m09:16:16.182773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:16.183773 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:16:16.183773 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:16:16.486956 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:16.487965 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:16:16.487965 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:16:16.576765 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:16.580759 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m09:16:16.656174 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m09:16:16.658170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_food_nghi_dev, now list_tech_nghi_dev)
[0m09:16:16.666178 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:16:16.670140 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m09:16:16.671211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:16.671211 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:16:16.671211 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:16:16.954321 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:16.954321 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:16:16.954321 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:16:17.038949 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:17.042324 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m09:16:17.113405 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m09:16:17.116134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_feed_nghi_dev)
[0m09:16:17.129516 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:16:17.129516 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m09:16:17.129516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:17.130649 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:16:17.131231 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:16:17.433354 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:17.434351 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:16:17.434351 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:16:17.524688 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:17.527684 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m09:16:17.603345 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m09:16:17.604327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_feed_nghi_dev, now list_farm_nghi_dev)
[0m09:16:17.607327 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:16:17.607327 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m09:16:17.608331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:17.608331 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:16:17.608331 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:16:17.849961 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:17.850564 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:16:17.851697 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:16:17.929613 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:17.933603 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m09:16:18.000535 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m09:16:18.003390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_group_nghi_dev)
[0m09:16:18.014403 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:16:18.014403 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m09:16:18.015475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:18.015475 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:16:18.016475 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:16:18.295389 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:18.296388 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:16:18.297329 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:16:18.381121 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:18.383193 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m09:16:18.455041 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m09:16:18.481491 [debug] [MainThread]: Using redshift connection "master"
[0m09:16:18.482450 [debug] [MainThread]: On master: BEGIN
[0m09:16:18.482450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:16:18.483501 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:16:18.483501 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:16:18.841820 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:18.842888 [debug] [MainThread]: Using redshift connection "master"
[0m09:16:18.843886 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:16:18.986758 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:18.990792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e1f61f0-f5ba-4685-bacc-106f18b911d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3EFD460>]}
[0m09:16:18.991860 [debug] [MainThread]: On master: ROLLBACK
[0m09:16:19.071537 [debug] [MainThread]: Using redshift connection "master"
[0m09:16:19.072536 [debug] [MainThread]: On master: BEGIN
[0m09:16:19.104162 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:19.105166 [debug] [MainThread]: On master: COMMIT
[0m09:16:19.106169 [debug] [MainThread]: Using redshift connection "master"
[0m09:16:19.107173 [debug] [MainThread]: On master: COMMIT
[0m09:16:19.182136 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:19.183218 [debug] [MainThread]: On master: Close
[0m09:16:19.185258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:16:19.186257 [info ] [MainThread]: 
[0m09:16:19.205377 [debug] [Thread-1  ]: Began running node model.sales_group.food_fi_scorecard
[0m09:16:19.206382 [info ] [Thread-1  ]: 1 of 1 START sql table model nghi_dev.fi_scorecard ............................. [RUN]
[0m09:16:19.208373 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_fi_scorecard'
[0m09:16:19.208373 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_fi_scorecard
[0m09:16:19.215385 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_fi_scorecard"
[0m09:16:19.220386 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (compile): 09:16:19.208373 => 09:16:19.219403
[0m09:16:19.220386 [debug] [Thread-1  ]: Began executing node model.sales_group.food_fi_scorecard
[0m09:16:19.267870 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_fi_scorecard"
[0m09:16:19.280889 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:16:19.281870 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m09:16:19.282868 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:16:19.283948 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:16:19.283948 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:16:19.585973 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:19.586995 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:16:19.588996 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: create  table
    "food"."nghi_dev"."fi_scorecard__dbt_tmp"
    
    
    
  as (
    select
    fi.cat_code,
    fi.cat_name,
    fi.subcat_1_code,
    fi.subcat_1_name,
    fi.subcat_2_code,
    fi.subcat_2_name,
    fi."G/L Account",
    case
        when fi."G/L Account" >= '0064100000' and fi."G/L Account" <= '0064199999' 
        then '01'
        when fi."G/L Account" >= '0064200000' and fi."G/L Account" <= '0064299999' 
        then '02'
        when (fi."G/L Account" >= '0062200000' and fi."G/L Account" <= '0062299999')
        or  (fi."G/L Account" >= '0062700000' and fi."G/L Account" <= '0062799999')
        then '03'
    end as expense_group_code,

    case when expense_group_code = '01'
        then 'CP bán hàng'
        when  expense_group_code = '02'
        then 'CP quản lý'
        when  expense_group_code = '03'
        then 'CP sản xuất'
    end as expense_group_name,
    fi.company_code,
    fi.posting_date,
    fi.channel_code,
    case when fi.channel_code = '98'
    then 'Khác'
    else cn.name end as channel_name,
    fi.matnr,
    '10' as value_type, 
    fi.fiscyearper,
    '' as kpi_code,
    '' as kpi_name,
    pl.pl_code, 
    pl.pl_name, 
    pl.pl_group_code, 
    pl.pl_group_name,
    fi.costcenter_code,
    ctxt.short_name as costcenter_name,
    ctxt.medium_name as costcenter_full_name,
    cc.costcenter_group_code,
    cc.costcenter_group_name,
    clh.hier_cost_element_name,
    clh.cost_element_code,
    fi.customer_code,
    fi.plant,
    fi.revenue,
    fi.quantity,
    fi."revenue(D/KG)",
    fi.cogs,
    fi."cogs(+)",
    fi."gross Contribution (3) =  (1) - (+)",
    fi."manufacturing cost (4)",
    fi."gross margin (5) = (3) - (4)",
    fi."mkt & Commercial Costs (6)",
    fi."administrative costs (7)",
    fi."chi phí tài chính(8)",
    fi."thu nhập tài chính(9)",
    fi."10-raw material",
    fi."20-packaging",
    fi."30-subcontract",
    fi."40-delivery cost sto",
    fi."51-emp.outsourcing",
    fi."52-consum&supplies",
    fi."53-energy& utilities",
    fi."59-other expenses",
    fi."61-wages",
    fi."62-other wages",
    fi."63-depreciation exp",
    fi."69-other expenses",
    fi."80-merchendise",
    fi."90-inter.profit"

from "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue" fi
left join "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" cn 
on fi.channel_code = cn.code

left join "food"."nghi_dev"."food_mapping_pl_plgroup" pl
on fi."G/L Account" = pl."G/L Account"

left join "food"."nghi_dev"."food_mapping_costcenter_costcentergroup" cc
on fi.costcenter_code = cc.costcenter_code

left join "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text" ctxt
on fi.costcenter_code = ctxt.code

left join "food"."nghi_dev"."food_mapping_hierarchies_costelement" clh
on fi."G/L Account" = clh.cost_element_code

union all

select
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    expense_group_code,
    expense_group_name,
    company_code,
    posting_date,
    channel_code,
    channel_name,
    matnr,
    value_type, 
    fiscyearper,
    kpi_code,
    kpi_name,
    pl_code, 
    pl_name, 
    pl_group_code, 
    pl_group_name,
    costcenter_code,
    costcenter_name,
    costcenter_full_name,
    costcenter_group_code,
    costcenter_group_name,
    '' as hier_cost_element_name,
    '' as cost_element_code,
    '' as customer_code,
    '' as plant,
    budget * 1000 as revenue, 
    quantity,
    "revenue(D/KG)",
    cogs,
    "cogs(+)",
    "gross Contribution (3) =  (1) - (+)",
    "manufacturing cost (4)",
    "gross margin (5) = (3) - (4)",
    "mkt & Commercial Costs (6)",
    "administrative costs (7)",
    "chi phí tài chính(8)",
    "thu nhập tài chính(9)",
    0 as "10-raw material",
    0 as "20-packaging",
    0 as "30-subcontract",
    0 as "40-delivery cost sto",
    0 as "51-emp.outsourcing",
    0 as "52-consum&supplies",
    0 as "53-energy& utilities",
    0 as "59-other expenses",
    0 as "61-wages",
    0 as "62-other wages",
    0 as "63-depreciation exp",
    0 as "69-other expenses",
    0 as "80-merchendise",
    0 as "90-inter.profit"

from "food"."nghi_dev"."kpi_budget"
  );
[0m09:16:38.834687 [debug] [Thread-1  ]: Redshift adapter: Redshift error: Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m09:16:38.835687 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: ROLLBACK
[0m09:16:38.917794 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (execute): 09:16:19.220386 => 09:16:38.917794
[0m09:16:38.918790 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: Close
[0m09:16:38.926378 [debug] [Thread-1  ]: Database Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)
  Specified types or functions (one per INFO message) not supported on Redshift tables.
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m09:16:38.927454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e1f61f0-f5ba-4685-bacc-106f18b911d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F4745880>]}
[0m09:16:38.927454 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nghi_dev.fi_scorecard .................... [[31mERROR[0m in 19.72s]
[0m09:16:38.928369 [debug] [Thread-1  ]: Finished running node model.sales_group.food_fi_scorecard
[0m09:16:38.930368 [debug] [MainThread]: Using redshift connection "master"
[0m09:16:38.931369 [debug] [MainThread]: On master: BEGIN
[0m09:16:38.931369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:16:38.931369 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:16:38.931369 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:16:39.245362 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:39.246375 [debug] [MainThread]: On master: COMMIT
[0m09:16:39.246375 [debug] [MainThread]: Using redshift connection "master"
[0m09:16:39.246375 [debug] [MainThread]: On master: COMMIT
[0m09:16:39.315125 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:16:39.316199 [debug] [MainThread]: On master: Close
[0m09:16:39.318195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:39.318195 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m09:16:39.318195 [debug] [MainThread]: Connection 'list_group_nghi_dev' was properly closed.
[0m09:16:39.318195 [debug] [MainThread]: Connection 'model.sales_group.food_fi_scorecard' was properly closed.
[0m09:16:39.319191 [info ] [MainThread]: 
[0m09:16:39.320127 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 23.77 seconds (23.77s).
[0m09:16:39.321123 [debug] [MainThread]: Command end result
[0m09:16:39.352518 [info ] [MainThread]: 
[0m09:16:39.353520 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:16:39.354518 [info ] [MainThread]: 
[0m09:16:39.355523 [error] [MainThread]: [33mDatabase Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)[0m
[0m09:16:39.355523 [error] [MainThread]:   Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m09:16:39.356521 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m09:16:39.357520 [info ] [MainThread]: 
[0m09:16:39.357520 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:16:39.358519 [debug] [MainThread]: Command `dbt run` failed at 09:16:39.358519 after 24.36 seconds
[0m09:16:39.359900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F1A9EBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F472F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F472FCD0>]}
[0m09:16:39.359937 [debug] [MainThread]: Flushing usage events
[0m09:17:03.826230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A725DFC3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A727D536A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A727D53670>]}


============================== 09:17:03.830216 | 773d03b2-8ede-43a6-a7c7-7f320b8010a5 ==============================
[0m09:17:03.830216 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:17:03.831537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:17:03.983129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '773d03b2-8ede-43a6-a7c7-7f320b8010a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7262F4700>]}
[0m09:17:03.995298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '773d03b2-8ede-43a6-a7c7-7f320b8010a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A72803A340>]}
[0m09:17:04.034585 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:17:04.309024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:17:04.310150 [debug] [MainThread]: Partial parsing: updated file: sales_group://models\food\marts\score_card\food_fi_scorecard.sql
[0m09:17:04.420005 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_fi_scorecard.sql
[0m09:17:04.518098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '773d03b2-8ede-43a6-a7c7-7f320b8010a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A728A57070>]}
[0m09:17:04.556707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '773d03b2-8ede-43a6-a7c7-7f320b8010a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7280C2880>]}
[0m09:17:04.557710 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m09:17:04.559003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '773d03b2-8ede-43a6-a7c7-7f320b8010a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7280C2790>]}
[0m09:17:04.562098 [info ] [MainThread]: 
[0m09:17:04.564067 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m09:17:04.566025 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m09:17:04.579817 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m09:17:04.579817 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m09:17:04.580818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:04.581818 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:17:04.582817 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:17:05.114201 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m09:17:05.116193 [debug] [ThreadPool]: On list_food: Close
[0m09:17:05.127626 [debug] [ThreadPool]: Acquiring new redshift connection 'list_feed_nghi_dev'
[0m09:17:05.136012 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:17:05.136012 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m09:17:05.137018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:05.137018 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:17:05.137018 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:17:05.440583 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:05.441554 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:17:05.442551 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:17:05.539156 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:05.542157 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m09:17:05.621791 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m09:17:05.624754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_feed_nghi_dev, now list_farm_nghi_dev)
[0m09:17:05.631648 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:17:05.631648 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m09:17:05.632299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:05.632299 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:17:05.632299 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:17:05.958315 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:05.959392 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:17:05.960400 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:17:06.054347 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:06.057348 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m09:17:06.152812 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m09:17:06.153824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_group_nghi_dev)
[0m09:17:06.157955 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:17:06.157955 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m09:17:06.157955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:06.159063 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:17:06.159063 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:17:06.458025 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:06.459037 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:17:06.460037 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:17:06.544048 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:06.547979 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m09:17:06.619064 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m09:17:06.621980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_group_nghi_dev, now list_tech_nghi_dev)
[0m09:17:06.633783 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:17:06.634783 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m09:17:06.634783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:06.634783 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:17:06.635783 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:17:06.914312 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:06.915313 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:17:06.915313 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:17:07.003052 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:07.005053 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m09:17:07.079213 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m09:17:07.080246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_food_nghi_dev)
[0m09:17:07.092197 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:17:07.092197 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m09:17:07.093197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:07.093197 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:17:07.093197 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:17:07.374021 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:07.375032 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:17:07.376044 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:17:07.459260 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:07.463444 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m09:17:07.535392 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m09:17:07.561089 [debug] [MainThread]: Using redshift connection "master"
[0m09:17:07.561089 [debug] [MainThread]: On master: BEGIN
[0m09:17:07.561089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:17:07.562090 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:17:07.562090 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:17:07.856278 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:07.857276 [debug] [MainThread]: Using redshift connection "master"
[0m09:17:07.858278 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:17:07.988090 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:07.991089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '773d03b2-8ede-43a6-a7c7-7f320b8010a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A72803A6D0>]}
[0m09:17:07.992090 [debug] [MainThread]: On master: ROLLBACK
[0m09:17:08.067259 [debug] [MainThread]: Using redshift connection "master"
[0m09:17:08.068335 [debug] [MainThread]: On master: BEGIN
[0m09:17:08.097856 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:08.098855 [debug] [MainThread]: On master: COMMIT
[0m09:17:08.099854 [debug] [MainThread]: Using redshift connection "master"
[0m09:17:08.099854 [debug] [MainThread]: On master: COMMIT
[0m09:17:08.157410 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:08.158608 [debug] [MainThread]: On master: Close
[0m09:17:08.160637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:17:08.162300 [info ] [MainThread]: 
[0m09:17:08.174473 [debug] [Thread-1  ]: Began running node model.sales_group.food_fi_scorecard
[0m09:17:08.175542 [info ] [Thread-1  ]: 1 of 1 START sql table model nghi_dev.fi_scorecard ............................. [RUN]
[0m09:17:08.177501 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_fi_scorecard'
[0m09:17:08.177501 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_fi_scorecard
[0m09:17:08.184806 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_fi_scorecard"
[0m09:17:08.186803 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (compile): 09:17:08.177501 => 09:17:08.186803
[0m09:17:08.187796 [debug] [Thread-1  ]: Began executing node model.sales_group.food_fi_scorecard
[0m09:17:08.239688 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_fi_scorecard"
[0m09:17:08.248400 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:17:08.249486 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m09:17:08.250466 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:17:08.250466 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:17:08.250466 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:17:08.555280 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:08.557284 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:17:08.558285 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: create  table
    "food"."nghi_dev"."fi_scorecard__dbt_tmp"
    
    
    
  as (
    select
    fi.cat_code,
    fi.cat_name,
    fi.subcat_1_code,
    fi.subcat_1_name,
    fi.subcat_2_code,
    fi.subcat_2_name,
    fi."G/L Account",
    case
        when fi."G/L Account" >= '0064100000' and fi."G/L Account" <= '0064199999' 
        then '01'
        when fi."G/L Account" >= '0064200000' and fi."G/L Account" <= '0064299999' 
        then '02'
        when (fi."G/L Account" >= '0062200000' and fi."G/L Account" <= '0062299999')
        or  (fi."G/L Account" >= '0062700000' and fi."G/L Account" <= '0062799999')
        then '03'
    end as expense_group_code,

    case when expense_group_code = '01'
        then 'CP bán hàng'
        when  expense_group_code = '02'
        then 'CP quản lý'
        when  expense_group_code = '03'
        then 'CP sản xuất'
    end as expense_group_name,
    fi.company_code,
    fi.posting_date,
    fi.channel_code,
    case when fi.channel_code = '98'
    then 'Khác'
    else cn.name end as channel_name,
    fi.matnr,
    '10' as value_type, 
    fi.fiscyearper,
    '' as kpi_code,
    '' as kpi_name,
    pl.pl_code, 
    pl.pl_name, 
    pl.pl_group_code, 
    pl.pl_group_name,
    fi.costcenter_code,
    ctxt.short_name as costcenter_name,
    ctxt.medium_name as costcenter_full_name,
    cc.costcenter_group_code,
    cc.costcenter_group_name,
    clh.hier_cost_element_name,
    clh.cost_element_code,
    fi.customer_code,
    fi.plant,
    fi.revenue,
    fi.quantity,
    fi."revenue(D/KG)",
    fi.cogs,
    fi."cogs(+)",
    fi."gross Contribution (3) =  (1) - (+)",
    fi."manufacturing cost (4)",
    fi."gross margin (5) = (3) - (4)",
    fi."mkt & Commercial Costs (6)",
    fi."administrative costs (7)",
    fi."chi phí tài chính(8)",
    fi."thu nhập tài chính(9)",
    fi."10-raw material",
    fi."20-packaging",
    fi."30-subcontract",
    fi."40-delivery cost sto",
    fi."51-emp.outsourcing",
    fi."52-consum&supplies",
    fi."53-energy& utilities",
    fi."59-other expenses",
    fi."61-wages",
    fi."62-other wages",
    fi."63-depreciation exp",
    fi."69-other expenses",
    fi."80-merchendise",
    fi."90-inter.profit"

from "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue" fi
left join "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" cn 
on fi.channel_code = cn.code

left join "food"."nghi_dev"."food_mapping_pl_plgroup" pl
on fi."G/L Account" = pl."G/L Account"

left join "food"."nghi_dev"."food_mapping_costcenter_costcentergroup" cc
on fi.costcenter_code = cc.costcenter_code

left join "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text" ctxt
on fi.costcenter_code = ctxt.code

left join "food"."nghi_dev"."food_mapping_hierarchies_costelement" clh
on fi."G/L Account" = clh.cost_element_code

  );
[0m09:17:26.644634 [debug] [Thread-1  ]: Redshift adapter: Redshift error: Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m09:17:26.644634 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: ROLLBACK
[0m09:17:26.713476 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (execute): 09:17:08.187796 => 09:17:26.712482
[0m09:17:26.714478 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: Close
[0m09:17:26.717693 [debug] [Thread-1  ]: Database Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)
  Specified types or functions (one per INFO message) not supported on Redshift tables.
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m09:17:26.718779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '773d03b2-8ede-43a6-a7c7-7f320b8010a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A728A42070>]}
[0m09:17:26.719692 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nghi_dev.fi_scorecard .................... [[31mERROR[0m in 18.54s]
[0m09:17:26.720692 [debug] [Thread-1  ]: Finished running node model.sales_group.food_fi_scorecard
[0m09:17:26.721778 [debug] [MainThread]: Using redshift connection "master"
[0m09:17:26.721778 [debug] [MainThread]: On master: BEGIN
[0m09:17:26.721778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:17:26.723084 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:17:26.723084 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:17:27.122421 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:27.123964 [debug] [MainThread]: On master: COMMIT
[0m09:17:27.124967 [debug] [MainThread]: Using redshift connection "master"
[0m09:17:27.125960 [debug] [MainThread]: On master: COMMIT
[0m09:17:27.294620 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:17:27.295499 [debug] [MainThread]: On master: Close
[0m09:17:27.297497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:17:27.298497 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m09:17:27.298497 [debug] [MainThread]: Connection 'list_food_nghi_dev' was properly closed.
[0m09:17:27.299497 [debug] [MainThread]: Connection 'model.sales_group.food_fi_scorecard' was properly closed.
[0m09:17:27.299497 [info ] [MainThread]: 
[0m09:17:27.300496 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.74 seconds (22.74s).
[0m09:17:27.302497 [debug] [MainThread]: Command end result
[0m09:17:27.336637 [info ] [MainThread]: 
[0m09:17:27.338595 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:17:27.340044 [info ] [MainThread]: 
[0m09:17:27.340889 [error] [MainThread]: [33mDatabase Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)[0m
[0m09:17:27.342219 [error] [MainThread]:   Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m09:17:27.344246 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m09:17:27.345248 [info ] [MainThread]: 
[0m09:17:27.346245 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:17:27.347245 [debug] [MainThread]: Command `dbt run` failed at 09:17:27.347245 after 23.53 seconds
[0m09:17:27.348255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A725DFC3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A728A42370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A728A42670>]}
[0m09:17:27.348255 [debug] [MainThread]: Flushing usage events
[0m09:18:13.778976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AB74E580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AD6A36A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AD6A3640>]}


============================== 09:18:13.782904 | 705279db-b639-41bc-9b7b-7bdb2e59f650 ==============================
[0m09:18:13.782904 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:18:13.783904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:18:13.950625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '705279db-b639-41bc-9b7b-7bdb2e59f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AD8EC430>]}
[0m09:18:13.964889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '705279db-b639-41bc-9b7b-7bdb2e59f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AD997760>]}
[0m09:18:14.008630 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:18:14.323709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:18:14.325772 [debug] [MainThread]: Partial parsing: updated file: sales_group://models\food\marts\score_card\food_fi_scorecard.sql
[0m09:18:14.344773 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_fi_scorecard.sql
[0m09:18:14.439468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '705279db-b639-41bc-9b7b-7bdb2e59f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AE0A4730>]}
[0m09:18:14.482536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '705279db-b639-41bc-9b7b-7bdb2e59f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258ADC0B220>]}
[0m09:18:14.483465 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m09:18:14.484471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '705279db-b639-41bc-9b7b-7bdb2e59f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258ADC0B190>]}
[0m09:18:14.489418 [info ] [MainThread]: 
[0m09:18:14.490407 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m09:18:14.493406 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m09:18:14.509274 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m09:18:14.510265 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m09:18:14.510265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:14.511265 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:18:14.511265 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:18:15.165947 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m09:18:15.167939 [debug] [ThreadPool]: On list_food: Close
[0m09:18:15.188184 [debug] [ThreadPool]: Acquiring new redshift connection 'list_tech_nghi_dev'
[0m09:18:15.196265 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:18:15.196265 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m09:18:15.196265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:15.197268 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:18:15.197268 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:18:15.458179 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:15.459265 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:18:15.459265 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:18:15.543809 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:15.546845 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m09:18:15.618927 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m09:18:15.623912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_farm_nghi_dev)
[0m09:18:15.632993 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:18:15.632993 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m09:18:15.632993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:15.633991 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:18:15.633991 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:18:15.965211 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:15.966199 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:18:15.967195 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:18:16.062138 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:16.065137 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m09:18:16.146415 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m09:18:16.147449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_group_nghi_dev)
[0m09:18:16.160424 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:18:16.160424 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m09:18:16.160424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:16.161602 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:18:16.161602 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:18:16.501296 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:16.501296 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:18:16.501296 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:18:16.597242 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:16.601328 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m09:18:16.687764 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m09:18:16.688815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_group_nghi_dev, now list_feed_nghi_dev)
[0m09:18:16.697732 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:18:16.706959 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m09:18:16.706959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:16.706959 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:18:16.707923 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:18:16.993429 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:16.994310 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:18:16.995309 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:18:17.102993 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:17.106012 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m09:18:17.186456 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m09:18:17.187476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_feed_nghi_dev, now list_food_nghi_dev)
[0m09:18:17.200466 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:18:17.209572 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m09:18:17.209572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:17.209572 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:18:17.210481 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:18:17.517969 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:17.519875 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:18:17.520259 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:18:17.615865 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:17.616865 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m09:18:17.696095 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m09:18:17.732615 [debug] [MainThread]: Using redshift connection "master"
[0m09:18:17.733614 [debug] [MainThread]: On master: BEGIN
[0m09:18:17.733614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:18:17.734613 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:18:17.734613 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:18:18.052886 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:18.053997 [debug] [MainThread]: Using redshift connection "master"
[0m09:18:18.055621 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:18:18.207919 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:18.213048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '705279db-b639-41bc-9b7b-7bdb2e59f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AE440460>]}
[0m09:18:18.214128 [debug] [MainThread]: On master: ROLLBACK
[0m09:18:18.302716 [debug] [MainThread]: Using redshift connection "master"
[0m09:18:18.304013 [debug] [MainThread]: On master: BEGIN
[0m09:18:18.338652 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:18.338652 [debug] [MainThread]: On master: COMMIT
[0m09:18:18.338652 [debug] [MainThread]: Using redshift connection "master"
[0m09:18:18.339678 [debug] [MainThread]: On master: COMMIT
[0m09:18:18.407415 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:18.408334 [debug] [MainThread]: On master: Close
[0m09:18:18.410333 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:18:18.411327 [info ] [MainThread]: 
[0m09:18:18.426419 [debug] [Thread-1  ]: Began running node model.sales_group.food_fi_scorecard
[0m09:18:18.427477 [info ] [Thread-1  ]: 1 of 1 START sql table model nghi_dev.fi_scorecard ............................. [RUN]
[0m09:18:18.428976 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_fi_scorecard'
[0m09:18:18.429977 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_fi_scorecard
[0m09:18:18.440012 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_fi_scorecard"
[0m09:18:18.444587 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (compile): 09:18:18.431047 => 09:18:18.444587
[0m09:18:18.445600 [debug] [Thread-1  ]: Began executing node model.sales_group.food_fi_scorecard
[0m09:18:18.513812 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_fi_scorecard"
[0m09:18:18.516786 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:18:18.517817 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m09:18:18.517817 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:18:18.517817 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:18:18.518818 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:18:18.821289 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:18.821289 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:18:18.822297 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: create  table
    "food"."nghi_dev"."fi_scorecard__dbt_tmp"
    
    
    
  as (
    


select * from "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue"
  );
[0m09:18:36.439751 [debug] [Thread-1  ]: Redshift adapter: Redshift error: Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m09:18:36.439751 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: ROLLBACK
[0m09:18:36.496130 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (execute): 09:18:18.445600 => 09:18:36.495507
[0m09:18:36.496130 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: Close
[0m09:18:36.501405 [debug] [Thread-1  ]: Database Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)
  Specified types or functions (one per INFO message) not supported on Redshift tables.
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m09:18:36.503407 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '705279db-b639-41bc-9b7b-7bdb2e59f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AE5A4670>]}
[0m09:18:36.504407 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nghi_dev.fi_scorecard .................... [[31mERROR[0m in 18.07s]
[0m09:18:36.505827 [debug] [Thread-1  ]: Finished running node model.sales_group.food_fi_scorecard
[0m09:18:36.507344 [debug] [MainThread]: Using redshift connection "master"
[0m09:18:36.508343 [debug] [MainThread]: On master: BEGIN
[0m09:18:36.509343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:18:36.511353 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:18:36.512067 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:18:36.823364 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:36.825374 [debug] [MainThread]: On master: COMMIT
[0m09:18:36.826365 [debug] [MainThread]: Using redshift connection "master"
[0m09:18:36.827365 [debug] [MainThread]: On master: COMMIT
[0m09:18:36.893479 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:18:36.894049 [debug] [MainThread]: On master: Close
[0m09:18:36.896028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:36.896528 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m09:18:36.897028 [debug] [MainThread]: Connection 'list_food_nghi_dev' was properly closed.
[0m09:18:36.897028 [debug] [MainThread]: Connection 'model.sales_group.food_fi_scorecard' was properly closed.
[0m09:18:36.898036 [info ] [MainThread]: 
[0m09:18:36.900292 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.41 seconds (22.41s).
[0m09:18:36.901310 [debug] [MainThread]: Command end result
[0m09:18:36.949955 [info ] [MainThread]: 
[0m09:18:36.952191 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:18:36.954162 [info ] [MainThread]: 
[0m09:18:36.955282 [error] [MainThread]: [33mDatabase Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)[0m
[0m09:18:36.955780 [error] [MainThread]:   Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m09:18:36.956913 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m09:18:36.957995 [info ] [MainThread]: 
[0m09:18:36.957995 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:18:36.958997 [debug] [MainThread]: Command `dbt run` failed at 09:18:36.958997 after 23.19 seconds
[0m09:18:36.959912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AB74E580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AE55BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AE55BC70>]}
[0m09:18:36.959912 [debug] [MainThread]: Flushing usage events
[0m09:19:26.631199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AA8A0C070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AAA9636A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AAA963670>]}


============================== 09:19:26.634269 | f7cf8583-b3ee-438b-b10c-b8d3f792bd53 ==============================
[0m09:19:26.634269 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:19:26.636280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:19:26.811226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7cf8583-b3ee-438b-b10c-b8d3f792bd53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AA8F04700>]}
[0m09:19:26.823646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7cf8583-b3ee-438b-b10c-b8d3f792bd53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AAAC4C520>]}
[0m09:19:26.868085 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:19:27.191919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:19:27.193760 [debug] [MainThread]: Partial parsing: updated file: sales_group://models\food\marts\score_card\food_fi_scorecard.sql
[0m09:19:27.215579 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_fi_scorecard.sql
[0m09:19:27.313927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7cf8583-b3ee-438b-b10c-b8d3f792bd53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AAB283130>]}
[0m09:19:27.361340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7cf8583-b3ee-438b-b10c-b8d3f792bd53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AAB635EE0>]}
[0m09:19:27.361340 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m09:19:27.364076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7cf8583-b3ee-438b-b10c-b8d3f792bd53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AAB635E50>]}
[0m09:19:27.369230 [info ] [MainThread]: 
[0m09:19:27.371159 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m09:19:27.373202 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m09:19:27.387719 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m09:19:27.388631 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m09:19:27.388631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:27.389714 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:19:27.389714 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:19:27.970719 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m09:19:27.972715 [debug] [ThreadPool]: On list_food: Close
[0m09:19:27.974641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:27.974641 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m09:19:27.974641 [info ] [MainThread]: 
[0m09:19:27.976134 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m09:19:27.976633 [error] [MainThread]: Encountered an error:

[0m09:19:27.983071 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 250, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\main.py", line 565, in run
    results = task.run()
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\runnable.py", line 403, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\run.py", line 446, in before_run
    self.create_schemas(adapter, required_schemas)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\runnable.py", line 538, in create_schemas
    for ls_future in as_completed(list_futures):
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\concurrent\futures\_base.py", line 245, in as_completed
    waiter.event.wait(wait_timeout)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\threading.py", line 574, in wait
    signaled = self._cond.wait(timeout)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\threading.py", line 312, in wait
    waiter.acquire()
KeyboardInterrupt

[0m09:19:27.987685 [debug] [MainThread]: Command `dbt run` failed at 09:19:27.987685 after 1.37 seconds
[0m09:19:27.988685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AA8A0C070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AAB635DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AAB3065B0>]}
[0m09:19:27.988685 [debug] [MainThread]: Flushing usage events
[0m09:19:39.666087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A4FDEBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A6F33700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A6F336A0>]}


============================== 09:19:39.669344 | eeedf701-c761-4676-9d82-fc27e39d06d5 ==============================
[0m09:19:39.669344 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:19:39.670336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:19:39.831505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eeedf701-c761-4676-9d82-fc27e39d06d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A721D550>]}
[0m09:19:39.844153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eeedf701-c761-4676-9d82-fc27e39d06d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A5262CD0>]}
[0m09:19:39.885724 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:19:40.194576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:19:40.195576 [debug] [MainThread]: Partial parsing: updated file: sales_group://models\food\marts\score_card\food_fi_scorecard.sql
[0m09:19:40.214483 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_fi_scorecard.sql
[0m09:19:40.306370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeedf701-c761-4676-9d82-fc27e39d06d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A7C195B0>]}
[0m09:19:40.346492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eeedf701-c761-4676-9d82-fc27e39d06d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A7BF5DF0>]}
[0m09:19:40.346492 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m09:19:40.348494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeedf701-c761-4676-9d82-fc27e39d06d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A7BF5EE0>]}
[0m09:19:40.352493 [info ] [MainThread]: 
[0m09:19:40.354493 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m09:19:40.357146 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m09:19:40.370352 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m09:19:40.371350 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m09:19:40.371350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:40.373268 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:19:40.373268 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:19:40.867985 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:40.871319 [debug] [ThreadPool]: On list_food: Close
[0m09:19:40.883931 [debug] [ThreadPool]: Acquiring new redshift connection 'list_tech_nghi_dev'
[0m09:19:40.892674 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:19:40.892674 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m09:19:40.892674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:40.893700 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:19:40.893700 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:19:41.172880 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:41.173877 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:19:41.173877 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:19:41.264749 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:41.267722 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m09:19:41.338124 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m09:19:41.340161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_group_nghi_dev)
[0m09:19:41.343160 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:19:41.344160 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m09:19:41.344160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:41.344160 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:19:41.345166 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:19:41.658801 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:41.659152 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:19:41.659766 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:19:41.753081 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:41.754638 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m09:19:41.834436 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m09:19:41.835519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_group_nghi_dev, now list_food_nghi_dev)
[0m09:19:41.839348 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:19:41.839348 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m09:19:41.839348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:41.840359 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:19:41.840359 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:19:42.169269 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:42.169959 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:19:42.170379 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:19:42.267980 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:42.270919 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m09:19:42.364435 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m09:19:42.365435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_food_nghi_dev, now list_feed_nghi_dev)
[0m09:19:42.378413 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:19:42.378413 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m09:19:42.379406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:42.379406 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:19:42.379406 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:19:42.707967 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:42.708983 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:19:42.709980 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:19:42.793530 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:42.795551 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m09:19:42.867565 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m09:19:42.869565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_feed_nghi_dev, now list_farm_nghi_dev)
[0m09:19:42.879803 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:19:42.886888 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m09:19:42.887276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:42.889782 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:19:42.890782 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:19:43.212431 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:43.213509 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:19:43.213509 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:19:43.305727 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:43.307954 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m09:19:43.390530 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m09:19:43.420560 [debug] [MainThread]: Using redshift connection "master"
[0m09:19:43.420560 [debug] [MainThread]: On master: BEGIN
[0m09:19:43.420560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:43.421707 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:19:43.421707 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:19:43.748486 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:43.749486 [debug] [MainThread]: Using redshift connection "master"
[0m09:19:43.750486 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:19:43.896533 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:43.898622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeedf701-c761-4676-9d82-fc27e39d06d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A7CC0460>]}
[0m09:19:43.899613 [debug] [MainThread]: On master: ROLLBACK
[0m09:19:43.987052 [debug] [MainThread]: Using redshift connection "master"
[0m09:19:43.988127 [debug] [MainThread]: On master: BEGIN
[0m09:19:44.023617 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:44.024630 [debug] [MainThread]: On master: COMMIT
[0m09:19:44.025629 [debug] [MainThread]: Using redshift connection "master"
[0m09:19:44.025629 [debug] [MainThread]: On master: COMMIT
[0m09:19:44.092402 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:44.093414 [debug] [MainThread]: On master: Close
[0m09:19:44.094442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:19:44.095413 [info ] [MainThread]: 
[0m09:19:44.109874 [debug] [Thread-1  ]: Began running node model.sales_group.food_fi_scorecard
[0m09:19:44.112871 [info ] [Thread-1  ]: 1 of 1 START sql table model nghi_dev.fi_scorecard ............................. [RUN]
[0m09:19:44.114871 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_fi_scorecard'
[0m09:19:44.114871 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_fi_scorecard
[0m09:19:44.119369 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_fi_scorecard"
[0m09:19:44.121758 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (compile): 09:19:44.114871 => 09:19:44.121257
[0m09:19:44.123695 [debug] [Thread-1  ]: Began executing node model.sales_group.food_fi_scorecard
[0m09:19:44.185224 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_fi_scorecard"
[0m09:19:44.193044 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:19:44.194004 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m09:19:44.195119 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:19:44.195618 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:19:44.195618 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:19:44.520542 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:19:44.521040 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:19:44.521040 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: create  table
    "food"."nghi_dev"."fi_scorecard__dbt_tmp"
    
    
    
  as (
    



select
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    expense_group_code,
    expense_group_name,
    company_code,
    posting_date,
    channel_code,
    channel_name,
    matnr,
    value_type, 
    fiscyearper,
    kpi_code,
    kpi_name,
    pl_code, 
    pl_name, 
    pl_group_code, 
    pl_group_name,
    costcenter_code,
    costcenter_name,
    costcenter_full_name,
    costcenter_group_code,
    costcenter_group_name,
    '' as hier_cost_element_name,
    '' as cost_element_code,
    '' as customer_code,
    '' as plant,
    budget * 1000 as revenue, 
    quantity,
    "revenue(D/KG)",
    cogs,
    "cogs(+)",
    "gross Contribution (3) =  (1) - (+)",
    "manufacturing cost (4)",
    "gross margin (5) = (3) - (4)",
    "mkt & Commercial Costs (6)",
    "administrative costs (7)",
    "chi phí tài chính(8)",
    "thu nhập tài chính(9)",
    0 as "10-raw material",
    0 as "20-packaging",
    0 as "30-subcontract",
    0 as "40-delivery cost sto",
    0 as "51-emp.outsourcing",
    0 as "52-consum&supplies",
    0 as "53-energy& utilities",
    0 as "59-other expenses",
    0 as "61-wages",
    0 as "62-other wages",
    0 as "63-depreciation exp",
    0 as "69-other expenses",
    0 as "80-merchendise",
    0 as "90-inter.profit"

from "food"."nghi_dev"."kpi_budget"


  );
[0m09:20:00.810101 [debug] [Thread-1  ]: SQL status: SUCCESS in 16.0 seconds
[0m09:20:00.825703 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:20:00.826831 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: alter table "food"."nghi_dev"."fi_scorecard__dbt_tmp" rename to "fi_scorecard"
[0m09:20:01.009297 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:20:01.039997 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: COMMIT
[0m09:20:01.039997 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:20:01.039997 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: COMMIT
[0m09:20:01.784017 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m09:20:01.785008 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:20:01.785008 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m09:20:01.861656 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:20:01.873359 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:20:01.874359 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: drop table if exists "food"."nghi_dev"."fi_scorecard__dbt_backup" cascade
[0m09:20:01.947304 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:20:01.949390 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: COMMIT
[0m09:20:01.950390 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:20:01.951400 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: COMMIT
[0m09:20:01.994399 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:20:01.994399 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:20:01.994399 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m09:20:02.031741 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:20:02.033741 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (execute): 09:19:44.125692 => 09:20:02.033741
[0m09:20:02.034740 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: ROLLBACK
[0m09:20:02.107366 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: Close
[0m09:20:02.110316 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeedf701-c761-4676-9d82-fc27e39d06d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A53664F0>]}
[0m09:20:02.111316 [info ] [Thread-1  ]: 1 of 1 OK created sql table model nghi_dev.fi_scorecard ........................ [[32mSUCCESS[0m in 18.00s]
[0m09:20:02.114981 [debug] [Thread-1  ]: Finished running node model.sales_group.food_fi_scorecard
[0m09:20:02.117048 [debug] [MainThread]: Using redshift connection "master"
[0m09:20:02.117048 [debug] [MainThread]: On master: BEGIN
[0m09:20:02.118123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:20:02.119117 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:20:02.120044 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:20:02.368920 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:20:02.368920 [debug] [MainThread]: On master: COMMIT
[0m09:20:02.368920 [debug] [MainThread]: Using redshift connection "master"
[0m09:20:02.369921 [debug] [MainThread]: On master: COMMIT
[0m09:20:02.417666 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:20:02.418589 [debug] [MainThread]: On master: Close
[0m09:20:02.419674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:02.420662 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m09:20:02.421673 [debug] [MainThread]: Connection 'list_farm_nghi_dev' was properly closed.
[0m09:20:02.421673 [debug] [MainThread]: Connection 'model.sales_group.food_fi_scorecard' was properly closed.
[0m09:20:02.422661 [info ] [MainThread]: 
[0m09:20:02.423590 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.07 seconds (22.07s).
[0m09:20:02.425894 [debug] [MainThread]: Command end result
[0m09:20:02.475718 [info ] [MainThread]: 
[0m09:20:02.477718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:20:02.478745 [info ] [MainThread]: 
[0m09:20:02.480244 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:20:02.483768 [debug] [MainThread]: Command `dbt run` succeeded at 09:20:02.482785 after 22.83 seconds
[0m09:20:02.484773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A4FDEBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A7E6C4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A7E6C8B0>]}
[0m09:20:02.485809 [debug] [MainThread]: Flushing usage events
[0m09:21:19.574631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D6A6E250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D89C3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D89C36A0>]}


============================== 09:21:19.578711 | d79c36c2-35a9-4e5e-8ccb-b7f87cbd842a ==============================
[0m09:21:19.578711 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:21:19.579632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:21:19.749713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd79c36c2-35a9-4e5e-8ccb-b7f87cbd842a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D8C07430>]}
[0m09:21:19.764059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd79c36c2-35a9-4e5e-8ccb-b7f87cbd842a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D8CB7760>]}
[0m09:21:19.814229 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:21:20.138829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:21:20.139830 [debug] [MainThread]: Partial parsing: updated file: sales_group://models\food\marts\score_card\food_fi_scorecard.sql
[0m09:21:20.160264 [debug] [MainThread]: 1699: static parser successfully parsed food\marts\score_card\food_fi_scorecard.sql
[0m09:21:20.261494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd79c36c2-35a9-4e5e-8ccb-b7f87cbd842a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D92E5130>]}
[0m09:21:20.305669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd79c36c2-35a9-4e5e-8ccb-b7f87cbd842a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D8F1AF40>]}
[0m09:21:20.305669 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m09:21:20.306917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd79c36c2-35a9-4e5e-8ccb-b7f87cbd842a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D8F1AFD0>]}
[0m09:21:20.311834 [info ] [MainThread]: 
[0m09:21:20.312835 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m09:21:20.314986 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m09:21:20.328685 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m09:21:20.328685 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m09:21:20.328685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:20.329674 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:21:20.330675 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:21:20.881896 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m09:21:20.884902 [debug] [ThreadPool]: On list_food: Close
[0m09:21:20.900577 [debug] [ThreadPool]: Acquiring new redshift connection 'list_feed_nghi_dev'
[0m09:21:20.908193 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:21:20.908193 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m09:21:20.909189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:20.909189 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:21:20.909189 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:21:21.198428 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:21.199440 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:21:21.200787 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:21:21.291877 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:21.295949 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m09:21:21.366554 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m09:21:21.367624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_feed_nghi_dev, now list_tech_nghi_dev)
[0m09:21:21.371848 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:21:21.376836 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m09:21:21.376836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:21.376836 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:21:21.377845 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:21:21.696370 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:21.697367 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:21:21.697367 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:21:21.782697 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:21.783701 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m09:21:21.859063 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m09:21:21.860106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_food_nghi_dev)
[0m09:21:21.864276 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:21:21.868278 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m09:21:21.868278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:21.869267 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:21:21.869267 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:21:22.111983 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:22.111983 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:21:22.111983 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:21:22.188621 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:22.192619 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m09:21:22.253386 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m09:21:22.256361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_food_nghi_dev, now list_group_nghi_dev)
[0m09:21:22.261363 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:21:22.261363 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m09:21:22.262359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:22.262359 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:21:22.262359 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:21:22.575869 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:22.576870 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:21:22.576870 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:21:22.669764 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:22.671845 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m09:21:22.753726 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m09:21:22.755503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_group_nghi_dev, now list_farm_nghi_dev)
[0m09:21:22.764618 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:21:22.764618 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m09:21:22.764618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:22.765620 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:21:22.765620 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:21:23.071055 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:23.072079 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:21:23.073077 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:21:23.165780 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:23.170156 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m09:21:23.250904 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m09:21:23.278692 [debug] [MainThread]: Using redshift connection "master"
[0m09:21:23.279045 [debug] [MainThread]: On master: BEGIN
[0m09:21:23.279045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:21:23.279828 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:21:23.279828 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:21:23.566066 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:23.567029 [debug] [MainThread]: Using redshift connection "master"
[0m09:21:23.568093 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:21:23.709418 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:23.711418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd79c36c2-35a9-4e5e-8ccb-b7f87cbd842a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D5A2AC70>]}
[0m09:21:23.712900 [debug] [MainThread]: On master: ROLLBACK
[0m09:21:23.792569 [debug] [MainThread]: Using redshift connection "master"
[0m09:21:23.792569 [debug] [MainThread]: On master: BEGIN
[0m09:21:23.821694 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:23.821694 [debug] [MainThread]: On master: COMMIT
[0m09:21:23.822677 [debug] [MainThread]: Using redshift connection "master"
[0m09:21:23.822952 [debug] [MainThread]: On master: COMMIT
[0m09:21:23.883784 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:23.884924 [debug] [MainThread]: On master: Close
[0m09:21:23.885939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:21:23.887944 [info ] [MainThread]: 
[0m09:21:23.895938 [debug] [Thread-1  ]: Began running node model.sales_group.food_fi_scorecard
[0m09:21:23.895938 [info ] [Thread-1  ]: 1 of 1 START sql table model nghi_dev.fi_scorecard ............................. [RUN]
[0m09:21:23.897949 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_fi_scorecard'
[0m09:21:23.897949 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_fi_scorecard
[0m09:21:23.903031 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_fi_scorecard"
[0m09:21:23.907050 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (compile): 09:21:23.897949 => 09:21:23.906072
[0m09:21:23.907050 [debug] [Thread-1  ]: Began executing node model.sales_group.food_fi_scorecard
[0m09:21:23.959354 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_fi_scorecard"
[0m09:21:23.971321 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:21:23.971321 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m09:21:23.971321 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:21:23.972322 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:21:23.972322 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:21:24.208095 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:24.208095 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:21:24.209096 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: create  table
    "food"."nghi_dev"."fi_scorecard__dbt_tmp"
    
    
    
  as (
    select
    fi.cat_code,
    fi.cat_name,
    fi.subcat_1_code,
    fi.subcat_1_name,
    fi.subcat_2_code,
    fi.subcat_2_name,
    fi."G/L Account",
    case
        when fi."G/L Account" >= '0064100000' and fi."G/L Account" <= '0064199999' 
        then '01'
        when fi."G/L Account" >= '0064200000' and fi."G/L Account" <= '0064299999' 
        then '02'
        when (fi."G/L Account" >= '0062200000' and fi."G/L Account" <= '0062299999')
        or  (fi."G/L Account" >= '0062700000' and fi."G/L Account" <= '0062799999')
        then '03'
    end as expense_group_code,

    case when expense_group_code = '01'
        then 'CP bán hàng'
        when  expense_group_code = '02'
        then 'CP quản lý'
        when  expense_group_code = '03'
        then 'CP sản xuất'
    end as expense_group_name,
    fi.company_code,
    fi.posting_date,
    fi.channel_code,
    case when fi.channel_code = '98'
    then 'Khác'
    else cn.name end as channel_name,
    fi.matnr,
    '10' as value_type, 
    fi.fiscyearper,
    '' as kpi_code,
    '' as kpi_name,
    pl.pl_code, 
    pl.pl_name, 
    pl.pl_group_code, 
    pl.pl_group_name,
    fi.costcenter_code,
    ctxt.short_name as costcenter_name,
    ctxt.medium_name as costcenter_full_name,
    cc.costcenter_group_code,
    cc.costcenter_group_name,
    clh.hier_cost_element_name,
    clh.cost_element_code,
    fi.customer_code,
    fi.plant,
    fi.revenue,
    fi.quantity,
    fi."revenue(D/KG)",
    fi.cogs,
    fi."cogs(+)",
    fi."gross Contribution (3) =  (1) - (+)",
    fi."manufacturing cost (4)",
    fi."gross margin (5) = (3) - (4)",
    fi."mkt & Commercial Costs (6)",
    fi."administrative costs (7)",
    fi."chi phí tài chính(8)",
    fi."thu nhập tài chính(9)",
    fi."10-raw material",
    fi."20-packaging",
    fi."30-subcontract",
    fi."40-delivery cost sto",
    fi."51-emp.outsourcing",
    fi."52-consum&supplies",
    fi."53-energy& utilities",
    fi."59-other expenses",
    fi."61-wages",
    fi."62-other wages",
    fi."63-depreciation exp",
    fi."69-other expenses",
    fi."80-merchendise",
    fi."90-inter.profit"

from "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue" fi
left join "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" cn 
on fi.channel_code = cn.code

left join "food"."nghi_dev"."food_mapping_pl_plgroup" pl
on fi."G/L Account" = pl."G/L Account"

left join "food"."nghi_dev"."food_mapping_costcenter_costcentergroup" cc
on fi.costcenter_code = cc.costcenter_code

left join "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text" ctxt
on fi.costcenter_code = ctxt.code

left join "food"."nghi_dev"."food_mapping_hierarchies_costelement" clh
on fi."G/L Account" = clh.cost_element_code

union all

select
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    expense_group_code,
    expense_group_name,
    company_code,
    posting_date,
    channel_code,
    channel_name,
    matnr,
    value_type, 
    fiscyearper,
    kpi_code,
    kpi_name,
    pl_code, 
    pl_name, 
    pl_group_code, 
    pl_group_name,
    costcenter_code,
    costcenter_name,
    costcenter_full_name,
    costcenter_group_code,
    costcenter_group_name,
    '' as hier_cost_element_name,
    '' as cost_element_code,
    '' as customer_code,
    '' as plant,
    budget * 1000 as revenue, 
    quantity,
    "revenue(D/KG)",
    cogs,
    "cogs(+)",
    "gross Contribution (3) =  (1) - (+)",
    "manufacturing cost (4)",
    "gross margin (5) = (3) - (4)",
    "mkt & Commercial Costs (6)",
    "administrative costs (7)",
    "chi phí tài chính(8)",
    "thu nhập tài chính(9)",
    0 as "10-raw material",
    0 as "20-packaging",
    0 as "30-subcontract",
    0 as "40-delivery cost sto",
    0 as "51-emp.outsourcing",
    0 as "52-consum&supplies",
    0 as "53-energy& utilities",
    0 as "59-other expenses",
    0 as "61-wages",
    0 as "62-other wages",
    0 as "63-depreciation exp",
    0 as "69-other expenses",
    0 as "80-merchendise",
    0 as "90-inter.profit"

from "food"."nghi_dev"."kpi_budget"
  );
[0m09:21:42.365073 [debug] [Thread-1  ]: Redshift adapter: Redshift error: Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m09:21:42.366108 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: ROLLBACK
[0m09:21:42.417579 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (execute): 09:21:23.908043 => 09:21:42.417579
[0m09:21:42.418609 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: Close
[0m09:21:42.424658 [debug] [Thread-1  ]: Database Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)
  Specified types or functions (one per INFO message) not supported on Redshift tables.
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m09:21:42.425660 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd79c36c2-35a9-4e5e-8ccb-b7f87cbd842a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D98B5EB0>]}
[0m09:21:42.426588 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nghi_dev.fi_scorecard .................... [[31mERROR[0m in 18.53s]
[0m09:21:42.427666 [debug] [Thread-1  ]: Finished running node model.sales_group.food_fi_scorecard
[0m09:21:42.429583 [debug] [MainThread]: Using redshift connection "master"
[0m09:21:42.430616 [debug] [MainThread]: On master: BEGIN
[0m09:21:42.430616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:21:42.430616 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:21:42.431653 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:21:42.717605 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:42.718617 [debug] [MainThread]: On master: COMMIT
[0m09:21:42.718617 [debug] [MainThread]: Using redshift connection "master"
[0m09:21:42.718617 [debug] [MainThread]: On master: COMMIT
[0m09:21:42.776016 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:21:42.777487 [debug] [MainThread]: On master: Close
[0m09:21:42.778446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:42.778446 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m09:21:42.778446 [debug] [MainThread]: Connection 'list_farm_nghi_dev' was properly closed.
[0m09:21:42.779456 [debug] [MainThread]: Connection 'model.sales_group.food_fi_scorecard' was properly closed.
[0m09:21:42.779456 [info ] [MainThread]: 
[0m09:21:42.780444 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.47 seconds (22.47s).
[0m09:21:42.781468 [debug] [MainThread]: Command end result
[0m09:21:42.817854 [info ] [MainThread]: 
[0m09:21:42.819811 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:21:42.820811 [info ] [MainThread]: 
[0m09:21:42.820811 [error] [MainThread]: [33mDatabase Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)[0m
[0m09:21:42.822192 [error] [MainThread]:   Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m09:21:42.823318 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m09:21:42.823318 [info ] [MainThread]: 
[0m09:21:42.824318 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:21:42.825954 [debug] [MainThread]: Command `dbt run` failed at 09:21:42.825954 after 23.26 seconds
[0m09:21:42.826618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D6A6E250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D9685D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279D9685E50>]}
[0m09:21:42.827968 [debug] [MainThread]: Flushing usage events
[0m09:37:28.064174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F1F5BA580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F215136A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F21513640>]}


============================== 09:37:28.067174 | 1d59ef0c-4309-422d-a644-dcb6b0b2bbc9 ==============================
[0m09:37:28.067174 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:37:28.069165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:37:28.222995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d59ef0c-4309-422d-a644-dcb6b0b2bbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F2175C430>]}
[0m09:37:28.235436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d59ef0c-4309-422d-a644-dcb6b0b2bbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F21807760>]}
[0m09:37:28.273686 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:37:28.572462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:37:28.573414 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:37:28.588873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d59ef0c-4309-422d-a644-dcb6b0b2bbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F218A0970>]}
[0m09:37:28.629793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d59ef0c-4309-422d-a644-dcb6b0b2bbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F21A7B340>]}
[0m09:37:28.629793 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m09:37:28.630825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d59ef0c-4309-422d-a644-dcb6b0b2bbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F21A7B2B0>]}
[0m09:37:28.634864 [info ] [MainThread]: 
[0m09:37:28.636793 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m09:37:28.638843 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m09:37:28.692808 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m09:37:28.693808 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m09:37:28.693808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:28.695808 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:37:28.695808 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:37:29.345811 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m09:37:29.350122 [debug] [ThreadPool]: On list_food: Close
[0m09:37:29.367351 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food_nghi_dev'
[0m09:37:29.374352 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:37:29.374352 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m09:37:29.374352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:29.375352 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:37:29.375352 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:37:29.627324 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:29.629780 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m09:37:29.630783 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:37:29.711107 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:29.715180 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m09:37:29.779011 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m09:37:29.780009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_food_nghi_dev, now list_farm_nghi_dev)
[0m09:37:29.784476 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:37:29.785476 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m09:37:29.785476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:29.786476 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:37:29.786476 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:37:30.088036 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:30.088036 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m09:37:30.088036 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:37:30.179128 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:30.181170 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m09:37:30.253830 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m09:37:30.256823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_tech_nghi_dev)
[0m09:37:30.269110 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:37:30.269110 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m09:37:30.270139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:30.270139 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:37:30.270139 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:37:30.530423 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:30.530423 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m09:37:30.532345 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:37:30.613088 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:30.617085 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m09:37:30.679934 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m09:37:30.682869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_group_nghi_dev)
[0m09:37:30.696985 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:37:30.697988 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m09:37:30.697988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:30.698993 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:37:30.698993 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:37:30.974405 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:30.976416 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m09:37:30.976416 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:37:31.056606 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:31.060796 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m09:37:31.123610 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m09:37:31.126607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_group_nghi_dev, now list_feed_nghi_dev)
[0m09:37:31.131605 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:37:31.131605 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m09:37:31.131605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:31.131605 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:37:31.132605 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:37:31.429505 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:31.430574 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m09:37:31.431580 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m09:37:31.523560 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:31.526556 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m09:37:31.599641 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m09:37:31.630588 [debug] [MainThread]: Using redshift connection "master"
[0m09:37:31.630588 [debug] [MainThread]: On master: BEGIN
[0m09:37:31.631589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:31.631589 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:37:31.631589 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:37:31.916557 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:31.917557 [debug] [MainThread]: Using redshift connection "master"
[0m09:37:31.918557 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:37:32.048321 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:32.050324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d59ef0c-4309-422d-a644-dcb6b0b2bbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F22220460>]}
[0m09:37:32.050324 [debug] [MainThread]: On master: ROLLBACK
[0m09:37:32.132577 [debug] [MainThread]: Using redshift connection "master"
[0m09:37:32.132577 [debug] [MainThread]: On master: BEGIN
[0m09:37:32.163424 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:32.164422 [debug] [MainThread]: On master: COMMIT
[0m09:37:32.165422 [debug] [MainThread]: Using redshift connection "master"
[0m09:37:32.166422 [debug] [MainThread]: On master: COMMIT
[0m09:37:32.224363 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:32.225363 [debug] [MainThread]: On master: Close
[0m09:37:32.226364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:37:32.228364 [info ] [MainThread]: 
[0m09:37:32.235363 [debug] [Thread-1  ]: Began running node model.sales_group.food_fi_scorecard
[0m09:37:32.235363 [info ] [Thread-1  ]: 1 of 1 START sql table model nghi_dev.fi_scorecard ............................. [RUN]
[0m09:37:32.237362 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_fi_scorecard'
[0m09:37:32.237362 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_fi_scorecard
[0m09:37:32.244933 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_fi_scorecard"
[0m09:37:32.248919 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (compile): 09:37:32.237362 => 09:37:32.248004
[0m09:37:32.249952 [debug] [Thread-1  ]: Began executing node model.sales_group.food_fi_scorecard
[0m09:37:32.295329 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_fi_scorecard"
[0m09:37:32.307490 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:37:32.308567 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m09:37:32.308567 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:37:32.309565 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:37:32.310580 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:37:32.592660 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:32.593915 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m09:37:32.595313 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: create  table
    "food"."nghi_dev"."fi_scorecard__dbt_tmp"
    
    
    
  as (
    select
    fi.cat_code,
    fi.cat_name,
    fi.subcat_1_code,
    fi.subcat_1_name,
    fi.subcat_2_code,
    fi.subcat_2_name,
    fi."G/L Account",
    case
        when fi."G/L Account" >= '0064100000' and fi."G/L Account" <= '0064199999' 
        then '01'
        when fi."G/L Account" >= '0064200000' and fi."G/L Account" <= '0064299999' 
        then '02'
        when (fi."G/L Account" >= '0062200000' and fi."G/L Account" <= '0062299999')
        or  (fi."G/L Account" >= '0062700000' and fi."G/L Account" <= '0062799999')
        then '03'
    end as expense_group_code,

    case when expense_group_code = '01'
        then 'CP bán hàng'
        when  expense_group_code = '02'
        then 'CP quản lý'
        when  expense_group_code = '03'
        then 'CP sản xuất'
    end as expense_group_name,
    fi.company_code,
    fi.posting_date,
    fi.channel_code,
    case when fi.channel_code = '98'
    then 'Khác'
    else cn.name end as channel_name,
    fi.matnr,
    '10' as value_type, 
    fi.fiscyearper,
    '' as kpi_code,
    '' as kpi_name,
    pl.pl_code, 
    pl.pl_name, 
    pl.pl_group_code, 
    pl.pl_group_name,
    fi.costcenter_code,
    ctxt.short_name as costcenter_name,
    ctxt.medium_name as costcenter_full_name,
    cc.costcenter_group_code,
    cc.costcenter_group_name,
    clh.hier_cost_element_name,
    clh.cost_element_code,
    fi.customer_code,
    fi.plant,
    fi.revenue,
    fi.quantity,
    fi."revenue(D/KG)",
    fi.cogs,
    fi."cogs(+)",
    fi."gross Contribution (3) =  (1) - (+)",
    fi."manufacturing cost (4)",
    fi."gross margin (5) = (3) - (4)",
    fi."mkt & Commercial Costs (6)",
    fi."administrative costs (7)",
    fi."chi phí tài chính(8)",
    fi."thu nhập tài chính(9)",
    fi."10-raw material",
    fi."20-packaging",
    fi."30-subcontract",
    fi."40-delivery cost sto",
    fi."51-emp.outsourcing",
    fi."52-consum&supplies",
    fi."53-energy& utilities",
    fi."59-other expenses",
    fi."61-wages",
    fi."62-other wages",
    fi."63-depreciation exp",
    fi."69-other expenses",
    fi."80-merchendise",
    fi."90-inter.profit"

from "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue" fi
left join "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" cn 
on fi.channel_code = cn.code

left join "food"."nghi_dev"."food_mapping_pl_plgroup" pl
on fi."G/L Account" = pl."G/L Account"

left join "food"."nghi_dev"."food_mapping_costcenter_costcentergroup" cc
on fi.costcenter_code = cc.costcenter_code

left join "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text" ctxt
on fi.costcenter_code = ctxt.code

left join "food"."nghi_dev"."food_mapping_hierarchies_costelement" clh
on fi."G/L Account" = clh.cost_element_code

union all

select
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    expense_group_code,
    expense_group_name,
    company_code,
    posting_date,
    channel_code,
    channel_name,
    matnr,
    value_type, 
    fiscyearper,
    kpi_code,
    kpi_name,
    pl_code, 
    pl_name, 
    pl_group_code, 
    pl_group_name,
    costcenter_code,
    costcenter_name,
    costcenter_full_name,
    costcenter_group_code,
    costcenter_group_name,
    '' as hier_cost_element_name,
    '' as cost_element_code,
    '' as customer_code,
    '' as plant,
    budget * 1000 as revenue, 
    quantity,
    "revenue(D/KG)",
    cogs,
    "cogs(+)",
    "gross Contribution (3) =  (1) - (+)",
    "manufacturing cost (4)",
    "gross margin (5) = (3) - (4)",
    "mkt & Commercial Costs (6)",
    "administrative costs (7)",
    "chi phí tài chính(8)",
    "thu nhập tài chính(9)",
    0 as "10-raw material",
    0 as "20-packaging",
    0 as "30-subcontract",
    0 as "40-delivery cost sto",
    0 as "51-emp.outsourcing",
    0 as "52-consum&supplies",
    0 as "53-energy& utilities",
    0 as "59-other expenses",
    0 as "61-wages",
    0 as "62-other wages",
    0 as "63-depreciation exp",
    0 as "69-other expenses",
    0 as "80-merchendise",
    0 as "90-inter.profit"

from "food"."nghi_dev"."kpi_budget"
  );
[0m09:37:50.305665 [debug] [Thread-1  ]: Redshift adapter: Redshift error: Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m09:37:50.306674 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: ROLLBACK
[0m09:37:50.368167 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (execute): 09:37:32.249952 => 09:37:50.368167
[0m09:37:50.369290 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: Close
[0m09:37:50.371289 [debug] [Thread-1  ]: Database Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)
  Specified types or functions (one per INFO message) not supported on Redshift tables.
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m09:37:50.372288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d59ef0c-4309-422d-a644-dcb6b0b2bbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F223C4D90>]}
[0m09:37:50.372288 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nghi_dev.fi_scorecard .................... [[31mERROR[0m in 18.14s]
[0m09:37:50.373295 [debug] [Thread-1  ]: Finished running node model.sales_group.food_fi_scorecard
[0m09:37:50.375280 [debug] [MainThread]: Using redshift connection "master"
[0m09:37:50.375280 [debug] [MainThread]: On master: BEGIN
[0m09:37:50.376290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:37:50.376290 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:37:50.377288 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:37:50.635527 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:50.635613 [debug] [MainThread]: On master: COMMIT
[0m09:37:50.636647 [debug] [MainThread]: Using redshift connection "master"
[0m09:37:50.636647 [debug] [MainThread]: On master: COMMIT
[0m09:37:50.691825 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:37:50.692411 [debug] [MainThread]: On master: Close
[0m09:37:50.693438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:50.693438 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m09:37:50.693438 [debug] [MainThread]: Connection 'list_feed_nghi_dev' was properly closed.
[0m09:37:50.693438 [debug] [MainThread]: Connection 'model.sales_group.food_fi_scorecard' was properly closed.
[0m09:37:50.693438 [info ] [MainThread]: 
[0m09:37:50.694471 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.06 seconds (22.06s).
[0m09:37:50.695480 [debug] [MainThread]: Command end result
[0m09:37:50.729039 [info ] [MainThread]: 
[0m09:37:50.729967 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:37:50.729967 [info ] [MainThread]: 
[0m09:37:50.731042 [error] [MainThread]: [33mDatabase Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)[0m
[0m09:37:50.731042 [error] [MainThread]:   Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m09:37:50.732955 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m09:37:50.733862 [info ] [MainThread]: 
[0m09:37:50.735399 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:37:50.736400 [debug] [MainThread]: Command `dbt run` failed at 09:37:50.736400 after 22.68 seconds
[0m09:37:50.737399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F1F5BA580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F217F1BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F21A08F70>]}
[0m09:37:50.737399 [debug] [MainThread]: Flushing usage events
[0m10:24:35.946299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F28A4CBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2A9A36A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2A9A3730>]}


============================== 10:24:35.950416 | 9fa62094-5d1c-480c-8fa8-f3146e7e82ab ==============================
[0m10:24:35.950416 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:24:35.951259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:24:36.176654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fa62094-5d1c-480c-8fa8-f3146e7e82ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2AC8C550>]}
[0m10:24:36.191856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fa62094-5d1c-480c-8fa8-f3146e7e82ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F28CD1CD0>]}
[0m10:24:36.237702 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:24:36.611356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:36.611356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:36.628778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fa62094-5d1c-480c-8fa8-f3146e7e82ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2AD31FA0>]}
[0m10:24:36.667955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fa62094-5d1c-480c-8fa8-f3146e7e82ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2AEF8070>]}
[0m10:24:36.668974 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m10:24:36.669885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa62094-5d1c-480c-8fa8-f3146e7e82ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2AF0E3A0>]}
[0m10:24:36.674075 [info ] [MainThread]: 
[0m10:24:36.676073 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:24:36.678074 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m10:24:36.735061 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m10:24:36.736393 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m10:24:36.736393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:36.737392 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:24:36.738393 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:24:37.463509 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:24:37.465166 [debug] [ThreadPool]: On list_food: Close
[0m10:24:37.477408 [debug] [ThreadPool]: Acquiring new redshift connection 'list_farm_nghi_dev'
[0m10:24:37.485403 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m10:24:37.485403 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m10:24:37.485403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:37.486403 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:24:37.486403 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:24:37.791471 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:37.792472 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m10:24:37.792472 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:24:37.877819 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:37.879954 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m10:24:37.951425 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m10:24:37.952424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_food_nghi_dev)
[0m10:24:37.955506 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m10:24:37.960450 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m10:24:37.961449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:37.961449 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:24:37.961449 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:24:38.262137 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:38.262137 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m10:24:38.263082 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:24:38.349122 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:38.351123 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m10:24:38.431673 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m10:24:38.433675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_food_nghi_dev, now list_feed_nghi_dev)
[0m10:24:38.440675 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m10:24:38.441674 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m10:24:38.441674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:38.441674 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:24:38.442675 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:24:38.787543 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:38.788543 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m10:24:38.789546 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:24:38.888350 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:38.892358 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m10:24:38.973064 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m10:24:38.975064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_feed_nghi_dev, now list_tech_nghi_dev)
[0m10:24:38.980795 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m10:24:38.984715 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m10:24:38.985801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:38.985801 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:24:38.985801 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:24:39.264813 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:39.265817 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m10:24:39.265817 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:24:39.350971 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:39.353971 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m10:24:39.429351 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m10:24:39.430789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_group_nghi_dev)
[0m10:24:39.433788 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m10:24:39.433788 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m10:24:39.433788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:39.434788 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:24:39.434788 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:24:39.719937 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:39.720941 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m10:24:39.721941 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:24:39.807691 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:39.809768 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m10:24:39.878973 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m10:24:39.907140 [debug] [MainThread]: Using redshift connection "master"
[0m10:24:39.907140 [debug] [MainThread]: On master: BEGIN
[0m10:24:39.908140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:39.908140 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:24:39.908140 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:24:40.244989 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:40.245342 [debug] [MainThread]: Using redshift connection "master"
[0m10:24:40.245842 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:24:40.389716 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:40.390755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa62094-5d1c-480c-8fa8-f3146e7e82ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2AEAF460>]}
[0m10:24:40.391754 [debug] [MainThread]: On master: ROLLBACK
[0m10:24:40.477393 [debug] [MainThread]: Using redshift connection "master"
[0m10:24:40.478772 [debug] [MainThread]: On master: BEGIN
[0m10:24:40.512269 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:40.512269 [debug] [MainThread]: On master: COMMIT
[0m10:24:40.513275 [debug] [MainThread]: Using redshift connection "master"
[0m10:24:40.513275 [debug] [MainThread]: On master: COMMIT
[0m10:24:40.580068 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:40.580068 [debug] [MainThread]: On master: Close
[0m10:24:40.580982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:40.582020 [info ] [MainThread]: 
[0m10:24:40.591471 [debug] [Thread-1  ]: Began running node model.sales_group.food_fi_scorecard
[0m10:24:40.591471 [info ] [Thread-1  ]: 1 of 1 START sql table model nghi_dev.fi_scorecard ............................. [RUN]
[0m10:24:40.593471 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_fi_scorecard'
[0m10:24:40.593471 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_fi_scorecard
[0m10:24:40.599829 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_fi_scorecard"
[0m10:24:40.603738 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (compile): 10:24:40.593471 => 10:24:40.602937
[0m10:24:40.603738 [debug] [Thread-1  ]: Began executing node model.sales_group.food_fi_scorecard
[0m10:24:40.656970 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_fi_scorecard"
[0m10:24:40.671039 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m10:24:40.672036 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m10:24:40.672036 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:24:40.673037 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:24:40.673037 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:24:40.990740 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:40.991739 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m10:24:40.992739 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: create  table
    "food"."nghi_dev"."fi_scorecard__dbt_tmp"
    
    
    
  as (
    select
    fi.cat_code,
    fi.cat_name,
    fi.subcat_1_code,
    fi.subcat_1_name,
    fi.subcat_2_code,
    fi.subcat_2_name,
    fi."G/L Account",
    case
        when fi."G/L Account" >= '0064100000' and fi."G/L Account" <= '0064199999' 
        then '01'
        when fi."G/L Account" >= '0064200000' and fi."G/L Account" <= '0064299999' 
        then '02'
        when (fi."G/L Account" >= '0062200000' and fi."G/L Account" <= '0062299999')
        or  (fi."G/L Account" >= '0062700000' and fi."G/L Account" <= '0062799999')
        then '03'
    end as expense_group_code,

    case when expense_group_code = '01'
        then 'CP bán hàng'
        when  expense_group_code = '02'
        then 'CP quản lý'
        when  expense_group_code = '03'
        then 'CP sản xuất'
    end as expense_group_name,
    fi.company_code,
    fi.posting_date,
    fi.channel_code,
    case when fi.channel_code = '98'
    then 'Khác'
    else cn.name end as channel_name,
    fi.matnr,
    '10' as value_type, 
    fi.fiscyearper,
    '' as kpi_code,
    '' as kpi_name,
    pl.pl_code, 
    pl.pl_name, 
    pl.pl_group_code, 
    pl.pl_group_name,
    fi.costcenter_code,
    ctxt.short_name as costcenter_name,
    ctxt.medium_name as costcenter_full_name,
    cc.costcenter_group_code,
    cc.costcenter_group_name,
    clh.hier_cost_element_name,
    clh.cost_element_code,
    fi.customer_code,
    fi.plant,
    fi.revenue,
    fi.quantity,
    fi."revenue(D/KG)",
    fi.cogs,
    fi."cogs(+)",
    fi."gross Contribution (3) =  (1) - (+)",
    fi."manufacturing cost (4)",
    fi."gross margin (5) = (3) - (4)",
    fi."mkt & Commercial Costs (6)",
    fi."administrative costs (7)",
    fi."chi phí tài chính(8)",
    fi."thu nhập tài chính(9)",
    fi."10-raw material",
    fi."20-packaging",
    fi."30-subcontract",
    fi."40-delivery cost sto",
    fi."51-emp.outsourcing",
    fi."52-consum&supplies",
    fi."53-energy& utilities",
    fi."59-other expenses",
    fi."61-wages",
    fi."62-other wages",
    fi."63-depreciation exp",
    fi."69-other expenses",
    fi."80-merchendise",
    fi."90-inter.profit"

from "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue" fi
left join "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" cn 
on fi.channel_code = cn.code

left join "food"."nghi_dev"."food_mapping_pl_plgroup" pl
on fi."G/L Account" = pl."G/L Account"

left join "food"."nghi_dev"."food_mapping_costcenter_costcentergroup" cc
on fi.costcenter_code = cc.costcenter_code

left join "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text" ctxt
on fi.costcenter_code = ctxt.code

left join "food"."nghi_dev"."food_mapping_hierarchies_costelement" clh
on fi."G/L Account" = clh.cost_element_code

union all

select
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    expense_group_code,
    expense_group_name,
    company_code,
    posting_date,
    channel_code,
    channel_name,
    matnr,
    value_type, 
    fiscyearper,
    kpi_code,
    kpi_name,
    pl_code, 
    pl_name, 
    pl_group_code, 
    pl_group_name,
    costcenter_code,
    costcenter_name,
    costcenter_full_name,
    costcenter_group_code,
    costcenter_group_name,
    '' as hier_cost_element_name,
    '' as cost_element_code,
    '' as customer_code,
    '' as plant,
    budget * 1000 as revenue, 
    quantity,
    "revenue(D/KG)",
    cogs,
    "cogs(+)",
    "gross Contribution (3) =  (1) - (+)",
    "manufacturing cost (4)",
    "gross margin (5) = (3) - (4)",
    "mkt & Commercial Costs (6)",
    "administrative costs (7)",
    "chi phí tài chính(8)",
    "thu nhập tài chính(9)",
    0 as "10-raw material",
    0 as "20-packaging",
    0 as "30-subcontract",
    0 as "40-delivery cost sto",
    0 as "51-emp.outsourcing",
    0 as "52-consum&supplies",
    0 as "53-energy& utilities",
    0 as "59-other expenses",
    0 as "61-wages",
    0 as "62-other wages",
    0 as "63-depreciation exp",
    0 as "69-other expenses",
    0 as "80-merchendise",
    0 as "90-inter.profit"

from "food"."nghi_dev"."kpi_budget"
  );
[0m10:24:58.687755 [debug] [Thread-1  ]: Redshift adapter: Redshift error: Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m10:24:58.689140 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: ROLLBACK
[0m10:24:58.756735 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (execute): 10:24:40.605161 => 10:24:58.756236
[0m10:24:58.757318 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: Close
[0m10:24:58.763336 [debug] [Thread-1  ]: Database Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)
  Specified types or functions (one per INFO message) not supported on Redshift tables.
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m10:24:58.764339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa62094-5d1c-480c-8fa8-f3146e7e82ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2B855D60>]}
[0m10:24:58.765337 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nghi_dev.fi_scorecard .................... [[31mERROR[0m in 18.17s]
[0m10:24:58.766337 [debug] [Thread-1  ]: Finished running node model.sales_group.food_fi_scorecard
[0m10:24:58.768336 [debug] [MainThread]: Using redshift connection "master"
[0m10:24:58.768336 [debug] [MainThread]: On master: BEGIN
[0m10:24:58.769336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:58.769336 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:24:58.770336 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:24:59.057628 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:59.058710 [debug] [MainThread]: On master: COMMIT
[0m10:24:59.059712 [debug] [MainThread]: Using redshift connection "master"
[0m10:24:59.059712 [debug] [MainThread]: On master: COMMIT
[0m10:24:59.125550 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:24:59.126636 [debug] [MainThread]: On master: Close
[0m10:24:59.128631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:59.128631 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m10:24:59.129562 [debug] [MainThread]: Connection 'list_group_nghi_dev' was properly closed.
[0m10:24:59.129562 [debug] [MainThread]: Connection 'model.sales_group.food_fi_scorecard' was properly closed.
[0m10:24:59.130634 [info ] [MainThread]: 
[0m10:24:59.131634 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.46 seconds (22.46s).
[0m10:24:59.133566 [debug] [MainThread]: Command end result
[0m10:24:59.186918 [info ] [MainThread]: 
[0m10:24:59.187938 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:24:59.189580 [info ] [MainThread]: 
[0m10:24:59.190598 [error] [MainThread]: [33mDatabase Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)[0m
[0m10:24:59.192135 [error] [MainThread]:   Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m10:24:59.194267 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m10:24:59.196166 [info ] [MainThread]: 
[0m10:24:59.197160 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:24:59.198160 [debug] [MainThread]: Command `dbt run` failed at 10:24:59.198160 after 23.27 seconds
[0m10:24:59.198160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F28A4CBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2B82DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2AF35B50>]}
[0m10:24:59.199160 [debug] [MainThread]: Flushing usage events
[0m10:37:45.978391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002429487E7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242967D3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242967D36D0>]}


============================== 10:37:45.981391 | d6f77e80-1be8-4156-b2eb-9ec4fe148bcc ==============================
[0m10:37:45.981391 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:37:45.982288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:37:46.126761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6f77e80-1be8-4156-b2eb-9ec4fe148bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024296ABA550>]}
[0m10:37:46.138833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6f77e80-1be8-4156-b2eb-9ec4fe148bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024294B02CD0>]}
[0m10:37:46.175252 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:37:46.448323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:46.448323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:46.464571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6f77e80-1be8-4156-b2eb-9ec4fe148bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024296B60FA0>]}
[0m10:37:46.507217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6f77e80-1be8-4156-b2eb-9ec4fe148bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024296D25070>]}
[0m10:37:46.507217 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m10:37:46.508240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6f77e80-1be8-4156-b2eb-9ec4fe148bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024296D3B3A0>]}
[0m10:37:46.512321 [info ] [MainThread]: 
[0m10:37:46.513297 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:37:46.515189 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m10:37:46.560746 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m10:37:46.560746 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m10:37:46.560746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:46.562740 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:37:46.562740 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:37:47.130349 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:37:47.134359 [debug] [ThreadPool]: On list_food: Close
[0m10:37:47.145501 [debug] [ThreadPool]: Acquiring new redshift connection 'list_tech_nghi_dev'
[0m10:37:47.152504 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m10:37:47.152504 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m10:37:47.153503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:47.153503 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:37:47.154589 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:37:47.436272 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:47.437586 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m10:37:47.438905 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:37:47.515394 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:47.520405 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m10:37:47.581931 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m10:37:47.584945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_food_nghi_dev)
[0m10:37:47.600041 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m10:37:47.600041 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m10:37:47.600041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:47.601146 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:37:47.601146 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:37:47.883567 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:47.883567 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m10:37:47.884641 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:37:47.967362 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:47.971447 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m10:37:48.046016 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m10:37:48.048031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_food_nghi_dev, now list_farm_nghi_dev)
[0m10:37:48.053805 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m10:37:48.053805 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m10:37:48.054949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:48.054949 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:37:48.054949 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:37:48.339320 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:48.340405 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m10:37:48.341411 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:37:48.434627 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:48.438697 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m10:37:48.511706 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m10:37:48.514795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_group_nghi_dev)
[0m10:37:48.522660 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m10:37:48.522660 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m10:37:48.522660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:48.523660 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:37:48.523660 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:37:48.843244 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:48.844305 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m10:37:48.845337 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:37:48.932314 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:48.935500 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m10:37:49.007799 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m10:37:49.008798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_group_nghi_dev, now list_feed_nghi_dev)
[0m10:37:49.011798 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m10:37:49.012798 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m10:37:49.012798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:49.012798 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:37:49.013798 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:37:49.341769 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:49.342823 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m10:37:49.343850 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:37:49.447769 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:49.450853 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m10:37:49.532114 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m10:37:49.564473 [debug] [MainThread]: Using redshift connection "master"
[0m10:37:49.564473 [debug] [MainThread]: On master: BEGIN
[0m10:37:49.564473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:49.565473 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:37:49.565473 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:37:49.858105 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:49.859124 [debug] [MainThread]: Using redshift connection "master"
[0m10:37:49.860196 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:37:49.993031 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:49.997206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6f77e80-1be8-4156-b2eb-9ec4fe148bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024296CDF460>]}
[0m10:37:49.997206 [debug] [MainThread]: On master: ROLLBACK
[0m10:37:50.075355 [debug] [MainThread]: Using redshift connection "master"
[0m10:37:50.076440 [debug] [MainThread]: On master: BEGIN
[0m10:37:50.107155 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:50.108243 [debug] [MainThread]: On master: COMMIT
[0m10:37:50.109240 [debug] [MainThread]: Using redshift connection "master"
[0m10:37:50.110240 [debug] [MainThread]: On master: COMMIT
[0m10:37:50.169348 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:50.170445 [debug] [MainThread]: On master: Close
[0m10:37:50.172432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:37:50.173828 [info ] [MainThread]: 
[0m10:37:50.178917 [debug] [Thread-1  ]: Began running node model.sales_group.food_fi_scorecard
[0m10:37:50.179993 [info ] [Thread-1  ]: 1 of 1 START sql table model nghi_dev.fi_scorecard ............................. [RUN]
[0m10:37:50.181010 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_fi_scorecard'
[0m10:37:50.181010 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_fi_scorecard
[0m10:37:50.187832 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_fi_scorecard"
[0m10:37:50.190565 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (compile): 10:37:50.181996 => 10:37:50.190565
[0m10:37:50.190565 [debug] [Thread-1  ]: Began executing node model.sales_group.food_fi_scorecard
[0m10:37:50.233555 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_fi_scorecard"
[0m10:37:50.246601 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m10:37:50.246601 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m10:37:50.246601 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:37:50.247653 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:37:50.247653 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:37:50.527379 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m10:37:50.528481 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m10:37:50.530463 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: create  table
    "food"."nghi_dev"."fi_scorecard__dbt_tmp"
    
    
    
  as (
    select
    fi.cat_code,
    fi.cat_name,
    fi.subcat_1_code,
    fi.subcat_1_name,
    fi.subcat_2_code,
    fi.subcat_2_name,
    fi."G/L Account",
    case
        when fi."G/L Account" >= '0064100000' and fi."G/L Account" <= '0064199999' 
        then '01'
        when fi."G/L Account" >= '0064200000' and fi."G/L Account" <= '0064299999' 
        then '02'
        when (fi."G/L Account" >= '0062200000' and fi."G/L Account" <= '0062299999')
        or  (fi."G/L Account" >= '0062700000' and fi."G/L Account" <= '0062799999')
        then '03'
    end as expense_group_code,

    case when expense_group_code = '01'
        then 'CP bán hàng'
        when  expense_group_code = '02'
        then 'CP quản lý'
        when  expense_group_code = '03'
        then 'CP sản xuất'
    end as expense_group_name,
    fi.company_code,
    fi.posting_date,
    fi.channel_code,
    case when fi.channel_code = '98'
    then 'Khác'
    else cn.name end as channel_name,
    fi.matnr,
    '10' as value_type, 
    fi.fiscyearper,
    '' as kpi_code,
    '' as kpi_name,
    pl.pl_code, 
    pl.pl_name, 
    pl.pl_group_code, 
    pl.pl_group_name,
    fi.costcenter_code,
    ctxt.short_name as costcenter_name,
    ctxt.medium_name as costcenter_full_name,
    cc.costcenter_group_code,
    cc.costcenter_group_name,
    clh.hier_cost_element_name,
    clh.cost_element_code,
    fi.customer_code,
    fi.plant,
    fi.revenue,
    fi.quantity,
    fi."revenue(D/KG)",
    fi.cogs,
    fi."cogs(+)",
    fi."gross Contribution (3) =  (1) - (+)",
    fi."manufacturing cost (4)",
    fi."gross margin (5) = (3) - (4)",
    fi."mkt & Commercial Costs (6)",
    fi."administrative costs (7)",
    fi."chi phí tài chính(8)",
    fi."thu nhập tài chính(9)",
    fi."10-raw material",
    fi."20-packaging",
    fi."30-subcontract",
    fi."40-delivery cost sto",
    fi."51-emp.outsourcing",
    fi."52-consum&supplies",
    fi."53-energy& utilities",
    fi."59-other expenses",
    fi."61-wages",
    fi."62-other wages",
    fi."63-depreciation exp",
    fi."69-other expenses",
    fi."80-merchendise",
    fi."90-inter.profit"

from "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue" fi
left join "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" cn 
on fi.channel_code = cn.code

left join "food"."nghi_dev"."food_mapping_pl_plgroup" pl
on fi."G/L Account" = pl."G/L Account"

left join "food"."nghi_dev"."food_mapping_costcenter_costcentergroup" cc
on fi.costcenter_code = cc.costcenter_code

left join "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text" ctxt
on fi.costcenter_code = ctxt.code

left join "food"."nghi_dev"."food_mapping_hierarchies_costelement" clh
on fi."G/L Account" = clh.cost_element_code

union all

select
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    expense_group_code,
    expense_group_name,
    company_code,
    posting_date,
    channel_code,
    channel_name,
    matnr,
    value_type, 
    fiscyearper,
    kpi_code,
    kpi_name,
    pl_code, 
    pl_name, 
    pl_group_code, 
    pl_group_name,
    costcenter_code,
    costcenter_name,
    costcenter_full_name,
    costcenter_group_code,
    costcenter_group_name,
    '' as hier_cost_element_name,
    '' as cost_element_code,
    '' as customer_code,
    '' as plant,
    budget * 1000 as revenue, 
    quantity,
    "revenue(D/KG)",
    cogs,
    "cogs(+)",
    "gross Contribution (3) =  (1) - (+)",
    "manufacturing cost (4)",
    "gross margin (5) = (3) - (4)",
    "mkt & Commercial Costs (6)",
    "administrative costs (7)",
    "chi phí tài chính(8)",
    "thu nhập tài chính(9)",
    0 as "10-raw material",
    0 as "20-packaging",
    0 as "30-subcontract",
    0 as "40-delivery cost sto",
    0 as "51-emp.outsourcing",
    0 as "52-consum&supplies",
    0 as "53-energy& utilities",
    0 as "59-other expenses",
    0 as "61-wages",
    0 as "62-other wages",
    0 as "63-depreciation exp",
    0 as "69-other expenses",
    0 as "80-merchendise",
    0 as "90-inter.profit"

from "food"."nghi_dev"."kpi_budget"
  );
[0m10:38:08.948486 [debug] [Thread-1  ]: Redshift adapter: Redshift error: Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m10:38:08.948486 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: ROLLBACK
[0m10:38:08.998251 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (execute): 10:37:50.191567 => 10:38:08.998251
[0m10:38:08.999164 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: Close
[0m10:38:09.001164 [debug] [Thread-1  ]: Database Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)
  Specified types or functions (one per INFO message) not supported on Redshift tables.
  compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m10:38:09.002165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f77e80-1be8-4156-b2eb-9ec4fe148bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024296CC8070>]}
[0m10:38:09.002165 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nghi_dev.fi_scorecard .................... [[31mERROR[0m in 18.82s]
[0m10:38:09.003164 [debug] [Thread-1  ]: Finished running node model.sales_group.food_fi_scorecard
[0m10:38:09.004164 [debug] [MainThread]: Using redshift connection "master"
[0m10:38:09.005164 [debug] [MainThread]: On master: BEGIN
[0m10:38:09.005164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:09.005164 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:38:09.005164 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:38:09.287885 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:38:09.288877 [debug] [MainThread]: On master: COMMIT
[0m10:38:09.288877 [debug] [MainThread]: Using redshift connection "master"
[0m10:38:09.289876 [debug] [MainThread]: On master: COMMIT
[0m10:38:09.349075 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:38:09.350071 [debug] [MainThread]: On master: Close
[0m10:38:09.352072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:09.352072 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m10:38:09.353071 [debug] [MainThread]: Connection 'list_feed_nghi_dev' was properly closed.
[0m10:38:09.353071 [debug] [MainThread]: Connection 'model.sales_group.food_fi_scorecard' was properly closed.
[0m10:38:09.353071 [info ] [MainThread]: 
[0m10:38:09.354306 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.84 seconds (22.84s).
[0m10:38:09.355174 [debug] [MainThread]: Command end result
[0m10:38:09.386839 [info ] [MainThread]: 
[0m10:38:09.388828 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:38:09.389873 [info ] [MainThread]: 
[0m10:38:09.390860 [error] [MainThread]: [33mDatabase Error in model food_fi_scorecard (models\food\marts\score_card\food_fi_scorecard.sql)[0m
[0m10:38:09.391680 [error] [MainThread]:   Specified types or functions (one per INFO message) not supported on Redshift tables.
[0m10:38:09.392386 [error] [MainThread]:   compiled Code at target\run\sales_group\models\food\marts\score_card\food_fi_scorecard.sql
[0m10:38:09.392386 [info ] [MainThread]: 
[0m10:38:09.393387 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:38:09.394436 [debug] [MainThread]: Command `dbt run` failed at 10:38:09.394436 after 23.42 seconds
[0m10:38:09.394436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002429487E7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024296D748E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024296CCDF70>]}
[0m10:38:09.395556 [debug] [MainThread]: Flushing usage events
[0m10:58:38.796059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA80CABBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA82BF36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA82BF36A0>]}


============================== 10:58:38.798059 | 287a8e8e-764e-4dd9-8790-74fc9294cc76 ==============================
[0m10:58:38.798059 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:58:38.799019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:58:38.948321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '287a8e8e-764e-4dd9-8790-74fc9294cc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA82E3B520>]}
[0m10:58:38.960320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '287a8e8e-764e-4dd9-8790-74fc9294cc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA82F02160>]}
[0m10:58:38.999815 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:58:39.273699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:58:39.275699 [debug] [MainThread]: Partial parsing: updated file: sales_group://models\food\staging\sap_s4\food_stg_sap_s4__fi_0fi_acdoca_10.sql
[0m10:58:39.294284 [debug] [MainThread]: 1603: static parser failed on food\staging\sap_s4\food_stg_sap_s4__fi_0fi_acdoca_10.sql
[0m10:58:39.315477 [debug] [MainThread]: 1602: parser fallback to jinja rendering on food\staging\sap_s4\food_stg_sap_s4__fi_0fi_acdoca_10.sql
[0m10:58:39.348654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '287a8e8e-764e-4dd9-8790-74fc9294cc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA83A790D0>]}
[0m10:58:39.415361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '287a8e8e-764e-4dd9-8790-74fc9294cc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA82C73D30>]}
[0m10:58:39.415361 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m10:58:39.416210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '287a8e8e-764e-4dd9-8790-74fc9294cc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA82C73A00>]}
[0m10:58:39.420221 [info ] [MainThread]: 
[0m10:58:39.421228 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:58:39.423428 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m10:58:39.433688 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m10:58:39.434609 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m10:58:39.434609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:39.436688 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:39.437681 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:39.972712 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:58:39.973760 [debug] [ThreadPool]: On list_food: Close
[0m10:58:39.984848 [debug] [ThreadPool]: Acquiring new redshift connection 'list_group_nghi_dev'
[0m10:58:39.992422 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m10:58:39.992422 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m10:58:39.993392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:39.993392 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:39.994118 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:40.310416 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:40.311516 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m10:58:40.312567 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:58:40.405874 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:40.409878 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m10:58:40.483845 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m10:58:40.486577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_group_nghi_dev, now list_tech_nghi_dev)
[0m10:58:40.489573 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m10:58:40.490573 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m10:58:40.490573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:40.490573 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:40.490573 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:40.828902 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:40.828902 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m10:58:40.828902 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:58:40.914247 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:40.916327 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m10:58:40.987764 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m10:58:40.989844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_farm_nghi_dev)
[0m10:58:41.000885 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m10:58:41.000885 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m10:58:41.000885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:41.001885 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:41.001885 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:41.305417 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:41.306505 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m10:58:41.307501 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:58:41.394936 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:41.399006 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m10:58:41.470758 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m10:58:41.473842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_food_nghi_dev)
[0m10:58:41.482253 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m10:58:41.483252 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m10:58:41.483252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:41.483252 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:41.484253 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:41.788736 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:41.789827 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m10:58:41.790747 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:58:41.884568 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:41.886581 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m10:58:41.961797 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m10:58:41.964798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_food_nghi_dev, now list_feed_nghi_dev)
[0m10:58:41.970786 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m10:58:41.970786 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m10:58:41.971784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:41.971784 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:41.972788 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:42.301159 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:42.302253 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m10:58:42.303238 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m10:58:42.400357 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:42.405444 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m10:58:42.486190 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m10:58:42.489200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:42.490921 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m10:58:42.490953 [debug] [MainThread]: Connection 'list_feed_nghi_dev' was properly closed.
[0m10:58:42.491977 [info ] [MainThread]: 
[0m10:58:42.493398 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m10:58:42.494827 [error] [MainThread]: Encountered an error:

[0m10:58:42.501884 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\adapters\base\impl.py", line 435, in _relations_cache_for_schemas
    for future in as_completed(futures):
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\concurrent\futures\_base.py", line 245, in as_completed
    waiter.event.wait(wait_timeout)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\threading.py", line 574, in wait
    signaled = self._cond.wait(timeout)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\threading.py", line 312, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\requires.py", line 250, in wrapper
    return func(*args, **kwargs)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\cli\main.py", line 565, in run
    results = task.run()
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\runnable.py", line 403, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\task\runnable.py", line 381, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\adapters\base\impl.py", line 461, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\adapters\redshift\impl.py", line 150, in _relations_cache_for_schemas
    super()._relations_cache_for_schemas(manifest, cache_schemas)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\site-packages\dbt\adapters\base\impl.py", line 439, in _relations_cache_for_schemas
    self.cache.add(relation)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\concurrent\futures\_base.py", line 628, in __exit__
    self.shutdown(wait=True)
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\concurrent\futures\thread.py", line 229, in shutdown
    t.join()
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\threading.py", line 1029, in join
    self._wait_for_tstate_lock()
  File "c:\users\nghi.tc\appdata\local\microsoft\windowsapps\python\python39\lib\threading.py", line 1045, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt

[0m10:58:42.510963 [debug] [MainThread]: Command `dbt run` failed at 10:58:42.510963 after 3.72 seconds
[0m10:58:42.511962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA80CABBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA82EE1EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA83B01190>]}
[0m10:58:42.511962 [debug] [MainThread]: Flushing usage events
[0m11:00:17.812261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E331BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E5274730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E52746A0>]}


============================== 11:00:17.815261 | 186b0939-7459-4e92-bc25-8b0a8199e0dc ==============================
[0m11:00:17.815261 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:00:17.816261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\DWHTEAM\\sales-group\\logs', 'profiles_dir': 'D:\\DWHTEAM\\sales-group', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:00:17.969885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E4F1E2B0>]}
[0m11:00:17.980884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E55629D0>]}
[0m11:00:18.020926 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:00:18.323410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:18.324360 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:18.340055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E5600FA0>]}
[0m11:00:18.378695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E2222070>]}
[0m11:00:18.378695 [info ] [MainThread]: Found 230 models, 8 tests, 0 snapshots, 0 analyses, 707 macros, 0 operations, 30 seed files, 101 sources, 0 exposures, 0 metrics, 0 groups
[0m11:00:18.379695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E2231430>]}
[0m11:00:18.383694 [info ] [MainThread]: 
[0m11:00:18.384755 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:00:18.386955 [debug] [ThreadPool]: Acquiring new redshift connection 'list_food'
[0m11:00:18.433225 [debug] [ThreadPool]: Using redshift connection "list_food"
[0m11:00:18.434225 [debug] [ThreadPool]: On list_food: select distinct nspname from pg_namespace
[0m11:00:18.434225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:18.435234 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:18.436223 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:19.087287 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:19.091647 [debug] [ThreadPool]: On list_food: Close
[0m11:00:19.103407 [debug] [ThreadPool]: Acquiring new redshift connection 'list_farm_nghi_dev'
[0m11:00:19.110671 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m11:00:19.110671 [debug] [ThreadPool]: On list_farm_nghi_dev: BEGIN
[0m11:00:19.110671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:19.111597 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:19.111597 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:19.412306 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:19.413318 [debug] [ThreadPool]: Using redshift connection "list_farm_nghi_dev"
[0m11:00:19.414320 [debug] [ThreadPool]: On list_farm_nghi_dev: select
      'farm' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'farm' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m11:00:19.500494 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:19.503012 [debug] [ThreadPool]: On list_farm_nghi_dev: ROLLBACK
[0m11:00:19.623429 [debug] [ThreadPool]: On list_farm_nghi_dev: Close
[0m11:00:19.625197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_farm_nghi_dev, now list_food_nghi_dev)
[0m11:00:19.634848 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m11:00:19.636084 [debug] [ThreadPool]: On list_food_nghi_dev: BEGIN
[0m11:00:19.636808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:19.637586 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:19.637586 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:19.959980 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:19.961000 [debug] [ThreadPool]: Using redshift connection "list_food_nghi_dev"
[0m11:00:19.961000 [debug] [ThreadPool]: On list_food_nghi_dev: select
      'food' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'food' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m11:00:20.051728 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:20.053798 [debug] [ThreadPool]: On list_food_nghi_dev: ROLLBACK
[0m11:00:20.153725 [debug] [ThreadPool]: On list_food_nghi_dev: Close
[0m11:00:20.156737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_food_nghi_dev, now list_feed_nghi_dev)
[0m11:00:20.169449 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m11:00:20.170546 [debug] [ThreadPool]: On list_feed_nghi_dev: BEGIN
[0m11:00:20.170546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:20.170546 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:20.171478 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:20.499967 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:20.501025 [debug] [ThreadPool]: Using redshift connection "list_feed_nghi_dev"
[0m11:00:20.502068 [debug] [ThreadPool]: On list_feed_nghi_dev: select
      'feed' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'feed' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m11:00:20.612437 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:20.614521 [debug] [ThreadPool]: On list_feed_nghi_dev: ROLLBACK
[0m11:00:20.686507 [debug] [ThreadPool]: On list_feed_nghi_dev: Close
[0m11:00:20.687150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_feed_nghi_dev, now list_tech_nghi_dev)
[0m11:00:20.695742 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m11:00:20.695742 [debug] [ThreadPool]: On list_tech_nghi_dev: BEGIN
[0m11:00:20.696771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:20.696771 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:20.696771 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:21.000198 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:21.001198 [debug] [ThreadPool]: Using redshift connection "list_tech_nghi_dev"
[0m11:00:21.001198 [debug] [ThreadPool]: On list_tech_nghi_dev: select
      'tech' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'tech' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m11:00:21.090633 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:21.093656 [debug] [ThreadPool]: On list_tech_nghi_dev: ROLLBACK
[0m11:00:21.165005 [debug] [ThreadPool]: On list_tech_nghi_dev: Close
[0m11:00:21.165615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tech_nghi_dev, now list_group_nghi_dev)
[0m11:00:21.170603 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m11:00:21.171709 [debug] [ThreadPool]: On list_group_nghi_dev: BEGIN
[0m11:00:21.176174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:21.176174 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:21.176174 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:21.506785 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:21.506785 [debug] [ThreadPool]: Using redshift connection "list_group_nghi_dev"
[0m11:00:21.507879 [debug] [ThreadPool]: On list_group_nghi_dev: select
      'group' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'nghi_dev'
    union all
    select
      'group' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'nghi_dev'
[0m11:00:21.602133 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:21.606208 [debug] [ThreadPool]: On list_group_nghi_dev: ROLLBACK
[0m11:00:21.689360 [debug] [ThreadPool]: On list_group_nghi_dev: Close
[0m11:00:21.723598 [debug] [MainThread]: Using redshift connection "master"
[0m11:00:21.724598 [debug] [MainThread]: On master: BEGIN
[0m11:00:21.724598 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:21.725616 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:21.725616 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:22.050588 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:22.052590 [debug] [MainThread]: Using redshift connection "master"
[0m11:00:22.053313 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:22.186697 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:22.188697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E5F83460>]}
[0m11:00:22.189697 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:22.265278 [debug] [MainThread]: Using redshift connection "master"
[0m11:00:22.266292 [debug] [MainThread]: On master: BEGIN
[0m11:00:22.297479 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:22.298570 [debug] [MainThread]: On master: COMMIT
[0m11:00:22.298570 [debug] [MainThread]: Using redshift connection "master"
[0m11:00:22.299571 [debug] [MainThread]: On master: COMMIT
[0m11:00:22.363048 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:22.364061 [debug] [MainThread]: On master: Close
[0m11:00:22.366060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:22.367060 [info ] [MainThread]: 
[0m11:00:22.377888 [debug] [Thread-1  ]: Began running node model.sales_group.food_mapping_costcenter_costcentergroup
[0m11:00:22.378891 [info ] [Thread-1  ]: 1 of 10 START sql table model nghi_dev.food_mapping_costcenter_costcentergroup . [RUN]
[0m11:00:22.379597 [debug] [Thread-1  ]: Acquiring new redshift connection 'model.sales_group.food_mapping_costcenter_costcentergroup'
[0m11:00:22.380599 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_mapping_costcenter_costcentergroup
[0m11:00:22.383796 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:22.386522 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_costcenter_costcentergroup (compile): 11:00:22.380599 => 11:00:22.385248
[0m11:00:22.386522 [debug] [Thread-1  ]: Began executing node model.sales_group.food_mapping_costcenter_costcentergroup
[0m11:00:22.431331 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:22.436599 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:22.437050 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: BEGIN
[0m11:00:22.437050 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:00:22.438137 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:22.438137 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:22.758047 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:22.759127 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:22.760128 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: create  table
    "food"."nghi_dev"."food_mapping_costcenter_costcentergroup__dbt_tmp"
    
    
    
  as (
    select 
cost_center as costcenter_code, 
cost_center_name as costcenter_name, 
cc_group as costcenter_group_code, 
cc_group_name as  costcenter_group_name
from "food"."nghi_dev"."food_seed_scorecard_mapping_cost_center_ccgroup"
  );
[0m11:00:22.874931 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:22.886338 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:22.887340 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: alter table "food"."nghi_dev"."food_mapping_costcenter_costcentergroup" rename to "food_mapping_costcenter_costcentergroup__dbt_backup"
[0m11:00:23.087373 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:23.093468 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:23.093468 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: alter table "food"."nghi_dev"."food_mapping_costcenter_costcentergroup__dbt_tmp" rename to "food_mapping_costcenter_costcentergroup"
[0m11:00:23.195892 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:23.216536 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: COMMIT
[0m11:00:23.217536 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:23.217536 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: COMMIT
[0m11:00:23.968440 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:23.970438 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:23.970438 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: BEGIN
[0m11:00:24.043825 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:24.051750 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:24.052250 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: drop table if exists "food"."nghi_dev"."food_mapping_costcenter_costcentergroup__dbt_backup" cascade
[0m11:00:24.126664 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:24.128761 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: COMMIT
[0m11:00:24.129747 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:24.129747 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: COMMIT
[0m11:00:24.625618 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:24.627706 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_costcenter_costcentergroup"
[0m11:00:24.627706 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: BEGIN
[0m11:00:24.662873 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:24.665970 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_costcenter_costcentergroup (execute): 11:00:22.386522 => 11:00:24.664957
[0m11:00:24.666959 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: ROLLBACK
[0m11:00:24.735129 [debug] [Thread-1  ]: On model.sales_group.food_mapping_costcenter_costcentergroup: Close
[0m11:00:24.738165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E6129F70>]}
[0m11:00:24.739165 [info ] [Thread-1  ]: 1 of 10 OK created sql table model nghi_dev.food_mapping_costcenter_costcentergroup  [[32mSUCCESS[0m in 2.36s]
[0m11:00:24.741093 [debug] [Thread-1  ]: Finished running node model.sales_group.food_mapping_costcenter_costcentergroup
[0m11:00:24.742132 [debug] [Thread-1  ]: Began running node model.sales_group.food_mapping_hierarchies_costelement
[0m11:00:24.742132 [info ] [Thread-1  ]: 2 of 10 START sql table model nghi_dev.food_mapping_hierarchies_costelement .... [RUN]
[0m11:00:24.743160 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_mapping_costcenter_costcentergroup, now model.sales_group.food_mapping_hierarchies_costelement)
[0m11:00:24.743160 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_mapping_hierarchies_costelement
[0m11:00:24.746781 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:24.748239 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_hierarchies_costelement (compile): 11:00:24.743160 => 11:00:24.748239
[0m11:00:24.749241 [debug] [Thread-1  ]: Began executing node model.sales_group.food_mapping_hierarchies_costelement
[0m11:00:24.756058 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:24.758068 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:24.759151 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: BEGIN
[0m11:00:24.759151 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:00:24.760063 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:24.760063 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:25.091214 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:25.092218 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:25.092218 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: create  table
    "food"."nghi_dev"."food_mapping_hierarchies_costelement__dbt_tmp"
    
    
    
  as (
    select
    hier_cost_element_code,
    hier_cost_element_name,
    case
        when cost_element is not null then right(cost_element, 10)
    end as cost_element_code
from "food"."nghi_dev"."food_seed_scorecard_hierarchies_costelement"
  );
[0m11:00:25.205693 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:25.209690 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:25.210690 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: alter table "food"."nghi_dev"."food_mapping_hierarchies_costelement" rename to "food_mapping_hierarchies_costelement__dbt_backup"
[0m11:00:25.457211 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:25.462210 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:25.462210 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: alter table "food"."nghi_dev"."food_mapping_hierarchies_costelement__dbt_tmp" rename to "food_mapping_hierarchies_costelement"
[0m11:00:25.597358 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:25.600557 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: COMMIT
[0m11:00:25.601061 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:25.601061 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: COMMIT
[0m11:00:26.177952 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:26.180035 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:26.180035 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: BEGIN
[0m11:00:26.248749 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:26.256554 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:26.257558 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: drop table if exists "food"."nghi_dev"."food_mapping_hierarchies_costelement__dbt_backup" cascade
[0m11:00:26.343601 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:26.346970 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: COMMIT
[0m11:00:26.346970 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:26.348080 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: COMMIT
[0m11:00:26.882252 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:26.884328 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_hierarchies_costelement"
[0m11:00:26.885328 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: BEGIN
[0m11:00:26.919612 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:26.922696 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_hierarchies_costelement (execute): 11:00:24.749241 => 11:00:26.921695
[0m11:00:26.923696 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: ROLLBACK
[0m11:00:26.992713 [debug] [Thread-1  ]: On model.sales_group.food_mapping_hierarchies_costelement: Close
[0m11:00:26.994799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E61CB460>]}
[0m11:00:26.996795 [info ] [Thread-1  ]: 2 of 10 OK created sql table model nghi_dev.food_mapping_hierarchies_costelement  [[32mSUCCESS[0m in 2.25s]
[0m11:00:26.999110 [debug] [Thread-1  ]: Finished running node model.sales_group.food_mapping_hierarchies_costelement
[0m11:00:27.000220 [debug] [Thread-1  ]: Began running node model.sales_group.food_mapping_pl_plgroup
[0m11:00:27.001333 [info ] [Thread-1  ]: 3 of 10 START sql table model nghi_dev.food_mapping_pl_plgroup ................. [RUN]
[0m11:00:27.003584 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_mapping_hierarchies_costelement, now model.sales_group.food_mapping_pl_plgroup)
[0m11:00:27.003584 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_mapping_pl_plgroup
[0m11:00:27.006580 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:27.007945 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_pl_plgroup (compile): 11:00:27.004581 => 11:00:27.007945
[0m11:00:27.008947 [debug] [Thread-1  ]: Began executing node model.sales_group.food_mapping_pl_plgroup
[0m11:00:27.014946 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:27.017055 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:27.017055 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: BEGIN
[0m11:00:27.017055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:00:27.018189 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:27.018189 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:27.288762 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:27.289832 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:27.289832 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: create  table
    "food"."nghi_dev"."food_mapping_pl_plgroup__dbt_tmp"
    
    
    
  as (
    select 
'00' || gl_account as "G/L Account",
 name_gl_account, 
 pl_code, 
 pl_name, 
 pl_group_code, 
 pl_group_name
from "food"."nghi_dev"."food_seed_scorecard_mapping_pl_and_plgroup" pl
  );
[0m11:00:27.408143 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:27.412142 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:27.412142 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: alter table "food"."nghi_dev"."food_mapping_pl_plgroup" rename to "food_mapping_pl_plgroup__dbt_backup"
[0m11:00:27.536663 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:27.543755 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:27.544745 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: alter table "food"."nghi_dev"."food_mapping_pl_plgroup__dbt_tmp" rename to "food_mapping_pl_plgroup"
[0m11:00:27.620273 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:27.625628 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: COMMIT
[0m11:00:27.626634 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:27.626634 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: COMMIT
[0m11:00:28.235936 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:28.235936 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:28.237035 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: BEGIN
[0m11:00:28.288552 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:28.295562 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:28.295562 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: drop table if exists "food"."nghi_dev"."food_mapping_pl_plgroup__dbt_backup" cascade
[0m11:00:28.348493 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:28.351871 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: COMMIT
[0m11:00:28.352874 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:28.353864 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: COMMIT
[0m11:00:28.843249 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:28.844326 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_mapping_pl_plgroup"
[0m11:00:28.845330 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: BEGIN
[0m11:00:28.870444 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:28.872440 [debug] [Thread-1  ]: Timing info for model.sales_group.food_mapping_pl_plgroup (execute): 11:00:27.008947 => 11:00:28.871446
[0m11:00:28.873446 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: ROLLBACK
[0m11:00:28.924508 [debug] [Thread-1  ]: On model.sales_group.food_mapping_pl_plgroup: Close
[0m11:00:28.926508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E60CD670>]}
[0m11:00:28.927582 [info ] [Thread-1  ]: 3 of 10 OK created sql table model nghi_dev.food_mapping_pl_plgroup ............ [[32mSUCCESS[0m in 1.92s]
[0m11:00:28.928510 [debug] [Thread-1  ]: Finished running node model.sales_group.food_mapping_pl_plgroup
[0m11:00:28.928510 [debug] [Thread-1  ]: Began running node model.sales_group.food_scorecard_kpi_budget
[0m11:00:28.929581 [info ] [Thread-1  ]: 4 of 10 START sql table model nghi_dev.kpi_budget .............................. [RUN]
[0m11:00:28.930510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_mapping_pl_plgroup, now model.sales_group.food_scorecard_kpi_budget)
[0m11:00:28.931586 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_scorecard_kpi_budget
[0m11:00:28.935899 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:28.937899 [debug] [Thread-1  ]: Timing info for model.sales_group.food_scorecard_kpi_budget (compile): 11:00:28.931586 => 11:00:28.936903
[0m11:00:28.937899 [debug] [Thread-1  ]: Began executing node model.sales_group.food_scorecard_kpi_budget
[0m11:00:28.944967 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:28.950515 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:28.951548 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: BEGIN
[0m11:00:28.951548 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:00:28.952549 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:28.953696 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:29.277736 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:29.278828 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:29.279822 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: create  table
    "food"."nghi_dev"."kpi_budget__dbt_tmp"
    
    
    
  as (
    select
    cat_code,
    cat_name,
    subcat1_code as subcat_1_code,
    subcat1_name as subcat_1_name,
    '' as subcat_2_code,
    '' as subcat_2_name,
    '' as "G/L Account",
    '' as expense_group_code,
    '' as expense_group_name,
    '' as company_code,
    case 
    when month is not null 
    then left(month,4) || right(month,2) || '01'
    end as posting_date,
    '' as channel_code,
    '' as channel_name,
    '' as matnr,
    '20' as value_type,
    month as fiscyearper,
        kpi_code,
        kpi_name,
    '' as pl_code, 
    '' as pl_name, 
    '' as pl_group_code, 
    '' as pl_group_name,
    '' as costcenter_code,
    '' as costcenter_name,
    '' as costcenter_full_name,
    '' as costcenter_group_code,
    '' as costcenter_group_name,
    0 as revenue,
    0 as quantity,
    0 as "revenue(D/KG)",
    0 as inter_profit,
    0 as cogs,
    0 as "cogs(+)",
    0 as "gross contribution (3) =  (1) - (+)",
    0 as "manufacturing cost (4)",
    0 as "gross margin (5) = (3) - (4)",
    0 as "mkt & commercial costs (6)",
    0 as "administrative costs (7)",
    0 as "chi phí tài chính(8)",
    0 as "thu nhập tài chính(9)",
    amount::numeric(38,2) as budget
from "food"."nghi_dev"."food_seed_scorecard_budget_2023"
  );
[0m11:00:29.553560 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:29.559554 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:29.559554 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: alter table "food"."nghi_dev"."kpi_budget" rename to "kpi_budget__dbt_backup"
[0m11:00:29.741716 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:29.750595 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:29.751597 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: alter table "food"."nghi_dev"."kpi_budget__dbt_tmp" rename to "kpi_budget"
[0m11:00:29.894995 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:29.899279 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: COMMIT
[0m11:00:29.900391 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:29.901391 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: COMMIT
[0m11:00:30.573242 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:30.574295 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:30.574295 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: BEGIN
[0m11:00:30.643190 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:30.647464 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:30.648926 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: drop table if exists "food"."nghi_dev"."kpi_budget__dbt_backup" cascade
[0m11:00:30.719442 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:30.721438 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: COMMIT
[0m11:00:30.722438 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:30.722438 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: COMMIT
[0m11:00:31.318513 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:31.319553 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_scorecard_kpi_budget"
[0m11:00:31.320563 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: BEGIN
[0m11:00:31.354199 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:31.355279 [debug] [Thread-1  ]: Timing info for model.sales_group.food_scorecard_kpi_budget (execute): 11:00:28.938898 => 11:00:31.355279
[0m11:00:31.356274 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: ROLLBACK
[0m11:00:31.423072 [debug] [Thread-1  ]: On model.sales_group.food_scorecard_kpi_budget: Close
[0m11:00:31.425087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E5F9C0D0>]}
[0m11:00:31.426159 [info ] [Thread-1  ]: 4 of 10 OK created sql table model nghi_dev.kpi_budget ......................... [[32mSUCCESS[0m in 2.49s]
[0m11:00:31.428181 [debug] [Thread-1  ]: Finished running node model.sales_group.food_scorecard_kpi_budget
[0m11:00:31.428181 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m11:00:31.429192 [info ] [Thread-1  ]: 5 of 10 START sql view model nghi_dev.food_stg_sap_s4__fi_0fi_acdoca_10 ........ [RUN]
[0m11:00:31.430114 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_scorecard_kpi_budget, now model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10)
[0m11:00:31.431165 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m11:00:31.445569 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:31.449573 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10 (compile): 11:00:31.431405 => 11:00:31.449573
[0m11:00:31.450569 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m11:00:31.472165 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:31.477162 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:31.478257 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: BEGIN
[0m11:00:31.478257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:00:31.478257 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:31.479233 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:31.715957 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:31.717053 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:31.718041 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: create view "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10__dbt_tmp" as (
    

with source as (

    

    select *
    from "food"."stg_sap_s4"."fi_0fi_acdoca_10"
    where
        
            budat >= to_char(current_date - interval '1 day', 'YYYYMMDD')
        
        
        
),

deduped as (
    with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by rclnt, rldnr, rbukrs, gjahr, belnr, docln
                order by _created_at desc
            ) as rn
        from source as _inner
    )

    select
        distinct data.*
    from source as data
    
    natural join row_numbered
    where row_numbered.rn = 1
)

select * from deduped
  ) with no schema binding;
[0m11:00:31.823762 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:31.827711 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:31.828657 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: alter table "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10" rename to "food_stg_sap_s4__fi_0fi_acdoca_10__dbt_backup"
[0m11:00:31.910376 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:31.913412 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:31.913412 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: alter table "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10__dbt_tmp" rename to "food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:31.988848 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:31.989879 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m11:00:31.990885 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:31.990885 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m11:00:32.485394 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:32.486392 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:32.486392 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: BEGIN
[0m11:00:32.537964 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:32.542047 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:32.542047 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: drop view if exists "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10__dbt_backup" cascade
[0m11:00:32.595981 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:32.597662 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m11:00:32.598506 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:32.598506 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: COMMIT
[0m11:00:33.022961 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:33.023961 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10"
[0m11:00:33.024970 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: BEGIN
[0m11:00:33.049166 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:33.050169 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10 (execute): 11:00:31.450569 => 11:00:33.050169
[0m11:00:33.051160 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: ROLLBACK
[0m11:00:33.104575 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10: Close
[0m11:00:33.105580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E5FB2EB0>]}
[0m11:00:33.106577 [info ] [Thread-1  ]: 5 of 10 OK created sql view model nghi_dev.food_stg_sap_s4__fi_0fi_acdoca_10 ... [[32mSUCCESS[0m in 1.68s]
[0m11:00:33.107583 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10
[0m11:00:33.107583 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m11:00:33.108578 [info ] [Thread-1  ]: 6 of 10 START sql view model nghi_dev.food_stg_sap_s4__md_0costcenter_text ..... [RUN]
[0m11:00:33.109579 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__fi_0fi_acdoca_10, now model.sales_group.food_stg_sap_s4__md_0costcenter_text)
[0m11:00:33.109579 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m11:00:33.112579 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:33.115796 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0costcenter_text (compile): 11:00:33.109579 => 11:00:33.114545
[0m11:00:33.116796 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m11:00:33.122386 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:33.126459 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:33.126459 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: BEGIN
[0m11:00:33.127462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:00:33.127462 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:33.127462 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:33.472187 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:33.472187 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:33.473207 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: create view "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text__dbt_tmp" as (
    -- TODO: add dedup mechanism, ex. truncate before loading, or use macro (get lastest
-- row), ...
with
    selected_fields as (
        select kostl as code, txtsh as short_name, txtmd as medium_name
        from "food"."stg_sap_s4"."md_0costcenter_text"
        where langu = 'E' and kokrs = '1000'
    ),

    deduped as (
        with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by code
                order by code asc
            ) as rn
        from selected_fields as _inner
    )

    select
        distinct data.*
    from selected_fields as data
    
    natural join row_numbered
    where row_numbered.rn = 1
    )
select *
from deduped
order by code
  ) with no schema binding;
[0m11:00:33.600000 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:33.604067 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:33.605067 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text" rename to "food_stg_sap_s4__md_0costcenter_text__dbt_backup"
[0m11:00:33.691098 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:33.696384 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:33.696384 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text__dbt_tmp" rename to "food_stg_sap_s4__md_0costcenter_text"
[0m11:00:33.784910 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:33.788916 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m11:00:33.789916 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:33.789916 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m11:00:34.344153 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:34.346238 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:34.347806 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: BEGIN
[0m11:00:34.408004 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:34.413422 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:34.413422 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: drop view if exists "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text__dbt_backup" cascade
[0m11:00:34.473941 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:34.477034 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m11:00:34.478032 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:34.478032 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: COMMIT
[0m11:00:35.037736 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:35.038822 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0costcenter_text"
[0m11:00:35.038822 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: BEGIN
[0m11:00:35.078898 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:35.080366 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0costcenter_text (execute): 11:00:33.116796 => 11:00:35.080366
[0m11:00:35.081447 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: ROLLBACK
[0m11:00:35.165689 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0costcenter_text: Close
[0m11:00:35.167689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E5F9C0D0>]}
[0m11:00:35.168689 [info ] [Thread-1  ]: 6 of 10 OK created sql view model nghi_dev.food_stg_sap_s4__md_0costcenter_text  [[32mSUCCESS[0m in 2.06s]
[0m11:00:35.170689 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__md_0costcenter_text
[0m11:00:35.171819 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m11:00:35.172318 [info ] [Thread-1  ]: 7 of 10 START sql view model nghi_dev.food_stg_sap_s4__md_0distr_chan_text ..... [RUN]
[0m11:00:35.174323 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__md_0costcenter_text, now model.sales_group.food_stg_sap_s4__md_0distr_chan_text)
[0m11:00:35.174323 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m11:00:35.177409 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:35.180012 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0distr_chan_text (compile): 11:00:35.174323 => 11:00:35.179325
[0m11:00:35.180440 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m11:00:35.184567 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:35.189215 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:35.189215 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: BEGIN
[0m11:00:35.189215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:00:35.190214 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:35.190214 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:35.550899 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:35.550899 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:35.551924 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: create view "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text__dbt_tmp" as (
    -- TODO: add dedup mechanism, ex. truncate before loading, or use macro (get lastest
-- row), ...
with
    selected_fields as (
        select vtweg as code, vtext as name
        from "food"."stg_sap_s4"."md_0distr_chan_text"
        where spras = 'E'
    ),

    deduped as (
        with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by code
                order by name asc
            ) as rn
        from selected_fields as _inner
    )

    select
        distinct data.*
    from selected_fields as data
    
    natural join row_numbered
    where row_numbered.rn = 1
    )
select *
from deduped
order by code
  ) with no schema binding;
[0m11:00:35.694047 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:35.702785 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:35.703808 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" rename to "food_stg_sap_s4__md_0distr_chan_text__dbt_backup"
[0m11:00:35.808090 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:35.815425 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:35.815425 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: alter table "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text__dbt_tmp" rename to "food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:35.921314 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:35.924405 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m11:00:35.924405 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:35.924405 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m11:00:36.490491 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:36.491537 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:36.491537 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: BEGIN
[0m11:00:36.559746 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:36.567906 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:36.568906 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: drop view if exists "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text__dbt_backup" cascade
[0m11:00:36.650389 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:36.653471 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m11:00:36.654472 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:36.654472 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: COMMIT
[0m11:00:37.204454 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:00:37.205457 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__md_0distr_chan_text"
[0m11:00:37.206454 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: BEGIN
[0m11:00:37.248360 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:37.250363 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__md_0distr_chan_text (execute): 11:00:35.180440 => 11:00:37.250363
[0m11:00:37.251363 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: ROLLBACK
[0m11:00:37.331508 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__md_0distr_chan_text: Close
[0m11:00:37.332500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E62C0340>]}
[0m11:00:37.333502 [info ] [Thread-1  ]: 7 of 10 OK created sql view model nghi_dev.food_stg_sap_s4__md_0distr_chan_text  [[32mSUCCESS[0m in 2.16s]
[0m11:00:37.334956 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__md_0distr_chan_text
[0m11:00:37.334956 [debug] [Thread-1  ]: Began running node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m11:00:37.336189 [info ] [Thread-1  ]: 8 of 10 START sql table model nghi_dev.food_stg_sap_s4__tbl_fcml_ccs_r_all_v ... [RUN]
[0m11:00:37.337118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__md_0distr_chan_text, now model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v)
[0m11:00:37.338217 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m11:00:37.343189 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:00:37.347400 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v (compile): 11:00:37.338217 => 11:00:37.346393
[0m11:00:37.347400 [debug] [Thread-1  ]: Began executing node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m11:00:37.354395 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:00:37.359395 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:00:37.359395 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: BEGIN
[0m11:00:37.360399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:00:37.361399 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:00:37.361399 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:00:37.709570 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:00:37.710664 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:00:37.710664 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: create  table
    "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_tmp"
    
    
    
  as (
    

with
    source as (select * from "food"."stg_sap_s4"."tbl_fcml_ccs_r_all_v"),

    deduped as (
        with row_numbered as (
        select
            _inner.*,
            row_number() over (
                partition by kalnr_mat, poper, bdatj, run_act, run_appl, categ, ptyp, psart, kalnr_pmat, bvalt, process, elesmhk, element, mlcct, curtp 
                order by kalnr_mat desc
            ) as rn
        from source as _inner
    )

    select
        distinct data.*
    from source as data
    
    natural join row_numbered
    where row_numbered.rn = 1
    )

select *
from deduped
  );
[0m11:01:28.126566 [debug] [Thread-1  ]: SQL status: SUCCESS in 50.0 seconds
[0m11:01:28.133100 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:01:28.134107 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: alter table "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v" rename to "food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_backup"
[0m11:01:28.309566 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:28.363187 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:01:28.364239 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: alter table "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_tmp" rename to "food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:01:28.463459 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:28.465541 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m11:01:28.466541 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:01:28.466541 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m11:01:29.033338 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:01:29.034340 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:01:29.035338 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: BEGIN
[0m11:01:29.102856 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:29.105864 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:01:29.105864 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: drop table if exists "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v__dbt_backup" cascade
[0m11:01:29.176129 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:29.179176 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m11:01:29.180139 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:01:29.180139 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: COMMIT
[0m11:01:29.722880 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:01:29.724970 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
[0m11:01:29.725896 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: BEGIN
[0m11:01:29.759627 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:29.762861 [debug] [Thread-1  ]: Timing info for model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v (execute): 11:00:37.347400 => 11:01:29.762861
[0m11:01:29.762861 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: ROLLBACK
[0m11:01:29.845744 [debug] [Thread-1  ]: On model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v: Close
[0m11:01:29.848798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E62C0340>]}
[0m11:01:29.849831 [info ] [Thread-1  ]: 8 of 10 OK created sql table model nghi_dev.food_stg_sap_s4__tbl_fcml_ccs_r_all_v  [[32mSUCCESS[0m in 52.51s]
[0m11:01:29.852791 [debug] [Thread-1  ]: Finished running node model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v
[0m11:01:29.853766 [debug] [Thread-1  ]: Began running node model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue
[0m11:01:29.854832 [info ] [Thread-1  ]: 9 of 10 START sql view model nghi_dev.food_int_fi_0fi_acdoca_10__filtered_to_revenue  [RUN]
[0m11:01:29.857964 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_stg_sap_s4__tbl_fcml_ccs_r_all_v, now model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue)
[0m11:01:29.857964 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue
[0m11:01:29.870233 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:29.875784 [debug] [Thread-1  ]: Timing info for model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue (compile): 11:01:29.859266 => 11:01:29.874536
[0m11:01:29.876287 [debug] [Thread-1  ]: Began executing node model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue
[0m11:01:29.883368 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:29.954967 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:29.956036 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: BEGIN
[0m11:01:29.956036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:01:29.957045 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:01:29.957045 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:01:30.325962 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:30.327137 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:30.330135 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: create view "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue__dbt_tmp" as (
    with
    _0fi_acdoca_10_filter as (
        select
            racct,
            ktopl,
            kokrs,
            rbukrs,
            rldnr,
            paph4_pa,
            paph5_pa,
            vkgrp_pa,
            matnr,
            budat,
            matnr_copa,
            vtweg,
            fiscyearper,
            rcntr,
            awtyp,
            hsl,
            quant1,
            osl,
            kalnr,
            qsprocess,
            kunnr,
            mlcateg,
            werks
        from "food"."nghi_dev"."food_stg_sap_s4__fi_0fi_acdoca_10"
        where
            ktopl = 1000  -- chart of account 
            and kokrs = 1000
            and rldnr = '0L'  -- sob type
            and fiscyearper >= '2023001'

    ),
    mapping_cat_subcat as (
        select
            c.cat_code,
            c.cat_name,
            sc.subcat1_code,
            sc.subcat1_name,
            sc.subcat2_code,
            sc.subcat2_name,
            racct,
            ktopl,
            kokrs,
            rbukrs,
            rldnr,
            paph4_pa,
            paph5_pa,
            vkgrp_pa,
            matnr,
            matnr_copa,
            budat,
            vtweg,
            fiscyearper,
            rcntr,
            hsl,
            quant1,
            osl,
            awtyp,
            kunnr,
            kalnr,
            qsprocess,
            werks
        from _0fi_acdoca_10_filter
        left join
            "food"."nghi_dev"."food_seed_scorecard_mapping_categories" c
            on right(paph4_pa, 2) = c.ph4_code
        left join
            "food"."nghi_dev"."food_seed_scorecard_mapping_subcategories" sc
            on right(paph5_pa, 3) = sc.ph5_code
    ),

      mapping_cat_subcat_special_case as (
        select
            cat_code,
            cat_name,
            subcat1_code,
            subcat1_name,
            subcat2_code,
            subcat2_name,
            racct,
            ktopl,
            kokrs,
            rbukrs,
            rldnr,
            paph4_pa,
            paph5_pa,
            vkgrp_pa,
            matnr,
            matnr_copa,
            budat,
            vtweg,
            fiscyearper,
            rcntr,
            hsl,
            quant1,
            osl,
            awtyp,
            kunnr,
            kalnr,
            qsprocess,
            werks,
            case when matnr = '' then matnr_copa else matnr end as _material,

            case
                when
                    paph4_pa = ''
                    and
                        left(_material, 11) in (
                            '00000000002',
                            '00000000003',
                            '00000000004',
                            '00000000005',
                            '00000000009'
                        )
                    and rbukrs != '3100'
                then '98'

                 when
                    paph4_pa = ''
                    and _material in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                    and rbukrs = '3100'
                then '01'
                when
                    paph4_pa = ''
                    and (left(_material, 11) in (
                        '00000000002',
                        '00000000003',
                        '00000000004',
                        '00000000005',
                        '00000000009'
                    ))
                    and rbukrs = '3100'
                    and _material not in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                then '98'
                
                when
                    paph4_pa = ''
                    and racct in ('0051121201', '0051183101', '0064180015')
                then '99'

                when racct = '0063242002' and rbukrs = '3100'
                then '01'

                when racct = '0063242001' and rbukrs = '3100'
                then '98'

                else cat_code
            end as _cat_code,

            case
                when
                    paph5_pa = ''
                    and (
                        left(_material, 11) in (
                            '00000000002',
                            '00000000003',
                            '00000000004',
                            '00000000005',
                            '00000000009'
                        )
                    )
                    and rbukrs != '3100'
                then '98'
                 when
                    paph5_pa = ''
                    and _material in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                    and rbukrs = '3100'
                then '01'

                when
                    paph5_pa = ''
                    and (left(_material, 11) in (
                        '00000000002',
                        '00000000003',
                        '00000000004',
                        '00000000005',
                        '00000000009'
                    ))
                    and rbukrs = '3100'
                    and _material not in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                then '98'
                when
                    paph5_pa = ''
                    and racct in ('0051121201', '0051183101', '0064180015')
                then '99'

                 when
                    paph5_pa = ''
                    and _material in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                    and rbukrs = '3100'
                then '01'

                when
                    paph5_pa = ''
                    and (left(_material, 11) in (
                        '00000000002',
                        '00000000003',
                        '00000000004',
                        '00000000005',
                        '00000000009'
                    ))
                    and rbukrs = '3100'
                    and _material not in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                then '98'

                else subcat1_code
            end as _subcat_1_code,
            case
                when
                    paph5_pa = ''
                    and (left(_material, 11) in (
                        '00000000002',
                        '00000000003',
                        '00000000004',
                        '00000000005',
                        '00000000009'
                    ))
                    and rbukrs != '3100'
                then '98'
                when
                    paph5_pa = ''
                    and racct in ('0051121201', '0051183101', '0064180015')
                then '99'

                when
                    paph5_pa = ''
                    and _material in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                    and rbukrs = '3100'
                then '01'

                when
                    paph5_pa = ''
                    and (left(_material, 11) in (
                        '00000000002',
                        '00000000003',
                        '00000000004',
                        '00000000005',
                        '00000000009'
                    ))
                    and rbukrs = '3100'
                    and _material not in (
                        '000000000020000092',
                        '000000000020000084',
                        '000000000020000087'
                    )
                then '98'

                else subcat2_code
            end as _subcat_2_code

        from mapping_cat_subcat
    ),

    concatenate_cat_subcat as (
        select
            case 
            when _cat_code is null 
            then '99' 
            else _cat_code end as cat_code_n,

            case
                when cat_code_n = '99'
                then 'DT khác'
                when cat_code_n = '98'
                then 'Khác'
                else cat_name
            end as cat_name_n,

            case
                when _subcat_1_code is null 
                then '99' else _subcat_1_code
            end as subcat_1_code,

            case
                when subcat_1_code = '98'
                then 'Khác'
                when subcat_1_code = '99'
                then 'DT khác'
                else subcat1_name
            end as subcat_1_name,

            case
                when _subcat_2_code is null 
                then '99' else _subcat_2_code
            end as subcat_2_code,

            case
                when subcat_2_code = '98'
                then 'Khác'
                when subcat_2_code = '99'
                then 'DT khác'
                else subcat2_name
            end as subcat_2_name,

            racct as "G/L Account",
            rbukrs as company_code,
            budat as posting_date,
            case when vtweg = '' then '98' else vtweg end as channel_code,
            matnr as matnr,
            fiscyearper,
            rcntr as costcenter_code,
            awtyp,
            kunnr,
            kalnr,
            qsprocess,
            werks,
            sum(
                case
                    when
                        (racct >= '0051100000' and racct <= '0051199999')
                        and (racct not in ('0051511000', '0051521000'))
                        or racct = '0064180015'
                    then hsl
                    else 0
                end

            ) as _revenue,

            sum(
                case
                    when
                        (racct >= '0051100000' and racct <= '0051199999')
                        and (racct not in ('0051511000', '0051521000'))
                    then quant1
                    else 0
                end

            ) as _quantity,

            case
                when _quantity != 0 then (_revenue / _quantity) else 0
            end as "_revenue(D/KG)",

            sum(
                case
                    when (racct >= '0063240000' and racct <= '0063289999')
                    then hsl
                    else 0
                end
            ) as _cogs,

            sum(case when racct = '0063241004' then hsl else 0 end) as "_cogs(+)",

            sum(
                case
                    when
                        (racct >= '0062200000' and racct <= '0062299999')
                        or (racct >= '0062700000' and racct <= '0062799999')
                        then hsl
                        else 0
                        end
            ) as "_manufacturing cost (4)",
     
            sum(  
                case
                    when
                        (racct >= '0064100000' and racct <= '0064199999')
                        and racct != '0064180015'
                    then hsl
                    else 0
                end
            ) as "_mkt & commercial costs (6)",

            sum(
                case
                    when racct >= '0064200000' and racct <= '0064299999' then hsl else 0
                end
            ) as "_administrative costs (7)",

            sum(
                case
                    when racct >= '0063500000' and racct <= '0063599999' then hsl else 0
                end
            ) as "_chi phí tài chính(8)",

            sum(
                case
                    when racct >= '0051500000' and racct <= '0051599999' then hsl else 0
                end
            ) as "_thu nhập tài chính(9)"

        from mapping_cat_subcat_special_case
        group by
            cat_code_n,
            cat_name_n,
            _subcat_1_code,
            subcat_1_name,
            _subcat_2_code,
            subcat_2_name,
            "G/L Account",
            company_code,
            posting_date,
            channel_code,
            matnr,
            fiscyearper,
            costcenter_code,
            awtyp,
            kunnr,
            kalnr,
            qsprocess,
            werks
    ),
final as (
    select
    cat_code_n as cat_code,
    cat_name_n as cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    company_code,
    posting_date,
    channel_code,
    matnr,
    fiscyearper,
    costcenter_code,
    kunnr as customer_code,
    kalnr,
    qsprocess,
    werks,
    sum(_revenue * (-1)) as revenue,
    sum(_quantity * (-1)) as quantity,
    sum("_revenue(D/KG)") as "revenue(D/KG)",
    sum(_cogs) as cogs,
    sum("_cogs(+)") as "cogs(+)",

    abs(revenue) - abs("cogs(+)") as "gross contribution (3) =  (1) - (+)",

    sum("_manufacturing cost (4)") as "manufacturing cost (4)",

    abs("gross contribution (3) =  (1) - (+)")
    - abs("manufacturing cost (4)") as "gross margin (5) = (3) - (4)",
    
    sum("_mkt & commercial costs (6)") as "mkt & commercial costs (6)",
    sum("_administrative costs (7)") as "administrative costs (7)",
    sum("_chi phí tài chính(8)") as "chi phí tài chính(8)",
    sum("_thu nhập tài chính(9)") as "thu nhập tài chính(9)"
from concatenate_cat_subcat
group by
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    company_code,
    posting_date,
    channel_code,
    matnr,
    fiscyearper,
    costcenter_code,
    customer_code,
    kalnr,
    qsprocess,
    werks
),
    _inter_profit as (
        select kalnr_mat,
               process,
               element,
               sum(prcdif_var) as _prcdif_var,
                sum(prcdif_fix) as _prcdif_fix
        from "food"."nghi_dev"."food_stg_sap_s4__tbl_fcml_ccs_r_all_v"
        where curtp = '10'
            and categ = 'VN'
            and elesmhk = 'M0'
            group by kalnr_mat,
                    process,
                    element),

    distribution_inter_profit as (
        select distinct
            fi.ktopl,
            fi.kokrs,
            fi.rbukrs,
            fi.rldnr,
            case when fi.matnr = '' then fi.matnr_copa else fi.matnr end as _material,
            fi.fiscyearper,
            fi.kalnr,
            fi.qsprocess,
            fi.werks,
            ip._prcdif_var,
            ip._prcdif_fix,
            ip.element
            from _0fi_acdoca_10_filter as fi
            left join _inter_profit as ip
            on fi.kalnr = ip.kalnr_mat
            and fi.qsprocess = ip.process
            and fi.mlcateg = 'VN'
            and fi.fiscyearper = '2023005'
            ),


   distinct_final as (
        select distinct
                max(cat_code) as _cat_code,
               max(cat_name) as _cat_name,
               max(subcat_1_code) as _subcat_1_code,
               max(subcat_1_name) as _subcat_1_name,
               max(subcat_2_code) as _subcat_2_code,
               max(subcat_2_name) as _subcat_2_name,
               max("G/L Account") as "_G/L Account",
               company_code,
               max(posting_date) as _posting_date,
               max(channel_code) as _channel_code,
               matnr,
               fiscyearper,
               max(costcenter_code) as _costcenter_code,
               kalnr,
               qsprocess,
               werks,
               max(customer_code) as _customer_code
        from final
        group by matnr,
                 fiscyearper,
                 kalnr,
                 qsprocess,
                 company_code,
                 werks
                 ),

    inter_profit_1 as (
        select 
            rbukrs,
            werks,
            _material,
            sum(case
            when ip.element = '010'
            then ip._prcdif_var
            end ) as "10-Raw Material",

            sum(case
            when ip.element = '020'
            then ip._prcdif_var
            end ) as "20-Packaging",

            sum(case
            when ip.element = '030'
            then ip._prcdif_var
            end ) as "30-Subcontract",

            sum(case
            when ip.element = '040'
            then ip._prcdif_var
            end ) as "40-Delivery cost STO",

            sum(case
            when ip.element = '051'
            then ip._prcdif_var
            end ) as "51-Emp.Outsourcing",

            sum(case
            when ip.element = '052'
            then ip._prcdif_var
            end ) as "52-Consum&supplies",

            sum(case
            when ip.element = '053'
            then ip._prcdif_var
            end ) as "53-Energy& utilities",

            sum(case
            when ip.element = '059'
            then ip._prcdif_var
            end ) as "59-Other expenses",

            sum(case
            when ip.element = '061'
            then ip._prcdif_var
            end ) as "61-Wages",

            sum(case
            when ip.element = '062'
            then ip._prcdif_var
            end ) as "62-Other wages",

            sum(case
            when ip.element = '063'
            then ip._prcdif_var
            end ) as "63-Depreciation exp",

            sum(case
            when ip.element = '069'
            then ip._prcdif_var
            end ) as "69-Other expenses",

            sum(case
            when ip.element = '080'
            then ip._prcdif_var
            end ) as "80-merchendise",

            sum(case
            when ip.element = '090'
            then ip._prcdif_var
            end ) as "90-Inter.Profit"
        from distribution_inter_profit as ip
        group by rbukrs, werks, _material),

    inter_profit_2 as (
        select 
            rbukrs,
            werks,
            _material,
            sum(case
            when ip.element = '010'
            then ip._prcdif_fix
            end ) as "10-Raw Material",

            sum(case
            when ip.element = '020'
            then ip._prcdif_fix
            end ) as "20-Packaging",

            sum(case
            when ip.element = '030'
            then ip._prcdif_fix
            end ) as "30-Subcontract",

            sum(case
            when ip.element = '040'
            then ip._prcdif_fix
            end ) as "40-Delivery cost STO",

            sum(case
            when ip.element = '051'
            then ip._prcdif_fix
            end ) as "51-Emp.Outsourcing",

            sum(case
            when ip.element = '052'
            then ip._prcdif_fix
            end ) as "52-Consum&supplies",

            sum(case
            when ip.element = '053'
            then ip._prcdif_fix
            end ) as "53-Energy& utilities",

            sum(case
            when ip.element = '059'
            then ip._prcdif_fix
            end ) as "59-Other expenses",

            sum(case
            when ip.element = '061'
            then ip._prcdif_fix
            end ) as "61-Wages",

            sum(case
            when ip.element = '062'
            then ip._prcdif_fix
            end ) as "62-Other wages",

            sum(case
            when ip.element = '063'
            then ip._prcdif_fix
            end ) as "63-Depreciation exp",

            sum(case
            when ip.element = '069'
            then ip._prcdif_fix
            end ) as "69-Other expenses",

            0 as "80-merchendise",
            0 as "90-Inter.Profit"
        from distribution_inter_profit as ip
        group by rbukrs, werks, _material),

     final_all_inter_profit as (
        select * from inter_profit_1
                   union all
        select * from inter_profit_2),


final_distribution_inter_profit as(
        select
        a._cat_code,
        a._cat_name,
        a._subcat_1_code,
        a._subcat_1_name,
        a._subcat_2_code,
        a._subcat_2_name,
        a."_G/L Account",
        a.company_code,
        a._posting_date,
        a._channel_code,
        a.matnr,
        a.fiscyearper,
        a._costcenter_code,
        a._customer_code,
        a.kalnr,
        a.qsprocess,
        a.werks,
        b1."10-raw material",
        b1."20-packaging",
        b1."30-subcontract",
        b1."40-delivery cost sto",
        b1."51-emp.outsourcing",
        b1."52-consum&supplies",
        b1."53-energy& utilities",
        b1."59-other expenses",
        b1."61-wages",
        b1."62-other wages",
        b1."63-depreciation exp",
        b1."69-other expenses",
        b1."80-merchendise",
        b1."90-inter.profit"
        from distinct_final as a
        inner join final_all_inter_profit as b1
        on a.matnr = b1._material
        and a.company_code = b1.rbukrs
        and a.werks = b1.werks
    ),

final_all as (
    select 
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    company_code,
    posting_date,
    channel_code,
    matnr,
    fiscyearper,
    costcenter_code,
    customer_code,
    '' as kalnr,
    '' as qsprocess,
    werks as plant,
    revenue,
    quantity,
    "revenue(D/KG)",
    cogs,
    "cogs(+)",
    "gross contribution (3) =  (1) - (+)",
    "manufacturing cost (4)",
    "gross margin (5) = (3) - (4)",
    "mkt & commercial costs (6)",
    "administrative costs (7)",
    "chi phí tài chính(8)",
    "thu nhập tài chính(9)",
    0 as "10-raw material",
    0 as "20-packaging",
    0 as "30-subcontract",
    0 as "40-delivery cost sto",
    0 as "51-emp.outsourcing",
    0 as "52-consum&supplies",
    0 as "53-energy& utilities",
    0 as "59-other expenses",
    0 as "61-wages",
    0 as "62-other wages",
    0 as "63-depreciation exp",
    0 as "69-other expenses",
    0 as "80-merchendise",
    0 as "90-inter.profit"

    from final

    union all

    select
    _cat_code as cat_code,
    _cat_name as cat_name,
    _subcat_1_code as subcat_1_code,
    _subcat_1_name as subcat_1_name,
    _subcat_2_code as subcat_2_code,
    _subcat_2_name as subcat_2_name,
    "_G/L Account" as "G/L Account" ,
    company_code,
    _posting_date as posting_date,
    _channel_code as channel_code,
    matnr,
    fiscyearper,
    _costcenter_code as costcenter_code,
    _customer_code as customer_code,
    kalnr,
    qsprocess,
    werks as plant,
    0 as  revenue,
    0 as  quantity,
    0 as  "revenue(D/KG)",
    0 as  cogs,
    0 as  "cogs(+)",
    0 as  "gross contribution (3) = (1) - (+)",
    0 as  "manufacturing cost (4)",
    0 as  "gross margin (5) = (3) - (4)",
    0 as  "mkt & commercial costs (6)",
    0 as  "administrative costs (7)",
    0 as  "chi phí tài chính(8)",
    0 as  "thu nhập tài chính(9)",
    "10-raw material",
    "20-packaging",
    "30-subcontract",
    "40-delivery cost sto",
    "51-emp.outsourcing",
    "52-consum&supplies",
    "53-energy& utilities",
    "59-other expenses",
    "61-wages",
    "62-other wages",
    "63-depreciation exp",
    "69-other expenses",
    "80-merchendise",
    "90-inter.profit"
    from final_distribution_inter_profit)

    select * from final_all
  ) with no schema binding;
[0m11:01:30.507526 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:30.515933 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:30.516934 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: alter table "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue" rename to "food_int_fi_0fi_acdoca_10__filtered_to_revenue__dbt_backup"
[0m11:01:30.642651 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:30.650216 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:30.650216 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: alter table "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue__dbt_tmp" rename to "food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:30.754902 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:30.757987 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: COMMIT
[0m11:01:30.758983 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:30.759483 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: COMMIT
[0m11:01:31.279853 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:01:31.280947 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:31.280947 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: BEGIN
[0m11:01:31.349506 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:31.353498 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:31.354498 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: drop view if exists "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue__dbt_backup" cascade
[0m11:01:31.422561 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:31.425574 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: COMMIT
[0m11:01:31.426650 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:31.427572 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: COMMIT
[0m11:01:31.939269 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:01:31.940495 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue"
[0m11:01:31.941701 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: BEGIN
[0m11:01:31.976052 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:31.978041 [debug] [Thread-1  ]: Timing info for model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue (execute): 11:01:29.876287 => 11:01:31.978041
[0m11:01:31.979105 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: ROLLBACK
[0m11:01:32.046031 [debug] [Thread-1  ]: On model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue: Close
[0m11:01:32.049043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E6163880>]}
[0m11:01:32.050043 [info ] [Thread-1  ]: 9 of 10 OK created sql view model nghi_dev.food_int_fi_0fi_acdoca_10__filtered_to_revenue  [[32mSUCCESS[0m in 2.19s]
[0m11:01:32.052508 [debug] [Thread-1  ]: Finished running node model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue
[0m11:01:32.054507 [debug] [Thread-1  ]: Began running node model.sales_group.food_fi_scorecard
[0m11:01:32.055538 [info ] [Thread-1  ]: 10 of 10 START sql table model nghi_dev.fi_scorecard ........................... [RUN]
[0m11:01:32.058460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales_group.food_int_fi_0fi_acdoca_10__filtered_to_revenue, now model.sales_group.food_fi_scorecard)
[0m11:01:32.059467 [debug] [Thread-1  ]: Began compiling node model.sales_group.food_fi_scorecard
[0m11:01:32.065886 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales_group.food_fi_scorecard"
[0m11:01:32.069990 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (compile): 11:01:32.059467 => 11:01:32.068953
[0m11:01:32.070956 [debug] [Thread-1  ]: Began executing node model.sales_group.food_fi_scorecard
[0m11:01:32.075885 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales_group.food_fi_scorecard"
[0m11:01:32.087210 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m11:01:32.088212 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m11:01:32.088212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:01:32.089211 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:01:32.089211 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:01:32.397849 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:01:32.397849 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m11:01:32.398914 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: create  table
    "food"."nghi_dev"."fi_scorecard__dbt_tmp"
    
    
    
  as (
    select
    fi.cat_code,
    fi.cat_name,
    fi.subcat_1_code,
    fi.subcat_1_name,
    fi.subcat_2_code,
    fi.subcat_2_name,
    fi."G/L Account",
    case
        when fi."G/L Account" >= '0064100000' and fi."G/L Account" <= '0064199999' 
        then '01'
        when fi."G/L Account" >= '0064200000' and fi."G/L Account" <= '0064299999' 
        then '02'
        when (fi."G/L Account" >= '0062200000' and fi."G/L Account" <= '0062299999')
        or  (fi."G/L Account" >= '0062700000' and fi."G/L Account" <= '0062799999')
        then '03'
    end as expense_group_code,

    case when expense_group_code = '01'
        then 'CP bán hàng'
        when  expense_group_code = '02'
        then 'CP quản lý'
        when  expense_group_code = '03'
        then 'CP sản xuất'
    end as expense_group_name,
    fi.company_code,
    fi.posting_date,
    fi.channel_code,
    case when fi.channel_code = '98'
    then 'Khác'
    else cn.name end as channel_name,
    fi.matnr,
    '10' as value_type, 
    fi.fiscyearper,
    '' as kpi_code,
    '' as kpi_name,
    pl.pl_code, 
    pl.pl_name, 
    pl.pl_group_code, 
    pl.pl_group_name,
    fi.costcenter_code,
    ctxt.short_name as costcenter_name,
    ctxt.medium_name as costcenter_full_name,
    cc.costcenter_group_code,
    cc.costcenter_group_name,
    clh.hier_cost_element_name,
    clh.cost_element_code,
    fi.customer_code,
    fi.plant,
    fi.revenue,
    fi.quantity,
    fi."revenue(D/KG)",
    fi.cogs,
    fi."cogs(+)",
    fi."gross Contribution (3) =  (1) - (+)",
    fi."manufacturing cost (4)",
    fi."gross margin (5) = (3) - (4)",
    fi."mkt & Commercial Costs (6)",
    fi."administrative costs (7)",
    fi."chi phí tài chính(8)",
    fi."thu nhập tài chính(9)",
    fi."10-raw material",
    fi."20-packaging",
    fi."30-subcontract",
    fi."40-delivery cost sto",
    fi."51-emp.outsourcing",
    fi."52-consum&supplies",
    fi."53-energy& utilities",
    fi."59-other expenses",
    fi."61-wages",
    fi."62-other wages",
    fi."63-depreciation exp",
    fi."69-other expenses",
    fi."80-merchendise",
    fi."90-inter.profit"

from "food"."nghi_dev"."food_int_fi_0fi_acdoca_10__filtered_to_revenue" fi
left join "food"."nghi_dev"."food_stg_sap_s4__md_0distr_chan_text" cn 
on fi.channel_code = cn.code

left join "food"."nghi_dev"."food_mapping_pl_plgroup" pl
on fi."G/L Account" = pl."G/L Account"

left join "food"."nghi_dev"."food_mapping_costcenter_costcentergroup" cc
on fi.costcenter_code = cc.costcenter_code

left join "food"."nghi_dev"."food_stg_sap_s4__md_0costcenter_text" ctxt
on fi.costcenter_code = ctxt.code

left join "food"."nghi_dev"."food_mapping_hierarchies_costelement" clh
on fi."G/L Account" = clh.cost_element_code

union all

select
    cat_code,
    cat_name,
    subcat_1_code,
    subcat_1_name,
    subcat_2_code,
    subcat_2_name,
    "G/L Account",
    expense_group_code,
    expense_group_name,
    company_code,
    posting_date,
    channel_code,
    channel_name,
    matnr,
    value_type, 
    fiscyearper,
    kpi_code,
    kpi_name,
    pl_code, 
    pl_name, 
    pl_group_code, 
    pl_group_name,
    costcenter_code,
    costcenter_name,
    costcenter_full_name,
    costcenter_group_code,
    costcenter_group_name,
    '' as hier_cost_element_name,
    '' as cost_element_code,
    '' as customer_code,
    '' as plant,
    budget * 1000 as revenue, 
    quantity,
    "revenue(D/KG)",
    cogs,
    "cogs(+)",
    "gross Contribution (3) =  (1) - (+)",
    "manufacturing cost (4)",
    "gross margin (5) = (3) - (4)",
    "mkt & Commercial Costs (6)",
    "administrative costs (7)",
    "chi phí tài chính(8)",
    "thu nhập tài chính(9)",
    0 as "10-raw material",
    0 as "20-packaging",
    0 as "30-subcontract",
    0 as "40-delivery cost sto",
    0 as "51-emp.outsourcing",
    0 as "52-consum&supplies",
    0 as "53-energy& utilities",
    0 as "59-other expenses",
    0 as "61-wages",
    0 as "62-other wages",
    0 as "63-depreciation exp",
    0 as "69-other expenses",
    0 as "80-merchendise",
    0 as "90-inter.profit"

from "food"."nghi_dev"."kpi_budget"
  );
[0m11:04:04.690257 [debug] [Thread-1  ]: SQL status: SUCCESS in 152.0 seconds
[0m11:04:04.696256 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m11:04:04.697333 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: alter table "food"."nghi_dev"."fi_scorecard" rename to "fi_scorecard__dbt_backup"
[0m11:04:04.868279 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:04.874528 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m11:04:04.875518 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: alter table "food"."nghi_dev"."fi_scorecard__dbt_tmp" rename to "fi_scorecard"
[0m11:04:04.968467 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:04.971467 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: COMMIT
[0m11:04:04.972467 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m11:04:04.973276 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: COMMIT
[0m11:04:05.641840 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:04:05.643857 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m11:04:05.644857 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m11:04:05.706902 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:05.711300 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m11:04:05.712299 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: drop table if exists "food"."nghi_dev"."fi_scorecard__dbt_backup" cascade
[0m11:04:05.773423 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:05.775499 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: COMMIT
[0m11:04:05.776501 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m11:04:05.777495 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: COMMIT
[0m11:04:06.297565 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m11:04:06.299646 [debug] [Thread-1  ]: Using redshift connection "model.sales_group.food_fi_scorecard"
[0m11:04:06.300650 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: BEGIN
[0m11:04:06.330638 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:06.333723 [debug] [Thread-1  ]: Timing info for model.sales_group.food_fi_scorecard (execute): 11:01:32.070956 => 11:04:06.332721
[0m11:04:06.334725 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: ROLLBACK
[0m11:04:06.394442 [debug] [Thread-1  ]: On model.sales_group.food_fi_scorecard: Close
[0m11:04:06.396518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186b0939-7459-4e92-bc25-8b0a8199e0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E5FB2DC0>]}
[0m11:04:06.398543 [info ] [Thread-1  ]: 10 of 10 OK created sql table model nghi_dev.fi_scorecard ...................... [[32mSUCCESS[0m in 154.34s]
[0m11:04:06.400852 [debug] [Thread-1  ]: Finished running node model.sales_group.food_fi_scorecard
[0m11:04:06.403808 [debug] [MainThread]: Using redshift connection "master"
[0m11:04:06.404830 [debug] [MainThread]: On master: BEGIN
[0m11:04:06.404830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:06.405786 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:04:06.406764 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:04:06.739952 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:06.741019 [debug] [MainThread]: On master: COMMIT
[0m11:04:06.742028 [debug] [MainThread]: Using redshift connection "master"
[0m11:04:06.743023 [debug] [MainThread]: On master: COMMIT
[0m11:04:06.799516 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:06.800602 [debug] [MainThread]: On master: Close
[0m11:04:06.802593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:06.803596 [debug] [MainThread]: Connection 'list_food' was properly closed.
[0m11:04:06.804600 [debug] [MainThread]: Connection 'list_group_nghi_dev' was properly closed.
[0m11:04:06.804600 [debug] [MainThread]: Connection 'model.sales_group.food_fi_scorecard' was properly closed.
[0m11:04:06.806052 [info ] [MainThread]: 
[0m11:04:06.807594 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 3 minutes and 48.42 seconds (228.42s).
[0m11:04:06.811668 [debug] [MainThread]: Command end result
[0m11:04:06.844333 [info ] [MainThread]: 
[0m11:04:06.845833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:06.846845 [info ] [MainThread]: 
[0m11:04:06.847846 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m11:04:06.848846 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:06.848846 after 229.05 seconds
[0m11:04:06.848846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E331BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E5F95EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E60CD4C0>]}
[0m11:04:06.849847 [debug] [MainThread]: Flushing usage events
