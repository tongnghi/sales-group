Extract common logic of mapping dimensions